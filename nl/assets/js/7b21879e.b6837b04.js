"use strict";(self.webpackChunkomp_web=self.webpackChunkomp_web||[]).push([["53516"],{5956:function(e,r,d){d.r(r),d.d(r,{frontMatter:()=>l,toc:()=>h,default:()=>j,metadata:()=>n,assets:()=>c,contentTitle:()=>i});var n=JSON.parse('{"id":"tutorials/QueryMechanism","title":"SA:MP Query-mechanisme","description":"Introductie","source":"@site/i18n/nl/docusaurus-plugin-content-docs/current/tutorials/QueryMechanism.md","sourceDirName":"tutorials","slug":"/tutorials/QueryMechanism","permalink":"/nl/docs/tutorials/QueryMechanism","draft":false,"unlisted":false,"editUrl":"https://github.com/openmultiplayer/web/edit/master/frontend/i18n/nl/docusaurus-plugin-content-docs/current/tutorials/QueryMechanism.md","tags":[],"version":"current","frontMatter":{"title":"SA:MP Query-mechanisme","sidebar_label":"SA:MP Query-mechanisme"},"sidebar":"docsSidebar","previous":{"title":"Port forwarden","permalink":"/nl/docs/tutorials/PortForwarding"},"next":{"title":"Color Fix","permalink":"/nl/docs/tutorials/colorfix"}}'),s=d(85893),t=d(50065);let l={title:"SA:MP Query-mechanisme",sidebar_label:"SA:MP Query-mechanisme"},i=void 0,c={},h=[{value:"Introductie",id:"introductie",level:2},{value:"Queries",id:"queries",level:2},{value:"Geserialiseerde data",id:"geserialiseerde-data",level:2},{value:"OPCODE",id:"opcode",level:2},{value:"Response",id:"response",level:2},{value:"Response-tabellen (<code>i</code>, <code>r</code>, <code>c</code>, <code>d</code>, <code>p</code>)",id:"response-tabellen-i-r-c-d-p",level:3},{value:"Type <code>i</code>",id:"type-i",level:4},{value:"Type <code>r</code>",id:"type-r",level:4},{value:"Type <code>c</code>",id:"type-c",level:4},{value:"Type <code>d</code>",id:"type-d",level:4},{value:"Type <code>p</code>",id:"type-p",level:4},{value:"Codevoorbeeld in C",id:"codevoorbeeld-in-c",level:2}];function x(e){let r={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h2,{id:"introductie",children:"Introductie"}),"\n",(0,s.jsxs)(r.p,{children:["Het SA",":MP"," Query-mechanisme verstuurt serverstatistieken en -informatie (naam, ping, taal, online spelers, enz.). Hier staat hoe het werkt en hoe je het zonder de originele client kunt gebruiken."]}),"\n",(0,s.jsx)(r.h2,{id:"queries",children:"Queries"}),"\n",(0,s.jsx)(r.p,{children:"Queries zijn pure UDP-pakketten met geserialiseerde data."}),"\n",(0,s.jsxs)(r.p,{children:['In de lagere RakNet-socketlaag worden pakketten die beginnen met 53 41 4D 50 ("SAMP") anders behandeld. Zie de code: ',(0,s.jsx)(r.strong,{children:(0,s.jsx)(r.a,{href:"https://github.com/openmultiplayer/RakNet/blob/master/Source/SocketLayer.cpp#L371",children:"View Code"})})]}),"\n",(0,s.jsx)(r.h2,{id:"geserialiseerde-data",children:"Geserialiseerde data"}),"\n",(0,s.jsxs)(r.p,{children:["De payload: ",(0,s.jsx)(r.strong,{children:'"SAMP"'})," + ",(0,s.jsx)(r.strong,{children:"IP-octets"})," + ",(0,s.jsx)(r.strong,{children:"eerste poortbyte*"})," + ",(0,s.jsx)(r.strong,{children:"tweede poortbyte"})," + ",(0,s.jsx)(r.strong,{children:"OPCODE"})]}),"\n",(0,s.jsxs)(r.p,{children:["Zie uitleg over IP-octets/poortbytes: ",(0,s.jsx)(r.a,{href:"http://penta2.ufrgs.br/trouble/ts_ip.htm",children:"Link"}),"."]}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{style:{textAlign:"center"},children:"Byte size"}),(0,s.jsx)(r.th,{style:{textAlign:"left"},children:"Naam"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"4"}),(0,s.jsx)(r.td,{style:{textAlign:"left"},children:'"SAMP"'})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"4"}),(0,s.jsx)(r.td,{style:{textAlign:"left"},children:"IP Octets"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"1"}),(0,s.jsx)(r.td,{style:{textAlign:"left"},children:"Port & 0xFF"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"1"}),(0,s.jsx)(r.td,{style:{textAlign:"left"},children:"Port >> 8 & 0xFF"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{style:{textAlign:"center"},children:"1"}),(0,s.jsx)(r.td,{style:{textAlign:"left"},children:"OPCODE"})]})]})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.a,{href:"https://github.com/Louzindev/sampquery-c/blob/master/src/packet.c",children:"C-voorbeeld"})}),"\n",(0,s.jsx)(r.h2,{id:"opcode",children:"OPCODE"}),"\n",(0,s.jsx)(r.p,{children:"Identifiers voor verzoektypes:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:'"i" (0x69):'})," Info (players, map, hostname, gamemode, language)"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:'"r" (0x72):'})," Rules (instagib, gravity, weather, website URL, ...)"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:'"c" (0x63):'})," Client list (namen en scores)"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:'"d" (0x64):'})," Detail per player (ping, id, score, naam)"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:'"x" (0x78):'})," RCON command (anders dan de rest)"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:'"p" (0x70):'})," Ping/latency check met 4 pseudo-random bytes"]}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"response",children:"Response"}),"\n",(0,s.jsx)(r.p,{children:"Elke OPCODE geeft een response terug. De eerste 11 bytes zijn gelijk aan de request-header, daarna volgt de specifieke payload."}),"\n",(0,s.jsxs)(r.h3,{id:"response-tabellen-i-r-c-d-p",children:["Response-tabellen (",(0,s.jsx)(r.code,{children:"i"}),", ",(0,s.jsx)(r.code,{children:"r"}),", ",(0,s.jsx)(r.code,{children:"c"}),", ",(0,s.jsx)(r.code,{children:"d"}),", ",(0,s.jsx)(r.code,{children:"p"}),")"]}),"\n",(0,s.jsxs)(r.h4,{id:"type-i",children:["Type ",(0,s.jsx)(r.code,{children:"i"})]}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Byte"}),(0,s.jsx)(r.th,{children:"Key"}),(0,s.jsx)(r.th,{children:"Breedte"}),(0,s.jsx)(r.th,{children:"Omschrijving"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"11"}),(0,s.jsx)(r.td,{children:"Password"}),(0,s.jsx)(r.td,{children:"1"}),(0,s.jsx)(r.td,{children:"0 of 1 (password ingesteld)"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"12-13"}),(0,s.jsx)(r.td,{children:"Players"}),(0,s.jsx)(r.td,{children:"2"}),(0,s.jsx)(r.td,{children:"Aantal online spelers"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"14-15"}),(0,s.jsx)(r.td,{children:"MaxPlayers"}),(0,s.jsx)(r.td,{children:"2"}),(0,s.jsx)(r.td,{children:"Maximum aantal spelers"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"16-19"}),(0,s.jsx)(r.td,{children:"(strlen)"}),(0,s.jsx)(r.td,{children:"4"}),(0,s.jsx)(r.td,{children:"Lengte van hostname"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"20 + strlen"}),(0,s.jsx)(r.td,{children:"Hostname"}),(0,s.jsx)(r.td,{children:"(strlen)"}),(0,s.jsx)(r.td,{children:"Hostname van de server"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"21-24"}),(0,s.jsx)(r.td,{children:"(strlen)"}),(0,s.jsx)(r.td,{children:"4"}),(0,s.jsx)(r.td,{children:"Lengte van gamemode"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"25 + strlen"}),(0,s.jsx)(r.td,{children:"Gamemode"}),(0,s.jsx)(r.td,{children:"(strlen)"}),(0,s.jsx)(r.td,{children:"Gamemode"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"26-29"}),(0,s.jsx)(r.td,{children:"(strlen)"}),(0,s.jsx)(r.td,{children:"4"}),(0,s.jsx)(r.td,{children:"Lengte van language"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"30 + strlen"}),(0,s.jsx)(r.td,{children:"Language"}),(0,s.jsx)(r.td,{children:"(strlen)"}),(0,s.jsx)(r.td,{children:"Taal"})]})]})]}),"\n",(0,s.jsxs)(r.h4,{id:"type-r",children:["Type ",(0,s.jsx)(r.code,{children:"r"})]}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Byte"}),(0,s.jsx)(r.th,{children:"Key"}),(0,s.jsx)(r.th,{children:"Breedte"}),(0,s.jsx)(r.th,{children:"Omschrijving"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"11-12"}),(0,s.jsx)(r.td,{children:"RuleCount"}),(0,s.jsx)(r.td,{children:"2"}),(0,s.jsx)(r.td,{children:"Aantal rules"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"13"}),(0,s.jsx)(r.td,{children:"(strlen)"}),(0,s.jsx)(r.td,{children:"1"}),(0,s.jsx)(r.td,{children:"Lengte van rule-naam"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"14 + strlen"}),(0,s.jsx)(r.td,{children:"Rulename"}),(0,s.jsx)(r.td,{children:"(strlen)"}),(0,s.jsx)(r.td,{children:"Rule-naam"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"15"}),(0,s.jsx)(r.td,{children:"(strlen)"}),(0,s.jsx)(r.td,{children:"1"}),(0,s.jsx)(r.td,{children:"Lengte van rule-waarde"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"16 + strlen"}),(0,s.jsx)(r.td,{children:"RuleValue"}),(0,s.jsx)(r.td,{children:"(strlen)"}),(0,s.jsx)(r.td,{children:"Rule-waarde"})]})]})]}),"\n",(0,s.jsx)(r.p,{children:"Herhaal vanaf byte 13 voor elke rule."}),"\n",(0,s.jsxs)(r.h4,{id:"type-c",children:["Type ",(0,s.jsx)(r.code,{children:"c"})]}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Byte"}),(0,s.jsx)(r.th,{children:"Key"}),(0,s.jsx)(r.th,{children:"Breedte"}),(0,s.jsx)(r.th,{children:"Omschrijving"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"11-12"}),(0,s.jsx)(r.td,{children:"PlayerCount"}),(0,s.jsx)(r.td,{children:"2"}),(0,s.jsx)(r.td,{children:"Aantal spelers"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"13"}),(0,s.jsx)(r.td,{children:"(strlen)"}),(0,s.jsx)(r.td,{children:"1"}),(0,s.jsx)(r.td,{children:"Lengte van nickname"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"14 + strlen"}),(0,s.jsx)(r.td,{children:"PlayerNick"}),(0,s.jsx)(r.td,{children:"(strlen)"}),(0,s.jsx)(r.td,{children:"Spelernaam"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"15-18"}),(0,s.jsx)(r.td,{children:"Score"}),(0,s.jsx)(r.td,{children:"4"}),(0,s.jsx)(r.td,{children:"Score"})]})]})]}),"\n",(0,s.jsx)(r.p,{children:"Herhaal vanaf byte 13 per speler."}),"\n",(0,s.jsxs)(r.h4,{id:"type-d",children:["Type ",(0,s.jsx)(r.code,{children:"d"})]}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Byte"}),(0,s.jsx)(r.th,{children:"Key"}),(0,s.jsx)(r.th,{children:"Breedte"}),(0,s.jsx)(r.th,{children:"Omschrijving"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"11-12"}),(0,s.jsx)(r.td,{children:"PlayerCount"}),(0,s.jsx)(r.td,{children:"2"}),(0,s.jsx)(r.td,{children:"Aantal spelers"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"13"}),(0,s.jsx)(r.td,{children:"PlayerID"}),(0,s.jsx)(r.td,{children:"1"}),(0,s.jsx)(r.td,{children:"Speler-ID (0-255)"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"14"}),(0,s.jsx)(r.td,{children:"(strlen)"}),(0,s.jsx)(r.td,{children:"1"}),(0,s.jsx)(r.td,{children:"Lengte van nickname"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"15 + strlen"}),(0,s.jsx)(r.td,{children:"PlayerNick"}),(0,s.jsx)(r.td,{children:"(strlen)"}),(0,s.jsx)(r.td,{children:"Spelernaam"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"16-19"}),(0,s.jsx)(r.td,{children:"Score"}),(0,s.jsx)(r.td,{children:"4"}),(0,s.jsx)(r.td,{children:"Score"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"20-23"}),(0,s.jsx)(r.td,{children:"Ping"}),(0,s.jsx)(r.td,{children:"4"}),(0,s.jsx)(r.td,{children:"Ping"})]})]})]}),"\n",(0,s.jsx)(r.p,{children:"Herhaal vanaf byte 13 per speler."}),"\n",(0,s.jsxs)(r.h4,{id:"type-p",children:["Type ",(0,s.jsx)(r.code,{children:"p"})]}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Byte"}),(0,s.jsx)(r.th,{children:"Key"}),(0,s.jsx)(r.th,{children:"Breedte"}),(0,s.jsx)(r.th,{children:"Omschrijving"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"11"}),(0,s.jsx)(r.td,{children:"number 1"}),(0,s.jsx)(r.td,{children:"1"}),(0,s.jsx)(r.td,{children:"Eerste pseudo-random byte"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"12"}),(0,s.jsx)(r.td,{children:"number 2"}),(0,s.jsx)(r.td,{children:"1"}),(0,s.jsx)(r.td,{children:"Tweede"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"13"}),(0,s.jsx)(r.td,{children:"number 3"}),(0,s.jsx)(r.td,{children:"1"}),(0,s.jsx)(r.td,{children:"Derde"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"14"}),(0,s.jsx)(r.td,{children:"number 4"}),(0,s.jsx)(r.td,{children:"1"}),(0,s.jsx)(r.td,{children:"Vierde"})]})]})]}),"\n",(0,s.jsx)(r.h2,{id:"codevoorbeeld-in-c",children:"Codevoorbeeld in C"}),"\n",(0,s.jsxs)(r.p,{children:["Er is een kleine C-lib beschikbaar om queries te doen: ",(0,s.jsx)(r.strong,{children:(0,s.jsx)(r.a,{href:"https://github.com/Louzindev/sampquery-c",children:"Repository"})})]})]})}function j(e={}){let{wrapper:r}={...(0,t.a)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(x,{...e})}):x(e)}},50065:function(e,r,d){d.d(r,{Z:()=>i,a:()=>l});var n=d(67294);let s={},t=n.createContext(s);function l(e){let r=n.useContext(t);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),n.createElement(t.Provider,{value:r},e.children)}}}]);