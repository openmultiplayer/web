<!doctype html><html lang=pt-BR dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-scripting/language/reference/A-tutorial-introduction" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.8.1"><title data-rh=true>Introdução guiada | open.mp</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://open.mp/pt-BR/images/assets/wordmark-coloured-bg.png><meta data-rh=true name=twitter:image content=https://open.mp/pt-BR/images/assets/wordmark-coloured-bg.png><meta data-rh=true property=og:url content=https://open.mp/pt-BR/docs/scripting/language/reference/A-tutorial-introduction><meta data-rh=true property=og:locale content=pt_BR><meta data-rh=true property=og:locale:alternate content=en><meta data-rh=true property=og:locale:alternate content=es><meta data-rh=true property=og:locale:alternate content=ru><meta data-rh=true property=og:locale:alternate content=ar><meta data-rh=true property=og:locale:alternate content=bs><meta data-rh=true property=og:locale:alternate content=de><meta data-rh=true property=og:locale:alternate content=fil><meta data-rh=true property=og:locale:alternate content=fr><meta data-rh=true property=og:locale:alternate content=fa><meta data-rh=true property=og:locale:alternate content=hu><meta data-rh=true property=og:locale:alternate content=id><meta data-rh=true property=og:locale:alternate content=it><meta data-rh=true property=og:locale:alternate content=nl><meta data-rh=true property=og:locale:alternate content=pl><meta data-rh=true property=og:locale:alternate content=ro><meta data-rh=true property=og:locale:alternate content=sl><meta data-rh=true property=og:locale:alternate content=sr><meta data-rh=true property=og:locale:alternate content=ta><meta data-rh=true property=og:locale:alternate content=th><meta data-rh=true property=og:locale:alternate content=tr><meta data-rh=true property=og:locale:alternate content=vi><meta data-rh=true property=og:locale:alternate content=zh_CN><meta data-rh=true property=og:locale:alternate content=zh_TW><meta data-rh=true name=docusaurus_locale content=pt-BR><meta data-rh=true name=docsearch:language content=pt-BR><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="Introdução guiada | open.mp"><meta data-rh=true name=description content=---><meta data-rh=true property=og:description content=---><link data-rh=true rel=icon href=/pt-BR/favicon.ico><link data-rh=true rel=canonical href=https://open.mp/pt-BR/docs/scripting/language/reference/A-tutorial-introduction><link data-rh=true rel=alternate href=https://open.mp/docs/scripting/language/reference/A-tutorial-introduction hreflang=en><link data-rh=true rel=alternate href=https://open.mp/es/docs/scripting/language/reference/A-tutorial-introduction hreflang=es><link data-rh=true rel=alternate href=https://open.mp/ru/docs/scripting/language/reference/A-tutorial-introduction hreflang=ru><link data-rh=true rel=alternate href=https://open.mp/ar/docs/scripting/language/reference/A-tutorial-introduction hreflang=ar><link data-rh=true rel=alternate href=https://open.mp/bs/docs/scripting/language/reference/A-tutorial-introduction hreflang=bs><link data-rh=true rel=alternate href=https://open.mp/de/docs/scripting/language/reference/A-tutorial-introduction hreflang=de><link data-rh=true rel=alternate href=https://open.mp/fil/docs/scripting/language/reference/A-tutorial-introduction hreflang=fil><link data-rh=true rel=alternate href=https://open.mp/fr/docs/scripting/language/reference/A-tutorial-introduction hreflang=fr><link data-rh=true rel=alternate href=https://open.mp/fa/docs/scripting/language/reference/A-tutorial-introduction hreflang=fa><link data-rh=true rel=alternate href=https://open.mp/hu/docs/scripting/language/reference/A-tutorial-introduction hreflang=hu><link data-rh=true rel=alternate href=https://open.mp/id/docs/scripting/language/reference/A-tutorial-introduction hreflang=id><link data-rh=true rel=alternate href=https://open.mp/it/docs/scripting/language/reference/A-tutorial-introduction hreflang=it><link data-rh=true rel=alternate href=https://open.mp/nl/docs/scripting/language/reference/A-tutorial-introduction hreflang=nl><link data-rh=true rel=alternate href=https://open.mp/pl/docs/scripting/language/reference/A-tutorial-introduction hreflang=pl><link data-rh=true rel=alternate href=https://open.mp/pt-BR/docs/scripting/language/reference/A-tutorial-introduction hreflang=pt-BR><link data-rh=true rel=alternate href=https://open.mp/ro/docs/scripting/language/reference/A-tutorial-introduction hreflang=ro><link data-rh=true rel=alternate href=https://open.mp/sl/docs/scripting/language/reference/A-tutorial-introduction hreflang=sl><link data-rh=true rel=alternate href=https://open.mp/sr/docs/scripting/language/reference/A-tutorial-introduction hreflang=sr><link data-rh=true rel=alternate href=https://open.mp/ta/docs/scripting/language/reference/A-tutorial-introduction hreflang=ta><link data-rh=true rel=alternate href=https://open.mp/th/docs/scripting/language/reference/A-tutorial-introduction hreflang=th><link data-rh=true rel=alternate href=https://open.mp/tr/docs/scripting/language/reference/A-tutorial-introduction hreflang=tr><link data-rh=true rel=alternate href=https://open.mp/vi/docs/scripting/language/reference/A-tutorial-introduction hreflang=vi><link data-rh=true rel=alternate href=https://open.mp/zh-CN/docs/scripting/language/reference/A-tutorial-introduction hreflang=zh-CN><link data-rh=true rel=alternate href=https://open.mp/zh-TW/docs/scripting/language/reference/A-tutorial-introduction hreflang=zh-TW><link data-rh=true rel=alternate href=https://open.mp/docs/scripting/language/reference/A-tutorial-introduction hreflang=x-default><link data-rh=true rel=preconnect href=https://AOKXGK39Z7-dsn.algolia.net crossorigin=anonymous><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://open.mp/pt-BR/docs/scripting/language/reference/A-tutorial-introduction","name":"A-tutorial-introduction","position":1}]}</script><link rel=alternate type=application/rss+xml href=/pt-BR/blog/rss.xml title="open.mp RSS Feed"><link rel=alternate type=application/atom+xml href=/pt-BR/blog/atom.xml title="open.mp Atom Feed"><link rel=search type=application/opensearchdescription+xml title=open.mp href=/pt-BR/opensearch.xml><link rel=stylesheet href=/pt-BR/assets/css/styles.5e0d197a.css><script src=/pt-BR/assets/js/runtime~main.c653c8d8.js defer></script><script src=/pt-BR/assets/js/main.e5ad2d16.js defer></script><body class=navigation-with-keyboard><svg xmlns=http://www.w3.org/2000/svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light",e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/pt-BR/images/assets/logo-light-trans.svg><link rel=preload as=image href=/pt-BR/images/assets/logo.svg><div role=region aria-label="Pular para o conteúdo principal"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Pular para o conteúdo principal</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Alternar a barra de navegação" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/pt-BR/><div class=navbar__logo><img src=/pt-BR/images/assets/logo-light-trans.svg alt="open.mp logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/pt-BR/images/assets/logo-light-trans.svg alt="open.mp logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Open Multiplayer</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/pt-BR/docs/scripting/callbacks/OnActorStreamIn>Documentação</a><a class="navbar__item navbar__link" href=/pt-BR/blog>Blog</a><a href=https://forum.open.mp/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">Fóruns</a><a class="navbar__item navbar__link" href=/pt-BR/servers>Servidores</a><a class="navbar__item navbar__link" href=/pt-BR/partners>Parceiros</a><a href=https://opencollective.com/openmultiplayer target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">Doar<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>Português (Brasil)</a><ul class=dropdown__menu><li><a href=/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=en>English</a><li><a href=/es/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=es>Español</a><li><a href=/ru/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=ru>Русский</a><li><a href=/ar/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=ar>العربية</a><li><a href=/bs/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=bs>Bosanski</a><li><a href=/de/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=de>Deutsch</a><li><a href=/fil/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=fil>Filipino</a><li><a href=/fr/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=fr>Français</a><li><a href=/fa/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=fa>فارسی</a><li><a href=/hu/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=hu>Magyar</a><li><a href=/id/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=id>Indonesia</a><li><a href=/it/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=it>Italiano</a><li><a href=/nl/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=nl>Nederlands</a><li><a href=/pl/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=pl>Polski</a><li><a href=/pt-BR/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=pt-BR>Português (Brasil)</a><li><a href=/ro/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=ro>Română</a><li><a href=/sl/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=sl>Slovenščina</a><li><a href=/sr/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=sr>Српски</a><li><a href=/ta/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=ta>தமிழ்</a><li><a href=/th/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=th>ไทย</a><li><a href=/tr/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=tr>Türkçe</a><li><a href=/vi/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=vi>Tiếng Việt</a><li><a href=/zh-CN/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=zh-CN>简体中文</a><li><a href=/zh-TW/docs/scripting/language/reference/A-tutorial-introduction target=_self rel="noopener noreferrer" class=dropdown__link lang=zh-TW>繁體中文</a></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Alterar entre os modos claro e escuro (modo system mode ativado)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Buscar (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Buscar</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Voltar ao topo" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/pt-BR/docs/scripting/callbacks/OnActorStreamIn>Scripting</a></div><ul class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/pt-BR/docs/scripting/callbacks/OnActorStreamIn>Callbacks</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/pt-BR/docs/scripting/functions/AddCharModel>Functions</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true tabindex=0 href=/pt-BR/docs/scripting/language/reference/Contents>Language</a></div><ul class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true tabindex=0 href=/pt-BR/docs/scripting/language/reference/Contents>Reference</a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/reference/Contents>Contents</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/reference/Foreword>Foreword</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/pt-BR/docs/scripting/language/reference/A-tutorial-introduction>A-tutorial-introduction</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/reference/Data-and-declarations>Data-and-declarations</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/reference/Functions>Functions</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/reference/The-preprocessor>The-preprocessor</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/reference/General-syntax>General-syntax</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/reference/Operators-and-expressions>Operators-and-expressions</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/reference/Statements>Statements</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/reference/Directives>Directives</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/reference/Proposed-function-library>Proposed-function-library</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/reference/Pitfalls-differences-from-C>Pitfalls-differences-from-C</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/reference/Assorted-tips>Assorted-tips</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/reference/Appendices>Appendices</a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/ControlStructures>Estruturas de Controle</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/Directives>Palavras-chave: diretivas</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/Initialisers>Palavras-chave: inicializadores</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/Operators>Palavras-chave: operadores</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/Statements>Keywords: Statements</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/Style>Guia de estilo Pawn</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/Tags>Scripting: Tags</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/pt-BR/docs/scripting/language/Variables>Noções básicas: Variáveis</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/pt-BR/docs/scripting/resources/anglemodes>Resources</a></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/pt-BR/docs/server/CommonServerIssues>Server</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/pt-BR/docs/client/ClientCommands>Client</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/pt-BR/docs/tutorials/AdvancedStructures>Tutorials</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/pt-BR/docs/awesome>Espetacular</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/pt-BR/docs/changelog>Changelog</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/pt-BR/docs>Bem-vindo</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/pt-BR/docs/meta/Contributing>meta</a></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Página Inicial" class=breadcrumbs__link href=/pt-BR/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Scripting</span><li class=breadcrumbs__item><span class=breadcrumbs__link>Language</span><li class=breadcrumbs__item><span class=breadcrumbs__link>Reference</span><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>A-tutorial-introduction</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">Nessa página</button></div><div class="theme-doc-markdown markdown"><header><h1>Introdução guiada</h1></header>
<hr>
<p>Pawn é uma linguagem de programação simples cuja sintaxe lembra a da linguagem C. Um programa pawn é formado por um conjunto de funções e um conjunto de variáveis. As variáveis representam objetos de dados e as funções agrupam instruções (chamadas de <em>statements</em>) que operam sobre esses dados ou executam tarefas específicas.</p>
<p>O primeiro programa demonstrado em praticamente qualquer linguagem costuma imprimir uma mensagem simples; o clássico é “Hello world”. Em pawn o programa fica assim:</p>
<p>Listagem: hello.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    printf  </span><span class="token string" style=color:#e3116c>"Hello  world\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>Este manual parte do princípio de que você já sabe executar um programa pawn; caso contrário, consulte o manual da aplicação (há mais dicas na página 168).</p>
<p>A execução de um programa pawn começa em uma função de “entrada”∗ —neste manual, quase todos os exemplos usam a função <code>main</code> para esse papel. No exemplo acima, <code>main</code> contém apenas uma instrução, logo abaixo do cabeçalho da função. Quebras de linha e indentação não são significativas; poderíamos invocar <code>printf</code> na mesma linha do cabeçalho de <code>main</code>.</p>
<p>A definição de uma função exige que o nome seja seguido por um par de parênteses. Se a função receber parâmetros, eles são declarados entre os parênteses. <code>main</code> não recebe nenhum parâmetro. Já as regras mudam quando chamamos uma função: os parênteses são opcionais na chamada de <code>printf</code>.</p>
<p>O único argumento passado a <code>printf</code> é uma string, delimitada por aspas duplas. Os caracteres <code>\n</code> perto do final formam uma sequência de escape —nesse caso, representam a quebra de linha. Ao encontrar a sequência <code>\n</code>, <code>printf</code> move o cursor para a primeira coluna da próxima linha.
the next line. One has to use the \n escape sequence to insert a “newline” into
the string, because a string may not wrap over multiple lines.</p>
<hr>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=-this-should-not-be-confused-with-the-state-entry-functions-which-are-called-entry-but-serve-a-different-purpose--see-page-42>∗ This should not be confused with the “state” entry functions, which are called entry, but serve a different purpose — see page 42.<a href=#-this-should-not-be-confused-with-the-state-entry-functions-which-are-called-entry-but-serve-a-different-purpose--see-page-42 class=hash-link aria-label="Link direto para ∗ This should not be confused with the “state” entry functions, which are called entry, but serve a different purpose — see page 42." title="Link direto para ∗ This should not be confused with the “state” entry functions, which are called entry, but serve a different purpose — see page 42.">​</a></h6>
<p><code>Compiling and running scripts: see page 168</code></p>
<p><code>String literals: 99 Escape sequence: 99</code></p>
<hr>
<p>pawn is a “case sensitive” language: upper and lower case letters are considered
to be different letters. It would be an error to spell the function printf in the
acima como “PrintF”. Palavras-chave e símbolos pré-definidos, como o nome
da função <code>main</code>, devem ser escritos em minúsculas.</p>
<p>Se você conhece C, talvez ache que o exemplo anterior não se parece muito
com o tradicional “Hello world” de C/C++. No entanto, pawn também pode
lembrar bastante C. O próximo exemplo é sintaxe válida em pawn (e tem a
mesma lógica do anterior):</p>
<p>Listing: hello.p — C style</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa>  </span><span class="token macro property string" style=color:#e3116c>&lt;console></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>printf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"Hello  world\n"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>Esses primeiros exemplos já revelam algumas diferenças entre pawn e C:</p>
<ul>
<li>normalmente não é necessário incluir arquivos de cabeçalho fornecidos pelo sistema;</li>
<li>pontos e vírgulas são opcionais (exceto ao escrever várias instruções na mesma linha);</li>
<li>quando o corpo de uma função tem apenas uma instrução, as chaves (que transformam em instrução composta) também são opcionais;</li>
<li>se você não usa o resultado de uma função em uma expressão ou atribuição, os parênteses ao redor dos argumentos são opcionais.</li>
</ul>
<p>Esses itens referem-se a sintaxes opcionais —use o estilo que preferir; nenhum deles é “desaconselhado” ou “nocivo”. Os exemplos deste manual posicionam as chaves e usam uma indentação conhecida como “estilo Whitesmith”, mas pawn é uma linguagem de formato livre e qualquer estilo de recuo funciona.</p>
<p>Como pawn foi projetado como linguagem de extensão de aplicações, o conjunto de funções disponível em um programa depende da aplicação hospedeira. Consequentemente, a linguagem não conhece nenhuma função intrinsecamente. A função <code>print</code>, usada nos primeiros exemplos, precisa ser fornecida pelo aplicativo host e “declarada” ao analisador de pawn.</p>
<hr>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=-in-the-language-specification-the-term-parser-refers-to-any-implementation-that-processes-and-runs-on-conforming-pawn-programs-either-interpreters-or-compilers>∗ In the language specification, the term “parser” refers to any implementation that processes and runs on conforming Pawn programs —either interpreters or compilers.<a href=#-in-the-language-specification-the-term-parser-refers-to-any-implementation-that-processes-and-runs-on-conforming-pawn-programs-either-interpreters-or-compilers class=hash-link aria-label="Link direto para ∗ In the language specification, the term “parser” refers to any implementation that processes and runs on conforming Pawn programs —either interpreters or compilers." title="Link direto para ∗ In the language specification, the term “parser” refers to any implementation that processes and runs on conforming Pawn programs —either interpreters or compilers.">​</a></h6>
<p><code>More function descriptions at page 124</code></p>
<hr>
<p>Pressupõe-se, porém, que toda aplicação hospedeira disponibilize um conjunto mínimo de funções comuns, como <code>print</code> e <code>printf</code>.</p>
<p>Em alguns ambientes é necessário “habilitar” o display ou terminal antes de enviar texto. Se for o caso, chame a função <code>console</code> antes da primeira chamada a <code>print</code> ou <code>printf</code>. A função <code>console</code> também permite configurar características do dispositivo, como quantidade de linhas e colunas. Os programas deste manual não a utilizam porque muitas plataformas não exigem nem oferecem esse recurso.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-arithmetic>• Arithmetic<a href=#-arithmetic class=hash-link aria-label="Link direto para • Arithmetic" title="Link direto para • Arithmetic">​</a></h3>
<p>Os elementos fundamentais de grande parte dos programas são cálculos, decisões (execuções condicionais), iterações (loops) e variáveis para armazenar dados de entrada, saída e resultados intermediários. O próximo exemplo ilustra vários desses conceitos: ele calcula o máximo divisor comum de dois valores usando o algoritmo de Euclides.</p>
<p>Listing: gcd.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/*  the  greatest  common  divisor  of  two  values,  using  Euclides’</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>algorithm  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print  </span><span class="token string" style=color:#e3116c>"Input  two  values\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  a  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  b  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>while</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a  </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain">  b</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a  </span><span class="token operator" style=color:#393A34>></span><span class="token plain">  b</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        a  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  a  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  b</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        b  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  b  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  a</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    printf  </span><span class="token string" style=color:#e3116c>"The  greatest  common  divisor  is  %d\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  a</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>Agora <code>main</code> contém mais do que uma única instrução <code>print</code>. Quando o corpo de uma função possui várias instruções, elas devem ficar dentro de chaves (<code>{</code> e <code>}</code>), formando uma instrução composta. O mesmo vale para os blocos de <code>if/else</code> e para os corpos de loops.</p>
<p>A palavra-chave <code>new</code> cria uma variável; seu nome vem logo em seguida. É comum (mas não obrigatório) atribuir um valor inicial ao declarar a variável.</p>
<p><code>Compound statement: 112</code></p>
<p><code>Data declarations are covered in detail starting at page 62</code></p>
<hr>
<p>Variáveis devem ser declaradas antes de serem usadas em qualquer expressão. A função <code>getvalue</code> (também comum entre as funções pré-definidas) lê um valor do teclado e o retorna. Lembre-se de que pawn é uma linguagem sem tipos: toda variável é uma célula numérica capaz de armazenar um inteiro com sinal.</p>
<p>O nome <code>getvalue</code> é seguido por parênteses porque o valor retornado é armazenado em uma variável. Normalmente os argumentos da função apareceriam entre os parênteses, mas <code>getvalue</code> (neste programa) não recebe parâmetros explícitos. Se você não atribuir o resultado de uma função a uma variável nem o usar em outra expressão, os parênteses são opcionais —como acontece com <code>print</code> e <code>printf</code>. Você pode mantê-los se preferir, mas não é necessário.</p>
<p>Loop instructions, like “while”, repeat a single instruction as long as the loop
condition (the expression between parentheses) is “true”. One can<br>
<!-- -->execute multiple instructions in a loop by grouping them in a compound statement.
The if–else instruction has one instruction for the “true” clause and one for the “false”.</p>
<p>Observe that some statements, like while and if–else, contain (or<br>
<!-- -->“fold around”) another instruction —in the case of if–else even two other instructions.
The complete bundle is, again, a single instruction. That is:</p>
<ul>
<li>
<p>the assignment statements “a = a - b” below the if and “b = b - a” below the else are statements;</p>
</li>
<li>
<p>the if–else statement folds around these two assignment statements and forms a single statement of itself;</p>
</li>
<li>
<p>the while statement folds around the if–else statement and forms, again, a single statement.</p>
</li>
</ul>
<p>It is common to make the nesting of the statements explicit by indenting any
sub-statements below a statement in the source text. In the “Greatest Com-
mon Divisor” example, the left margin indent increases by four space characters
after the while statement, and again after the if and else keywords. State-
ments that belong to the same level, such as both printf invocations and the
while loop, have the same indentation.</p>
<p>The loop condition for the while loop is “(a != b)”; the symbol != is the
“not equal to” operator. That is, the if–else instruction is repeated<br>
<!-- -->until “a” equals “b”. It is good practice to indent the instructions that run under
control of another statement, as is done in the preceding example.</p>
<hr>
<p>The call to printf, near the bottom of the example, differs from the print call
right below the opening brace (“{”). The “f” in printf stands for “formatted”,
which means that the function can format and print numeric values and other
data (in a user-specified format), as well as literal text. The %d symbol in the
string is a token that indicates the position and the format that the subsequent
argument to function printf should be printed. At run time, the token %d is
replaced by the value of variable “a” (the second argument of printf).</p>
<p>A função <code>print</code> imprime apenas texto e é mais rápida do que <code>printf</code>. Se quiser exibir um caractere “%” literal, use <code>print</code> ou duplique o símbolo ao usar <code>printf</code>. Ou seja:</p>
<p><code>print "20% of the personnel accounts for 80% of the costs\n"</code></p>
<p>e</p>
<p><code>printf "20%% of the personnel accounts for 80%% of the costs\n"</code></p>
<p>produzem a mesma string.</p>
<hr>
<p><code>"while" loop: 116</code></p>
<p><code>"if else": 114</code></p>
<p><code>Relational operators: 107</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-arrays-e-constantes>• Arrays e constantes<a href=#-arrays-e-constantes class=hash-link aria-label="Link direto para • Arrays e constantes" title="Link direto para • Arrays e constantes">​</a></h3>
<p>Além das variáveis simples de uma célula, pawn oferece “variáveis array” que armazenam diversos valores. O exemplo a seguir lista números primos usando o famoso “crivo de Eratóstenes”. Ele também apresenta outro conceito: constantes simbólicas, que se parecem com variáveis, mas não podem ser alteradas.</p>
<p>Listing: sieve.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/*  Print  all  primes  below  100,  using  the  "Sieve  of  Eratosthenes"  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain">  max_primes  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>100</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  series</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">max_primes</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain">  true</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new  i  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  i  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">  max_primes</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>++</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">series</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        printf  </span><span class="token string" style=color:#e3116c>"%d  "</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  i</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>/*  filter  all  multiples  of  this  "prime"  from  the  list  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new  j  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>2</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">  i</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  j  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">  max_primes</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  j  </span><span class="token operator" style=color:#393A34>+=</span><span class="token plain">  i</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            series</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">j</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  false</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<p>Sempre que um programa (ou subprograma) tiver limites fixos, é boa prática criar constantes simbólicas para eles. No exemplo, <code>max_primes</code> vale 100 e é usada três vezes após a definição: na declaração do array <code>series</code> e nas duas estruturas <code>for</code>. Se quisermos adaptar o código para listar primos menores que 500, basta alterar uma linha.</p>
<p>Assim como variáveis simples, arrays podem ser inicializados na criação. Pawn fornece um atalho para inicializar todos os elementos com o mesmo valor: os cem elementos de <code>series</code> recebem <code>true</code> —sem que seja necessário digitar a palavra cem vezes. Os símbolos <code>true</code> e <code>false</code> são constantes pré-definidas.</p>
<p>Quando uma variável simples (como <code>i</code> e <code>j</code> na implementação do crivo) é declarada na primeira expressão de um laço <code>for</code>, ela existe apenas dentro do loop. Declaração de variável segue suas próprias regras; apesar da aparência, não é uma instrução comum. Uma dessas regras permite declarar uma variável na primeira expressão do <code>for</code>.</p>
<p>Os dois <code>for</code> também apresentam novos operadores na terceira expressão: <code>++</code> incrementa seu operando em um; ou seja, <code>++i</code> equivale a <code>i = i + 1</code>. Já <code>+=</code> soma a expressão da direita ao valor da esquerda; <code>j += i</code> equivale a <code>j = j + i</code>.</p>
<p>Trabalhando com arrays é preciso ficar atento ao problema clássico de “um a mais”: o primeiro elemento de <code>series</code> é <code>series[0]</code>, logo, se o array tem <code>max_primes</code> elementos, o último índice é <code>series[max_primes - 1]</code>. Se <code>max_primes</code> vale 100, o último elemento é <code>series[99]</code>; acessar <code>series[100]</code> é inválido.</p>
<p><code>Constant declaration: 101</code></p>
<p><code>Progressive initiallers: 65</code></p>
<p><code>"for" loop: 113</code></p>
<p><code>An overview of all operators: 104</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-funções>• Funções<a href=#-funções class=hash-link aria-label="Link direto para • Funções" title="Link direto para • Funções">​</a></h3>
<p>Programas maiores costumam separar tarefas e operações em funções. Isso aumenta a modularidade e, quando bem escritas, elas podem ser reaproveitadas em outros projetos. O exemplo a seguir implementa uma função para calcular a sequência de Fibonacci.</p>
<p>Essa série foi descrita por Leonardo “Fibonacci”, de Pisa, matemático italiano do século XIII famoso por popularizar os algarismos indo-arábicos no Ocidente. A sequência tinha como objetivo modelar o crescimento de uma população de coelhos idealizados, e segue 1, 1, 2, 3, 5, 8, 13, 21... —cada termo é a soma dos dois anteriores.</p>
<p>Listing: fib.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/*  Calculation  of  Fibonacci  numbers  by  iteration  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print  </span><span class="token string" style=color:#e3116c>"Enter  a  value:  "</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  v  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">v  </span><span class="token operator" style=color:#393A34>></span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        printf  </span><span class="token string" style=color:#e3116c>"The  value  of  Fibonacci  number  %d  is  %d\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> v</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>fibonacci</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">v</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        printf  </span><span class="token string" style=color:#e3116c>"The  Fibonacci  number  %d  does  not  exist\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  v</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>fibonacci</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">n</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    assert  n  </span><span class="token operator" style=color:#393A34>></span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  a  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  b  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new  i  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  i  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">  n</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  i</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        new  c  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  a  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  b</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        a  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  b</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        b  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  c</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain">  a  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  b</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>A instrução <code>assert</code> no início de <code>fibonacci</code> merece destaque: ela protege contra condições “impossíveis” ou inválidas. Números de Fibonacci negativos são inválidos, e <code>assert</code> sinaliza isso como erro de programação caso ocorra. Use <code>assert</code> apenas para erros do programador, nunca para erros de entrada do usuário.</p>
<p>Implementar uma função definida pelo usuário se parece bastante com a função <code>main</code>. Em <code>fibonacci</code> vemos dois conceitos novos: ela recebe um valor por parâmetro e retorna um resultado.</p>
<p>Os parâmetros são declarados no cabeçalho da função; aqui, há apenas <code>n</code>. Dentro da função, o parâmetro se comporta como uma variável local cujo valor foi passado do lado externo no momento da chamada.</p>
<p>A instrução <code>return</code> encerra a função e estabelece o valor retornado. Ela não precisa aparecer apenas ao final; saídas antecipadas são permitidas.</p>
<p><code>"assert" statement: 112</code></p>
<p><code>Funcitons: properties & features: 70</code></p>
<hr>
<p>The main function of the Fibonacci example calls predefined “native” functions,
like getvalue and printf, as well as the user-defined function fibonacci.
From the perspective of calling a function (as in function main), there is no
difference between user-defined and native functions.</p>
<p>The Fibonacci numbers sequence describes a surprising variety of natural phe-
nomena. For example, the two or three sets of spirals in pineapples, pine cones
and sunflowers usually have consecutive Fibonacci numbers between 5 and 89
as their number of spirals. The numbers that occur naturally in branching
patterns (e.g. that of plants) are indeed Fibonacci numbers. Finally, although
the Fibonacci sequence is not a geometric sequence, the further the sequence
is extended, the more closely the ratio between successive terms approaches
the Golden Ratio, of 1.618. . . ∗ that appears so often in art and architecture.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-call-by-reference--call-by-value>• Call-by-reference & call-by-value<a href=#-call-by-reference--call-by-value class=hash-link aria-label="Link direto para • Call-by-reference & call-by-value" title="Link direto para • Call-by-reference & call-by-value">​</a></h3>
<p>Dates are a particularly rich source of algorithms and conversion routines,
because the calenders that a date refers to have known such a diversity,
through time and around the world.</p>
<p>The “Julian Day Number” is attributed to Josephus Scaliger† and it counts
the number of days since November 24, 4714 BC (proleptic Gregorian cal-
endar‡). Scaliger chose that date because it marked the coincidence of three
well-established cycles: the 28-year Solar Cycle (of the old Julian calendar),
the 19-year Metonic Cycle and the 15-year Indiction Cycle (periodic taxes or gov-
ernmental requisitions in ancient Rome), and because no literature or recorded
history was known to predate that particular date in the remote past. Scaliger
used this concept to reconcile dates in historic documents, later astronomers
embraced it to calculate intervals between two events more easily.</p>
<hr>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=-the-exact-value-for-the-golden-ratio-is-125--1-the-relation-between-fibonacci-numbers-and-the-golden-ratio-also-allows-for-a-direct-calculation-of-any-sequence-number-instead-of-the-iterative-method-described-here>∗ The exact value for the Golden Ratio is 1/2(√5 + 1). The relation between Fibonacci numbers and the Golden Ratio also allows for a “direct” calculation of any sequence number, instead of the iterative method described here.<a href=#-the-exact-value-for-the-golden-ratio-is-125--1-the-relation-between-fibonacci-numbers-and-the-golden-ratio-also-allows-for-a-direct-calculation-of-any-sequence-number-instead-of-the-iterative-method-described-here class=hash-link aria-label="Link direto para ∗ The exact value for the Golden Ratio is 1/2(√5 + 1). The relation between Fibonacci numbers and the Golden Ratio also allows for a “direct” calculation of any sequence number, instead of the iterative method described here." title="Link direto para ∗ The exact value for the Golden Ratio is 1/2(√5 + 1). The relation between Fibonacci numbers and the Golden Ratio also allows for a “direct” calculation of any sequence number, instead of the iterative method described here.">​</a></h6>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=-there-is-some-debate-on-exactly-what-josephus-scaliger-invented-and-who-or-what-he-called-it-after>∗ There is some debate on exactly what Josephus Scaliger invented and who or what he called it after.<a href=#-there-is-some-debate-on-exactly-what-josephus-scaliger-invented-and-who-or-what-he-called-it-after class=hash-link aria-label="Link direto para ∗ There is some debate on exactly what Josephus Scaliger invented and who or what he called it after." title="Link direto para ∗ There is some debate on exactly what Josephus Scaliger invented and who or what he called it after.">​</a></h6>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=-the-gregorian-calendar-was-decreed-to-start-on-15-october-1582-by-pope-gregory-xiii-which-means-that-earlier-dates-do-not-really-exist-in-the-gregorian-calendar-when-extending-the-gregorian-calendar-to-days-before-15-october-1582-we-refer-to-it-as-the-proleptic-gregorian-calendar>∗ The Gregorian calendar was decreed to start on 15 October 1582 by pope Gregory XIII, which means that earlier dates do not really exist in the Gregorian calendar. When extending the Gregorian calendar to days before 15 October 1582, we refer to it as the proleptic Gregorian calendar.<a href=#-the-gregorian-calendar-was-decreed-to-start-on-15-october-1582-by-pope-gregory-xiii-which-means-that-earlier-dates-do-not-really-exist-in-the-gregorian-calendar-when-extending-the-gregorian-calendar-to-days-before-15-october-1582-we-refer-to-it-as-the-proleptic-gregorian-calendar class=hash-link aria-label="Link direto para ∗ The Gregorian calendar was decreed to start on 15 October 1582 by pope Gregory XIII, which means that earlier dates do not really exist in the Gregorian calendar. When extending the Gregorian calendar to days before 15 October 1582, we refer to it as the proleptic Gregorian calendar." title="Link direto para ∗ The Gregorian calendar was decreed to start on 15 October 1582 by pope Gregory XIII, which means that earlier dates do not really exist in the Gregorian calendar. When extending the Gregorian calendar to days before 15 October 1582, we refer to it as the proleptic Gregorian calendar.">​</a></h6>
<p><code>Native function interface: 85</code></p>
<hr>
<p>Julian Day numbers (sometimes denoted with unit “jd”) should not be con-
Aqui estamos falando de “Julian Day Numbers” (JDN), que não devem ser confundidos com “Julian Dates” (número de dias desde o início do ano) nem com o calendário juliano criado por Júlio César.</p>
<p>O programa abaixo calcula o número de dias julianos a partir de uma data do calendário gregoriano (próleptico) e também faz o caminho inverso. Nesse calendário, o primeiro ano é 1 d.C. e o anterior é 1 a.C.; o ano zero <strong>não</strong> existe. Por isso, o programa considera anos negativos para datas a.C. e positivos (não zero) para anos d.C.</p>
<p>Listing: julian.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/*  calculate  Julian  Day  number  from  a  date,  and  vice  versa  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  d</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  m</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  y</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  jdn</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print  </span><span class="token string" style=color:#e3116c>"Give  a  date  (dd-mm-yyyy):  "</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    d  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">_</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  ’</span><span class="token operator" style=color:#393A34>-</span><span class="token plain">’</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  ’</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">’</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    m  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">_</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  ’</span><span class="token operator" style=color:#393A34>-</span><span class="token plain">’</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  ’</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">’</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    y  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    jdn  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>DateToJulian</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">d</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  m</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  y</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>printf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"Date  %d/%d/%d  =  %d  JD\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  d</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  m</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  y</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  jdn</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print  </span><span class="token string" style=color:#e3116c>"Give  a  Julian  Day  Number:  "</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    jdn  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    JulianToDate  jdn</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  d</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  m</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  y</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    printf  </span><span class="token string" style=color:#e3116c>"%d  JD  =  %d/%d/%d\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  jdn</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  d</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  m</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  y</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>DateToJulian</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">day</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  month</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  year</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  The  first  year  is  1.  Year  0  does  not  exist:  it  is  1  BC  (or  -1)  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    assert  year  </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">year  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    year</span><span class="token operator" style=color:#393A34>++</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  move  January  and  February  to  the  end  of  the  previous  year  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">month  </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    year</span><span class="token operator" style=color:#393A34>--</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  month  </span><span class="token operator" style=color:#393A34>+=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>12</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  jdn  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>365</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">year  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  year</span><span class="token operator" style=color:#393A34>/</span><span class="token number" style=color:#36acaa>4</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  year</span><span class="token operator" style=color:#393A34>/</span><span class="token number" style=color:#36acaa>100</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  year</span><span class="token operator" style=color:#393A34>/</span><span class="token number" style=color:#36acaa>400</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>153</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">month  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>457</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>/</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>5</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  day  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>1721119</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain">  jdn</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>JulianToDate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">jdn</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">day</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">month</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">year</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    jdn  </span><span class="token operator" style=color:#393A34>-=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>1721119</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  approximate  year,  then  adjust  in  a  loop  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    year  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>400</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">  jdn</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>/</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>146097</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>while</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>365</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">year  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  year</span><span class="token operator" style=color:#393A34>/</span><span class="token number" style=color:#36acaa>4</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  year</span><span class="token operator" style=color:#393A34>/</span><span class="token number" style=color:#36acaa>100</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  year</span><span class="token operator" style=color:#393A34>/</span><span class="token number" style=color:#36acaa>400</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">  jdn</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        year</span><span class="token operator" style=color:#393A34>++</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    year</span><span class="token operator" style=color:#393A34>--</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  determine  month  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    jdn  </span><span class="token operator" style=color:#393A34>-=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>365</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">year  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  year</span><span class="token operator" style=color:#393A34>/</span><span class="token number" style=color:#36acaa>4</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  year</span><span class="token operator" style=color:#393A34>/</span><span class="token number" style=color:#36acaa>100</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  year</span><span class="token operator" style=color:#393A34>/</span><span class="token number" style=color:#36acaa>400</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    month  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>5</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">jdn  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>457</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>/</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>153</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  determine  day  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    day  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  jdn  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>153</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">month  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>457</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>/</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>5</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  move  January  and  February  to  start  of  the  year  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">month  </span><span class="token operator" style=color:#393A34>></span><span class="token plain">  </span><span class="token number" style=color:#36acaa>12</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        month  </span><span class="token operator" style=color:#393A34>-=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>12</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  year</span><span class="token operator" style=color:#393A34>++</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  adjust  negative  years  (year  0  must  become  1  BC,  or  -1)  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">year  </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        year</span><span class="token operator" style=color:#393A34>--</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<p><code>main</code> começa criando variáveis para armazenar dia, mês, ano e o JDN calculado. Em seguida lê a data (três chamadas a <code>getvalue</code>) e chama <code>DateToJulian</code> para obter o número. Depois de calcular, imprime a data digitada e o JDN correspondente. Foquemos agora em <code>DateToJulian</code>.</p>
<p>Logo no início, a função incrementa o ano caso ele seja negativo —isso serve para lidar com a ausência do ano zero no calendário gregoriano próleptico. Em outras palavras, <code>DateToJulian</code> modifica os argumentos recebidos (mais tarde, altera também <code>month</code>). Dentro da função, o argumento se comporta como variável local e pode ser alterado; contudo, essas mudanças são locais a <code>DateToJulian</code>. A função <code>main</code> passa <code>d</code>, <code>m</code> e <code>y</code>, que são mapeados para <code>day</code>, <code>month</code> e <code>year</code>. Embora <code>DateToJulian</code> modifique <code>year</code> e <code>month</code>, ela não altera <code>y</code> e <code>m</code> em <code>main</code>, apenas suas cópias locais. Esse conceito é conhecido como “passagem por valor”.</p>
<p>O exemplo usa nomes diferentes para as variáveis locais de <code>main</code> e <code>DateToJulian</code> justamente para tornar a explicação mais clara. Se renomearmos <code>d</code>, <code>m</code> e <code>y</code> para <code>day</code>, <code>month</code> e <code>year</code>, a situação continua a mesma: haverá dois conjuntos de variáveis com esses nomes —algo perfeitamente válido em pawn.</p>
<p><code>"Call by value" versus "Call by reference": 71</code></p>
<hr>
<p>O restante de <code>DateToJulian</code> é aritmética pura, sem novidades para a linguagem.</p>
<p>Voltando ao segundo trecho de <code>main</code>, vemos que agora ele solicita um número juliano e chama <code>JulianToDate</code> para encontrar a data correspondente. Essa função é interessante porque recebe um único argumento (o JDN) e precisa produzir três valores: dia, mês e ano. Mas uma função só pode retornar um valor —um <code>return</code> contém apenas uma expressão. Para resolver isso, <code>JulianToDate</code> pede explicitamente que as alterações feitas em alguns argumentos sejam copiadas de volta para as variáveis do chamador. Assim, em <code>main</code>, as variáveis que devem receber o resultado são passadas como argumentos.</p>
<p><code>JulianToDate</code> marca os argumentos que devem ser “copiados de volta” com o prefixo <code>&</code>. Argumentos com <code>&</code> são tratados de forma especial: em vez de passar apenas o valor, a função recebe acesso direto à variável original. Isso se chama “passagem por referência”, e o argumento se torna uma “referência”.</p>
<p>Em outras palavras, se <code>main</code> passa <code>y</code> e <code>JulianToDate</code> o mapeia para <code>year</code>, qualquer alteração feita em <code>year</code> refletirá em <code>y</code>. Somente por meio de argumentos por referência uma função pode modificar diretamente uma variável declarada em outra função.</p>
<p>Resumindo: se uma função retorna apenas um valor, use o <code>return</code>; se precisa retornar vários, use argumentos por referência. Ambos podem coexistir na mesma função —por exemplo, retornar o resultado principal via referência e um código de erro no <code>return</code>.</p>
<p>Observação: muitas aplicações desktop usam conversões para e a partir de números julianos (ou variantes) para calcular intervalos entre datas ou descobrir a data exata daqui a 90 dias, por exemplo.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-números-racionais>• Números racionais<a href=#-números-racionais class=hash-link aria-label="Link direto para • Números racionais" title="Link direto para • Números racionais">​</a></h3>
<p>Até aqui lidamos apenas com números inteiros. Pawn também pode trabalhar com valores fracionários, chamados de “números racionais”, mas o suporte depende da aplicação hospedeira.</p>
<p>Os racionais podem ser implementados como números de ponto flutuante ou de ponto fixo. Ponto flutuante é comum em cálculos gerais e científicos; ponto fixo é indicado para aplicações financeiras ou quando os erros de arredondamento devem ser inexistentes (ou, ao menos, previsíveis). O kit de ferramentas do pawn inclui módulos para ambos, com detalhes e compromissos explicados na documentação específica. Entretanto, o aplicativo host pode oferecer apenas um dos formatos, os dois ou nenhum∗. O programa abaixo exige que haja suporte a pelo menos um tipo de racional; caso contrário, ele não executa.</p>
<p>Listing: c2f.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  Rational</span><span class="token operator" style=color:#393A34>:</span><span class="token plain">  Celsius</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  Rational</span><span class="token operator" style=color:#393A34>:</span><span class="token plain">  Fahrenheit</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print  </span><span class="token string" style=color:#e3116c>"Celsius\t  Fahrenheit\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Celsius  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>5</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  Celsius  </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>25</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  Celsius</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        Fahrenheit  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Celsius  </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>1.8</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>32</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        printf  </span><span class="token string" style=color:#e3116c>"%r  \t  %r\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  Celsius</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  Fahrenheit</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>O programa converte uma tabela de graus Celsius para Fahrenheit. A primeira diretiva importa as definições necessárias para trabalhar com racionais. O arquivo <code>rational</code> carrega suporte a ponto flutuante ou ponto fixo, conforme o disponível.</p>
<p>As variáveis <code>Celsius</code> e <code>Fahrenheit</code> são declaradas com a tag <code>Rational:</code> entre <code>new</code> e o nome da variável. Tags indicam a finalidade da variável, o uso permitido e, no caso específico de racionais, sua representação em memória.</p>
<hr>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=-actually-this-is-already-true-of-all-native-functions-including-all-native-functions-that-the-examples-in-this-manual-use>∗ Actually, this is already true of all native functions, including all native functions that the examples in this manual use.<a href=#-actually-this-is-already-true-of-all-native-functions-including-all-native-functions-that-the-examples-in-this-manual-use class=hash-link aria-label="Link direto para ∗ Actually, this is already true of all native functions, including all native functions that the examples in this manual use." title="Link direto para ∗ Actually, this is already true of all native functions, including all native functions that the examples in this manual use.">​</a></h6>
<p><code>Tag names: 68</code></p>
<hr>
<p>The Rational: tag tells the pawn parser that the variables Celsius and Fahrenheit
contain fractional values, rather than whole numbers.</p>
<p>The equation for obtaining degrees Fahrenheit from degrees Celsius is</p>
<p>°F = ⁹⁄₅ + 32 °C</p>
<p>The program uses the value 1.8 for the quotient 9/₅. When rational number
support is enabled, pawn supports values with a fractional part behind<br>
<!-- -->the decimal point.</p>
<p>The only other non-trivial change from earlier programs is that the format
string for the printf function now has variable placeholders denoted with
“%r” instead of “%d”. The placeholder %r prints a rational number at
the position; %d is only for integers (“whole numbers”).</p>
<p>I used the include file “rational” rather than “float” or “fixed” in an
attempt to make the example program portable. If you know that the host
application supports floating point arithmetic, it may be more convenient to
“#include” the definitions from the file float and use the tag Float: instead
of Rational —when doing so, you should also replace %r by %f in the call to
printf. For details on fixed point and floating point support, please see the
application notes “Fixed Point Support Library” and “Floating Point Support
Library” that are available separately.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-strings>• Strings<a href=#-strings class=hash-link aria-label="Link direto para • Strings" title="Link direto para • Strings">​</a></h3>
<p>pawn has no intrinsic “string” type; character strings are stored in arrays, with
the convention that the array element behind the last valid character is zero.
Working with strings is therefore equivalent with working with arrays.</p>
<p>Among the simplest of encryption schemes is the one called “ROT13” —
actually the algorithm is quite “weak” from a cryptographical point of view. It
is most widely used in public electronic forums (BBSes, Usenet) to hide texts
from casual reading, such as the solution to puzzles or riddles. ROT13 simply
“rotates” the alphabet by half its length, i.e. 13 characters. It is a symmetric
operation: applying it twice on the same text reveals the original.</p>
<hr>
<p>Listing: rot13.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/*  Simple  encryption,  using  ROT13  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    printf  </span><span class="token string" style=color:#e3116c>"Please  type  the  string  to  mangle:  "</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  str</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>100</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    getstring  str</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token plain">  str</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    rot13  str</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    printf  </span><span class="token string" style=color:#e3116c>"After  mangling,  the  string  is:  \"%s\"\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  str</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>rot13</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new  index  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  index</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">’a’  </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain">  string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain">  ’z’</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  ’a’  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>13</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>%</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>26</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  ’a’</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain">  </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">’A’  </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain">  string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain">  ’Z’</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  ’A’  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>13</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>%</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>26</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  ’A’</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>No cabeçalho de <code>rot13</code>, o parâmetro <code>string</code> é declarado como array, mas sem tamanho —não há valor entre colchetes. Quando um tamanho é especificado no cabeçalho, ele precisa coincidir com o tamanho do argumento passado na chamada. Ao omitir, removemos essa restrição e permitimos que a função opere sobre arrays de qualquer comprimento. É preciso, então, ter outra forma de descobrir o tamanho (máximo). Para strings, basta procurar pelo terminador zero.</p>
<p>O <code>for</code> que percorre a string é típico em rotinas de processamento de texto. Repare que a condição é <code>string[index]</code>. Em pawn, qualquer valor diferente de zero é considerado “true”; valores iguais a zero são “false”. Assim, quando <code>string[index]</code> chega a zero, o loop termina.</p>
<p>O algoritmo ROT13 rotaciona apenas letras; dígitos, pontuação e caracteres especiais permanecem intactos. Além disso, maiúsculas e minúsculas são tratados separadamente. Dentro do loop, dois <code>if</code> filtram os caracteres relevantes. O encadeamento do segundo <code>if</code> no <code>else</code> do primeiro é um padrão comum para testar várias condições mutuamente exclusivas.</p>
<p>No início deste capítulo falamos sobre passagem por valor e por referência. No caso de strings (ou arrays em geral), lembre-se de que pawn sempre passa arrays por referência. Isso economiza memória e melhora o desempenho, já que copiar uma estrutura grande apenas para passá-la por valor consumiria tempo e memória adicionais.</p>
<hr>
<p><code>A function that takes an array as an argument and that does not change it, may mark the argument as “const”; see page 72</code></p>
<p>Por causa dessa regra, <code>rot13</code> pode modificar o parâmetro <code>string</code> sem precisar declará-lo explicitamente como argumento por referência.</p>
<p>Outro ponto interessante são as condições dos <code>if</code>. A primeira usa <code>’a’ &lt;= string[index] &lt;= ’z’</code>, expressão verdadeira se, e somente se, <code>’a’ &lt;= string[index]</code> <strong>e</strong> <code>string[index] &lt;= ’z’</code>. Esse encadeamento de operadores relacionais é comum para expressar múltiplas comparações em uma única condição.</p>
<p>Por fim, repare como o último <code>printf</code> em <code>main</code> usa <code>\"</code> para imprimir aspas duplas. Normalmente esse caractere encerraria a string literal; a sequência de escape insere a aspa no texto.</p>
<p>Ainda falando de strings e arrays, o próximo programa divide uma frase em palavras e contabiliza quantas são. É um exemplo simples que apresenta alguns recursos novos da linguagem.</p>
<p>Listing: wcount.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/*  word  count:  count  words  on  a  string  that  the  user  types  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print  </span><span class="token string" style=color:#e3116c>"Please  type  a  string:  "</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>100</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    getstring  string</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token plain">  string</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  count  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  word</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>20</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  index</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>;</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        word  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>strtok</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">string</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  index</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>strlen</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">word</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>==</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>break</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        count</span><span class="token operator" style=color:#393A34>++</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        printf  </span><span class="token string" style=color:#e3116c>"Word  %d:  ’%s’\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  count</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  word</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    printf  </span><span class="token string" style=color:#e3116c>"\nNumber  of  words:  %d\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  count</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>strtok</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>const</span><span class="token plain">  string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  length  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>strlen</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">string</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  skip  leading  white  space  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>while</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">index  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">  length  </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain">  string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain">  ’  ’</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        index</span><span class="token operator" style=color:#393A34>++</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  store  the  word  letter  for  letter  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  offset  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  index                            </span><span class="token comment" style=color:#999988;font-style:italic>/*  save  start position  of  token  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  result</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>20</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">                                  </span><span class="token comment" style=color:#999988;font-style:italic>/*  string  to store  the  word  in  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>while</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">index  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">  length</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain">  string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>></span><span class="token plain">  ’  ’</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain">  index  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  offset  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">  </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token plain">  result  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        result</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  offset</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        index</span><span class="token operator" style=color:#393A34>++</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    result</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  offset</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  EOS                 </span><span class="token comment" style=color:#999988;font-style:italic>/*  zero-terminate  the string  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain">  result</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<p><code>Relational operators: 107</code></p>
<p><code>Escape sequence: 99</code></p>
<p><code>main</code> primeiro mostra uma mensagem e lê a string digitada. Depois entra em um loop: escrever <code>for (;;)</code> cria um laço sem inicialização, incremento ou teste —um loop infinito, equivalente a <code>while (true)</code>. A diferença é que o analisador de pawn gera um aviso para <code>while (true)</code> (“expressão redundante; sempre verdadeira”), mas <code>for (;;)</code> passa sem alertas.</p>
<p>Loops infinitos são úteis quando precisamos de um teste no meio —um híbrido entre <code>while</code> e <code>do...while</code>. Pawn não tem essa construção diretamente, mas podemos simulá-la com um loop infinito e um <code>break</code> condicional. No exemplo:</p>
<ul>
<li>a palavra é extraída da string (código antes do teste);</li>
<li>verificamos se há uma nova palavra; se não houver, saímos do loop (teste no meio);</li>
<li>imprimimos a palavra e sua posição (código depois do teste).</li>
</ul>
<p>A linha <code>word = strtok(string, index)</code> (junto com a declaração de <code>word</code>) mostra que pawn permite atribuir arrays e retornar arrays de funções. O analisador verifica se o array retornado por <code>strtok</code> tem o mesmo tamanho/dimensão da variável que o recebe.</p>
<p><code>strlen</code> é uma função nativa; <code>strtok</code> não e precisa ser implementada. Ela foi inspirada na homônima de C/C++, mas não modifica a string original: em vez disso, copia palavra por palavra para um array local, que é retornado no final.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-arrays-e-enumerações-dados-estruturados>• Arrays e enumerações (dados estruturados)<a href=#-arrays-e-enumerações-dados-estruturados class=hash-link aria-label="Link direto para • Arrays e enumerações (dados estruturados)" title="Link direto para • Arrays e enumerações (dados estruturados)">​</a></h3>
<p>Em uma linguagem sem tipos, podemos atribuir funções diferentes a elementos específicos de um mesmo array. Pawn suporta constantes enumeradas com uma extensão que simula parte da funcionalidade das “structs” ou “records” de outras linguagens.</p>
<p>O exemplo a seguir é maior do que os anteriores e demonstra outros recursos, como variáveis globais e parâmetros nomeados.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/*  Priority  queue  (for  simple  text  strings)  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>enum</span><span class="token plain">  </span><span class="token class-name">message</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    text</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>40</span><span class="token plain">  </span><span class="token keyword" style=color:#00009f>char</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    priority</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  msg</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">message</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  insert  a  few  items  (read  from  console  input)  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    printf  </span><span class="token string" style=color:#e3116c>"Please  insert  a  few  messages  and  their  priorities;  \</span><br></span><span class=token-line style=color:#393A34><span class="token string" style=color:#e3116c>        end  with  an  empty  string\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>;</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        printf  </span><span class="token string" style=color:#e3116c>"Message:    "</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        getstring  </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">string  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  msg</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">text</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">maxlength  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>40</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">pack  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  true</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>strlen</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">msg</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">text</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>==</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>break</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        printf  </span><span class="token string" style=color:#e3116c>"Priority:  "</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        msg</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">priority</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>!</span><span class="token function" style=color:#d73a49>insert</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">msg</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            printf  </span><span class="token string" style=color:#e3116c>"Queue  is  full,  cannot  insert  more  items\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>break</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  now  print  the  messages  extracted  from  the  queue  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    printf  </span><span class="token string" style=color:#e3116c>"\nContents  of  the  queue:\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>while</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>extract</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">msg</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        printf  </span><span class="token string" style=color:#e3116c>"[%d]  %s\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  msg</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">priority</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  msg</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">text</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>const</span><span class="token plain">  queuesize  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>10</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">new  queue</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">queuesize</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">message</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">new  queueitems  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>insert</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>const</span><span class="token plain">  item</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">message</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  check  if  the  queue  can  hold  one  more  message  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">queueitems  </span><span class="token operator" style=color:#393A34>==</span><span class="token plain">  queuesize</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain">  false                         </span><span class="token comment" style=color:#999988;font-style:italic>/*  queue  is  full  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  find  the  position  to  insert  it  to  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  pos  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  queueitems                 </span><span class="token comment" style=color:#999988;font-style:italic>/*  start  at  the  bottom  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>while</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">pos  </span><span class="token operator" style=color:#393A34>></span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain">  item</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">priority</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>></span><span class="token plain">  queue</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">pos</span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">priority</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token operator" style=color:#393A34>--</span><span class="token plain">pos                                        </span><span class="token comment" style=color:#999988;font-style:italic>/*  higher  priority:  move  one  position  up  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  make  place  for  the  item  at  the  insertion  spot  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new  i  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  queueitems</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  i  </span><span class="token operator" style=color:#393A34>></span><span class="token plain">  pos</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>--</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        queue</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  queue</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">i</span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  add  the  message  to  the  correct  slot  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        queue</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">pos</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  item</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    queueitems</span><span class="token operator" style=color:#393A34>++</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain">  true</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>extract</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">item</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">message</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  check  whether  the  queue  has  one  more  message  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">queueitems  </span><span class="token operator" style=color:#393A34>==</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain">  false                         </span><span class="token comment" style=color:#999988;font-style:italic>/*  queue  is  empty  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  copy  the  topmost  item  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    item  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  queue</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>--</span><span class="token plain">queueitems</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  move  the  queue  one  position  up  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new  i  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  i  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">  queueitems</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>++</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        queue</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  queue</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">i</span><span class="token operator" style=color:#393A34>+</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain">  true</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<p><code>"for" loop: 113</code></p>
<p><code>"enum" statement: 101</code></p>
<p><code>"char" operator: 110</code></p>
<p>Near the top of the program listing is the declaration of the enumeration mes-
sage. This enumeration defines two constants: text, which is zero, and pri-
ority, which is 11 (assuming a 32-bit cell). The idea behind an enumeration
is to quickly define a list of symbolic constants without duplicates. By
default, every constant in the list is 1 higher than its predecessor and the very<br>
<!-- -->first constant in the list is zero. However, you may give an extra increment for a
constant so that the successor has a value of 1 plus that extra increment. The</p>
<p>text constant specifies an extra increment of 40 char. In pawn, char is an
operator, it returns the number of cells needed to
hold a packed string of the</p>
<p>specified number of characters. Assuming a 32-bit cell and a 8-bit character,
10 cells can hold 40 packed characters.</p>
<p>Immediately at the top of function main, a new array variable is declared with
the size of message. The symbol message is the name of the enumeration. It
is also a constant with the value of the last constant in the enumeration list
plus the optional extra increment for that last element. So in this example,
message is 12. That is to say, array msg is declared to hold 12 cells.</p>
<p>Further in main are two loops. The for loop reads strings and priority values
from the console and inserts them in a queue. The while loop below<br>
<!-- -->that
extracts element by element from the queue and prints the information on the
screen. The point to note, is that the for loop stores both the string and the
priority number (an integer) in the same variable msg; indeed, function main
declares only a single variable. Function getstring stores the message text
that you type starting at array msg[text] while the priority value is stored
(by an assignment a few lines lower) in msg[priority]. The printf function
in the while loop reads the string and the value from those positions as well.</p>
<p>At the same time, the msg array is an entity on itself: it is passed in its
entirety
to function insert. That function, near the end, says “queue[queueitems]</p>
<p>= item”, where item is an array with size message and queue is a<br>
<!-- -->two-
dimensional array that holds queuesize elements of size message. The decla-
ration of queue and queuesize are just above function insert.</p>
<p>The example implements a “priority queue”. You can insert a number<br>
<!-- -->of
messages into the queue and when these messages all have the same priority,
they are extracted from the queue in the same order. However, when<br>
<!-- -->the
messages have different priorities, the one with the highest priority comes out
first. The “intelligence” for this operation is inside function insert: it
first
determines the position of the new message to add, then moves a few messages
one position upward to make space for the new message. Function extract
simply always retrieves the first element of the queue and shifts all remaining
elements down by one position.</p>
<p>Note that both functions insert and extract work on two shared variables,
queue and queueitems. A variable that is declared inside a function,<br>
<!-- -->like
variable msg in function main can only be accessed from within that function.
A “global variable” is accessible by all functions, and that variable is
declared
outside the scope of any function. Variables must still be declared before they
are used, so main cannot access variables queue and queueitems, but both
insert and extract can.</p>
<hr>
<p>Function extract returns the messages with the highest priority via its func-
tion argument item. That is, it changes its function argument by copying the
first element of the queue array into item. Function insert copies in the other
direction and it does not change its function argument item. In such a case,
it is advised to mark the function argument as “const”. This helps the pawn
parser to both check for errors and to generate better (more compact, quicker) code.</p>
<p>A final remark on this latest sample is the call to getstring in function main:
note how the parameters are attributed with a description. The first param-
eter is labeled “.string”, the second “.maxlength” and the third “.pack”.
Function getstring receives “named parameters” rather than positional pa-
rameters. The order in which named parameters are listed is not important.
Named parameters are convenient in specifying —and deciphering— long pa-
rameter lists.</p>
<hr>
<p><code>Named parameters: 74</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-bit-operations-to-manipulate-sets>• Bit operations to manipulate ‘‘sets’’<a href=#-bit-operations-to-manipulate-sets class=hash-link aria-label="Link direto para • Bit operations to manipulate ‘‘sets’’" title="Link direto para • Bit operations to manipulate ‘‘sets’’">​</a></h3>
<p>A few algorithms are most easily solved with “set operations”, like
intersection,
union and inversion. In the figure below, for example, we want to design an
algorithm that returns us the points that can be reached from some other point
in a specified maximum number of steps. For example, if we ask it to
return the points that can be reached in two steps starting from B, the algorithm has
to return C, D, E and F, but not G because G takes three steps from B.</p>
<p>Our approach is to keep, for each point in the graph, the set of other points
that it can reach in one step —this is the “next_step” set. We<br>
<!-- -->also have a “result” set that keeps all points that we have found so far. We start by
setting the result set equal to the next_step set for the departure point. Now
we have in the result set all points that one can reach in one step. Then, for
every point in our result set, we create a union of the result set and the
next_step set for that point. This process is iterated for a specified number of loops.</p>
<hr>
<p>An example may clarify the procedure outlined above. When the departure
point is B, we start by setting the result set to D and E —these are the
points that one can reach from B in one step. Then, we walk through
the result set. The first point that we encounter in the set is D, and we check
what points can be reached from D in one step: these are C and F. So we add
C and F to the result set. We knew that the points that can be reached from
D in one step are C and F, because C and F are in the next_step set for</p>
<p>D. So what we do is to merge the next_step set for point D into the result
set. The merge is called a “union” in set theory. That handles D. The original
result set also contained point E, but the next_step set for E is empty, so
no more point is added. The new result set therefore now contains C, D, E and F.</p>
<p><img decoding=async loading=lazy src=https://i.ibb.co/m9Dq7x2/image.png alt=img class=img_ev3q></p>
<p>A set is a general purpose container for elements. The only information that
a set holds of an element is whether it is present in the set or not. The order
of elements in a set is insignificant and a set cannot contain the same element</p>
<p>multiple times. The pawn language does not provide a “set” data type or
operators that work on sets. However, sets with up to 32 elements can be
simulated by bit operations. It takes just one bit to store a “present/absent”
status and a 32-bit cell can therefore maintain the status for 32 set elements
—provided that each element is assigned a unique bit position.</p>
<p>The relation between set operations and bitwise operations is summarized in
the following table. In the table, an upper case letter stands for a set and a
lower case letter for an element from that set.</p>
<table><thead><tr><th>concept<th>mathematical notation<th>pawn expression<tbody><tr><td>intersection<td>A ∩ B<td>A & B<tr><td>union<td>A ∪ B<td>A I B<tr><td>complement<td>A<td>~A<tr><td>empty set<td>ε<td>0<tr><td>membership<td>x ∈ A<td>(1 &lt;&lt; x ) & A</table>
<hr>
<p>To test for membership —that is, to query whether a set holds a particular
element, create a set with just one element and take the intersection. If the
result is 0 (the empty set) the element is not in the set. Bit numbering starts
typically at zero; the lowest bit is bit 0 and the highest bit in a 32-bit cell
is bit 31. To make a cell with only bit 7 set, shift the value 1 left by seven
—or in a pawn expression: “1 &lt;&lt; 7”.</p>
<p>Below is the program that implements the algorithm described earlier to find
all points that can be reached from a specific departure in a given number of
steps. The algorithm is completely in the findtargets function.</p>
<p>Listing: set.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/*  Set  operations,  using  bit  arithmetic  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>enum</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&lt;&lt;=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain">  A  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  B</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  C</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  D</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  E</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  F</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  G  </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  nextstep</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain">  C  </span><span class="token operator" style=color:#393A34>|</span><span class="token plain">  E</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">       </span><span class="token comment" style=color:#999988;font-style:italic>/*  A  can  reach  C  and  E  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">           D  </span><span class="token operator" style=color:#393A34>|</span><span class="token plain">  E</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">          </span><span class="token comment" style=color:#999988;font-style:italic>/*  B    "        "      D  and  E  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">           G</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">                </span><span class="token comment" style=color:#999988;font-style:italic>/*  C    "        "      G  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">           C  </span><span class="token operator" style=color:#393A34>|</span><span class="token plain">  F</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">          </span><span class="token comment" style=color:#999988;font-style:italic>/*  D    "        "      C  and  F  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">           </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">                </span><span class="token comment" style=color:#999988;font-style:italic>/*  E    "        "      none  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">           </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">                </span><span class="token comment" style=color:#999988;font-style:italic>/*  F    "        "      none  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">           E  </span><span class="token operator" style=color:#393A34>|</span><span class="token plain">  F</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">          </span><span class="token comment" style=color:#999988;font-style:italic>/*  G    "        "      E  and  F  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>pragma</span><span class="token macro property" style=color:#36acaa>  </span><span class="token macro property expression" style=color:#36acaa>unused  A</span><span class="token macro property expression punctuation" style=color:#393A34>,</span><span class="token macro property expression" style=color:#36acaa>  B</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print  </span><span class="token string" style=color:#e3116c>"The  departure  point:  "</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  source  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>clamp</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">value  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>toupper</span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>getchar</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  ’A’</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">min  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">max  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token plain">  nextstep  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                 </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print  </span><span class="token string" style=color:#e3116c>"\nThe  number  of  steps:  "</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  steps  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  make  the  set  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  result  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>findtargets</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">source</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  steps</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  nextstep</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    printf  </span><span class="token string" style=color:#e3116c>"The  points  reachable  from  %c  in  %d  steps:  "</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  source</span><span class="token operator" style=color:#393A34>+</span><span class="token plain">’A’</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    steps</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new  i  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  i  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">  </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token plain">  nextstep</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  i</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">result  </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>&lt;&lt;</span><span class="token plain">  i</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            printf  </span><span class="token string" style=color:#e3116c>"%c  "</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  i  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  ’A’</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>findtargets</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">source</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  steps</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  nextstep</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  numpoints  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token plain">  nextstep</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  result  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  addedpoints  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  nextstep</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">source</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>while</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">steps</span><span class="token operator" style=color:#393A34>--</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>></span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain">  result  </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain">  addedpoints</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        result  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  addedpoints</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new  i  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  i  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">  numpoints</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  i</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">result  </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>1</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>&lt;&lt;</span><span class="token plain">  i</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                addedpoints  </span><span class="token operator" style=color:#393A34>|=</span><span class="token plain">  nextstep</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain">  result</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<p>The enum statement just below the header of the main function declares the
constants for the nodes A to G, but with a twist. Usually, the enum starts
counting from zero; here, the value of the first constant, A, is explicitly set to</p>
<ol>
<li>More noteworthy is the expression “(&lt;&lt;= 1)” between the enum keyword
and the opening brace that starts the constant list: it specifies a “bit
shifting” increment. By default, every constant in an enum list gets a value that is
1 above its predecessor, but you can specify every successive constant
in an enumeration to have a value that is:</li>
</ol>
<p><em>its predecessor incremented by any value (not just 1) —e.g., “(+= 5)”;</em></p>
<p><em>its predecessor multiplied by any value —e.g., “(</em>= 3)”;_</p>
<p><em>its predecessor bit-shifted to the left by any value —e.g., “(&lt;&lt;= 1)”;</em></p>
<p>Note that, in binary arithmetic, shifting left by one bit amounts to the same
as multiplying by two, meaning that <code>(/*= 2)</code> and <code>(&lt;&lt;= 1)</code> do the same thing.</p>
<p>When working with sets, a typical task that pops up is to determine the number
of elements in the set. A straightforward function that does this is below:</p>
<p>Listing: simple bitcount function</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>bitcount</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">set</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  count  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new  i  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  i  </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">  cellbits</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  i</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">set  </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>1</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>&lt;&lt;</span><span class="token plain">  i</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            count</span><span class="token operator" style=color:#393A34>++</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain">  count</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>With a cell size of 32 bits, this function’s loop iterates 32 times to check for
a single bit at each iteration. With a bit of binary arithmetic magic, we can
reduce it to loop only for the number of bits that are “set”.<br>
<!-- -->That is, the following function iterates only once if the input value has only one bit set:</p>
<p>Listing: improved bitcount function</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>bitcount</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">set</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  count  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">set</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>do</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            count</span><span class="token operator" style=color:#393A34>++</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>while</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">set  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  set  </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">set  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain">  count</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<p><code>“enum” statement: 101</code></p>
<p><code>“cellbits” constant: 102</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-a-simple-rpn-calculator>• A simple RPN calculator<a href=#-a-simple-rpn-calculator class=hash-link aria-label="Link direto para • A simple RPN calculator" title="Link direto para • A simple RPN calculator">​</a></h3>
<p>The common mathematical notation, with expressions like “26 3 (5 + 2)”,
is known as the algebraic notation. It is a compact notation and<br>
<!-- -->we have
grown accustomed to it. pawn and by far most other programming languages
use the algebraic notation for their programming expressions. The algebraic</p>
<p>notation does have a few disadvantages, though. For instance, it occasionally
exige que deixemos explícita a ordem das operações com parênteses. A expressão no início desta seção poderia ser reescrita sem parênteses, mas à custa de quase dobrar o tamanho. Na prática, complementamos a notação algébrica com regras de precedência que dizem, por exemplo, que multiplicação vem antes de adição e subtração.∗ Essas regras reduzem muito a necessidade de parênteses, mas não a eliminam. Pior: quando o número de operadores cresce, lembrar a hierarquia de precedência e o nível de cada operador torna-se difícil —motivo pelo qual linguagens ricas em operadores, como APL, abandonam precedência e usam outra abordagem.</p>
<p>Por volta de 1920, o matemático polonês Jan Łukasiewicz demonstrou que, colocando os operadores antes dos operandos em vez de entre eles, a precedência se tornava redundante e parênteses deixavam de ser necessários. Essa notação ficou conhecida como “notação polonesa”.† Mais tarde, Charles Hamblin sugeriu posicionar os operadores <strong>após</strong> os operandos, resultando na “notação polonesa reversa” (RPN).</p>
<hr>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=-these-rules-are-often-summarized-in-a-mnemonic-like-please-excuse-my-dear-aunt-sally-parentheses-exponentiation-multiplication-division-addition-subtraction>∗ These rules are often summarized in a mnemonic like “Please Excuse My Dear Aunt Sally” (Parentheses, Exponentiation, Multiplication, Division, Addition, Subtraction)<a href=#-these-rules-are-often-summarized-in-a-mnemonic-like-please-excuse-my-dear-aunt-sally-parentheses-exponentiation-multiplication-division-addition-subtraction class=hash-link aria-label="Link direto para ∗ These rules are often summarized in a mnemonic like “Please Excuse My Dear Aunt Sally” (Parentheses, Exponentiation, Multiplication, Division, Addition, Subtraction)" title="Link direto para ∗ These rules are often summarized in a mnemonic like “Please Excuse My Dear Aunt Sally” (Parentheses, Exponentiation, Multiplication, Division, Addition, Subtraction)">​</a></h6>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=-polish-notation-is-completely-unrelated-to-hungarian-notation-which-is-just-the-habit-of-adding-type-or-purpose-identification-warts-to-names-of-variables-or-functions>* Polish Notation is completely unrelated to “Hungarian Notation” —which is just the habit of adding “type” or “purpose” identification warts to names of variables or functions<a href=#-polish-notation-is-completely-unrelated-to-hungarian-notation-which-is-just-the-habit-of-adding-type-or-purpose-identification-warts-to-names-of-variables-or-functions class=hash-link aria-label="Link direto para * Polish Notation is completely unrelated to “Hungarian Notation” —which is just the habit of adding “type” or “purpose” identification warts to names of variables or functions" title="Link direto para * Polish Notation is completely unrelated to “Hungarian Notation” —which is just the habit of adding “type” or “purpose” identification warts to names of variables or functions">​</a></h6>
<hr>
<p><code>Algebraic notation is also called “infix” notation</code></p>
<p><code>Reverse Polish Notation is also called “postfix” notation</code></p>
<hr>
<p>O benefício dessa inversão é que os operadores aparecem na mesma ordem em que devem ser executados: ao lê-los da esquerda para a direita, realizamos as operações na mesma sequência. A expressão algébrica desta seção ficaria, em RPN:</p>
<p><code>26 3 5 2 + × −</code></p>
<p>Observando apenas os operadores, temos: primeiro uma soma, depois uma multiplicação e, por fim, uma subtração. Os operandos de cada operador são lidos da direita para a esquerda: os operandos de <code>+</code> são 5 e 2; os de <code>×</code> são o resultado da soma anterior e o valor 3; e assim por diante.</p>
<p>É útil imaginar os valores sendo empilhados, com os operadores removendo um ou mais elementos do topo, efetuando a operação e devolvendo o resultado no topo. Ao percorrer a expressão em RPN, empilhamos 26, 3, 5 e 2 nessa ordem. O operador <code>+</code> remove 5 e 2 e empilha a soma, resultando em “26 3 7”. O operador <code>×</code> remove 3 e 7 e empilha o produto, deixando “26 21”. Por fim, o operador <code>−</code> subtrai 21 de 26 e empilha o valor único 5 —resultado final da expressão.</p>
<p>RPN se popularizou porque é fácil de entender e de implementar (especialmente em calculadoras antigas). Ela também abre espaço para operadores com mais de dois operandos (como integrações) ou com mais de um resultado (como conversões entre coordenadas polares e cartesianas).</p>
<p>Segue o programa principal de uma calculadora em notação polonesa reversa:</p>
<p>Listing: rpn.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/*  a  simple  RPN  calculator  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa>  </span><span class="token macro property expression" style=color:#36acaa>strtok</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa>  </span><span class="token macro property expression" style=color:#36acaa>stack</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa>  </span><span class="token macro property expression" style=color:#36acaa>rpnparse</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print  </span><span class="token string" style=color:#e3116c>"Type  an  expression  in  Reverse  Polish  Notation:  "</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>100</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    getstring  string</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token plain">  string</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    rpncalc  string</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<p>O programa principal em si é bem curto; ele apenas inclui o código de três arquivos auxiliares, cada um responsável por algumas funções que, combinadas, implementam a calculadora. Em programas maiores é comum distribuir a lógica em vários arquivos para facilitar a manutenção.</p>
<p><code>main</code> mostra um prompt e chama a nativa <code>getstring</code> para ler a expressão. Em seguida, invoca <code>rpncalc</code>, que faz o trabalho pesado. A implementação de <code>rpncalc</code> está em <code>rpnparse.inc</code>, reproduzida abaixo:</p>
<p>Listing: rpnparse.inc</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/*  main  rpn  parser  and  lexical  analysis,  part  of  the  RPN  calculator  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa>  </span><span class="token macro property string" style=color:#e3116c>&lt;rational></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa>  </span><span class="token macro property string" style=color:#e3116c>&lt;string></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>enum</span><span class="token plain">  </span><span class="token class-name">token</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    t_type</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">                       </span><span class="token comment" style=color:#999988;font-style:italic>/*  operator  or  token  type  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    Rational</span><span class="token operator" style=color:#393A34>:</span><span class="token plain">  t_value</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">           </span><span class="token comment" style=color:#999988;font-style:italic>/*  value,  if  t_type  is  "Number"  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    t_word</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>20</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">                   </span><span class="token comment" style=color:#999988;font-style:italic>/*  raw  string  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>const</span><span class="token plain">  Number     </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  ’</span><span class="token number" style=color:#36acaa>0</span><span class="token plain">’</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>const</span><span class="token plain">  EndOfExpr  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  ’#’</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>rpncalc</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>const</span><span class="token plain">  string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  index</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">token</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>;</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        field  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>gettoken</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">string</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  index</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>switch</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_type</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain">  Number</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                push  field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain">  ’</span><span class="token operator" style=color:#393A34>+</span><span class="token plain">’</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                push  </span><span class="token function" style=color:#d73a49>pop</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>pop</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain">  ’</span><span class="token operator" style=color:#393A34>-</span><span class="token plain">’</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                push  </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>pop</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>+</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>pop</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain">  ’</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">’</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                push  </span><span class="token function" style=color:#d73a49>pop</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>pop</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain">  ’</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">’</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  ’</span><span class="token operator" style=color:#393A34>:</span><span class="token plain">’</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                push  </span><span class="token number" style=color:#36acaa>1.0</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>/</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>pop</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>pop</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain">  EndOfExpr</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                </span><span class="token keyword" style=color:#00009f>break</span><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>/*  exit  "for"  loop  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>default</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">                printf  </span><span class="token string" style=color:#e3116c>"Unknown  operator  ’%s’\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_word</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    printf  </span><span class="token string" style=color:#e3116c>"Result  =  %r\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>pop</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>clearstack</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        print  </span><span class="token string" style=color:#e3116c>"Stack  not  empty\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  red</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>gettoken</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>const</span><span class="token plain">  string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  first  get  the  next  "word"  from  the  string  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  word</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>20</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    word  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>strtok</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">string</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  index</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/*  then  parse  it  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new  field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">token</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_word</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  word</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>strlen</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">word</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>==</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_type</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  EndOfExpr  </span><span class="token comment" style=color:#999988;font-style:italic>/*  special  "stop"  symbol  */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain">  </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain">  </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">’</span><span class="token number" style=color:#36acaa>0</span><span class="token plain">’  </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain">  word</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain">  ’</span><span class="token number" style=color:#36acaa>9</span><span class="token plain">’</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_type</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  Number</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token function" style=color:#d73a49>rationalstr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">word</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_type</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  word</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain">  </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain">  field</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">```</span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">Essa calculadora usa suporte a números racionais</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> por isso `rpnparse</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">inc` inclui o arquivo `rational`</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"> Quase todas as operações envolvendo racionais ficam escondidas na aritmética</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> as únicas referências diretas são o especificador de formato `</span><span class="token operator" style=color:#393A34>%</span><span class="token plain">r` no `printf` ao final de `rpncalc` e a chamada `rationalstr` dentro de `gettoken`</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">O primeiro ponto curioso em `rpnparse</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">inc` é a declaração `</span><span class="token keyword" style=color:#00009f>enum</span><span class="token plain">`</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> na qual um elemento recebe uma </span><span class="token function" style=color:#d73a49>tag</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">`t_value`</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> e outro define um </span><span class="token function" style=color:#d73a49>tamanho</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">`t_word`</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"> A função `rpncalc` declara a variável `field` como um array cujo tamanho é o símbolo dessa enumeração</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"> Na prática</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> isso faz mais </span><span class="token keyword" style=color:#00009f>do</span><span class="token plain"> que criar um array de </span><span class="token number" style=color:#36acaa>22</span><span class="token plain"> células</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> O “índice” </span><span class="token keyword" style=color:#00009f>do</span><span class="token plain"> array passa a ter a tag `token</span><span class="token operator" style=color:#393A34>:</span><span class="token plain">`</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"> Isso permite indexá</span><span class="token operator" style=color:#393A34>-</span><span class="token plain">lo usando qualquer elemento da enumeração</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> mas impede o uso de valores com outras tags</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"> Em outras palavras</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> `field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_type</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">` é válido</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> enquanto `field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">` gera diagnóstico</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> A tag da enumeração prevalece sobre a eventual tag </span><span class="token keyword" style=color:#00009f>do</span><span class="token plain"> array</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"> `field` em si não tem tag</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> mas `field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">` recebe `Rational</span><span class="token operator" style=color:#393A34>:</span><span class="token plain">`</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> já que o elemento `t_value` foi declarado assim</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"> Isso permite criar arrays cujos elementos têm tags diferentes entre si</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> Quando um elemento da enumeração define um tamanho</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> a posição correspondente no array passa a ser tratada como um subarray</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"> Em `rpncalc`</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> `field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_type</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">` é uma célula</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> `field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_value</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">` é outra</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> mas `field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_word</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">` é um array unidimensional com </span><span class="token number" style=color:#36acaa>20</span><span class="token plain"> células</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"> É por isso que a linha</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    printf  </span><span class="token string" style=color:#e3116c>"Unknown  operator  ’%s’\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_word</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">where the format code </span><span class="token operator" style=color:#393A34>%</span><span class="token plain">s expects a string —a zero</span><span class="token operator" style=color:#393A34>-</span><span class="token plain">terminated array</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">`Rational numbers</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> see also the “Celsius to Fahrenheit” example on page page </span><span class="token number" style=color:#36acaa>16</span><span class="token plain">`</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">`“</span><span class="token keyword" style=color:#00009f>enum</span><span class="token plain">” statement</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>101</span><span class="token plain">`</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">`Another example of an index tag</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> page </span><span class="token number" style=color:#36acaa>68</span><span class="token plain">`</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// came to here</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">If you know C</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">C⁺⁺  or Java</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> you may want to look at the </span><span class="token keyword" style=color:#00009f>switch</span><span class="token plain"> statement</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">The </span><span class="token keyword" style=color:#00009f>switch</span><span class="token plain"> statement differs in a number of ways from the other languages</span><br></span><span class=token-line style=color:#393A34><span class="token plain">that provide it</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"> The cases are not fall</span><span class="token operator" style=color:#393A34>-</span><span class="token plain">through</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> example</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> which in</span><br></span><span class=token-line style=color:#393A34><span class="token plain">turn means that the </span><span class="token keyword" style=color:#00009f>break</span><span class="token plain"> statement </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> the </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> EndOfExpr breaks out of the</span><br></span><span class=token-line style=color:#393A34><span class="token plain">enclosing loop</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> instead of out of the </span><span class="token keyword" style=color:#00009f>switch</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">On the top of the </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> loop in function rpncalc</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> you will find the</span><br></span><span class=token-line style=color:#393A34><span class="token plain">instruction “field </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>gettoken</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">string</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> index</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">”</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"> As already exemplified in the</span><br></span><span class=token-line style=color:#393A34><span class="token plain">wcount</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>p</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">“word count”</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> program on page </span><span class="token number" style=color:#36acaa>19</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> functions may </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> arrays</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">It gets more interesting </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> a similar line in function gettoken</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_word</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> word</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">where word is an array of </span><span class="token number" style=color:#36acaa>20</span><span class="token plain"> cells and field is an array of </span><span class="token number" style=color:#36acaa>22</span><span class="token plain"> cells</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">However</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> as the t_word enumeration field is declared as having a size of </span><span class="token number" style=color:#36acaa>20</span><span class="token plain"> cells</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">“field</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">t_word</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">” is considered a sub</span><span class="token operator" style=color:#393A34>-</span><span class="token plain">array of </span><span class="token number" style=color:#36acaa>20</span><span class="token plain"> cells</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> precisely matching the</span><br></span><span class=token-line style=color:#393A34><span class="token plain">array size of word</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">Listing</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> strtok</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">inc</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">```c</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/* extract words from a string (words must be separated by white space) */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property string" style=color:#e3116c>&lt;string></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>strtok</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new length </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>strlen</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">string</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/* skip leading white space */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>while</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">index </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> length </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain"> string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain"> ’ ’</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        index</span><span class="token operator" style=color:#393A34>++</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/* store the word letter for letter */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new offset </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> index     </span><span class="token comment" style=color:#999988;font-style:italic>/* save start position of token */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new result</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>20</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain">         </span><span class="token comment" style=color:#999988;font-style:italic>/* string to store the word in */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>while</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">index </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> length</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain"> string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> ’ ’</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain"> index </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> offset </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token plain"> result </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            result</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> offset</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            index</span><span class="token operator" style=color:#393A34>++</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    result</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> offset</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> EOS </span><span class="token comment" style=color:#999988;font-style:italic>/* zero-terminate the string */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> result</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<p><code>“switch” statement: page 115</code></p>
<hr>
<p>Function strtok is the same as the one used in the wcount.p example. It is
implemented in a separate file for the rpn calculator program. Note that the
strtok function as it is implemented here can only handle words with up to 19</p>
<p>characters —the 20th character is the zero terminator. A truly general purpose
re-usable implementation of an strtok function would pass the destination
array as a parameter, so that it could handle words of any size. Supporting
both packed and unpack strings would also be a useful feature of a<br>
<!-- -->general purpose function.</p>
<p>When discussing the merits of Reverse Polish Notation, I mentioned that a
stack is both an aid in “visualizing” the algorithm as well as a<br>
<!-- -->convenient method to implement an rpn parser. This example rpn calculator, uses
a stack with the ubiquitous functions push and pop. For error checking<br>
<!-- -->and resetting the stack, there is a third function that clears the stack.</p>
<p>Listing: stack.inc</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/* stack functions, part of the RPN calculator */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property string" style=color:#e3116c>&lt;rational></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>static</span><span class="token plain"> Rational</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> stack</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>50</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>static</span><span class="token plain"> stackidx </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>push</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Rational</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> value</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    assert stackidx </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token plain"> stack</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    stack</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">stackidx</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> value</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">Rational</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>pop</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    assert stackidx </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> stack</span><span class="token punctuation" style=color:#393A34>[</span><span class="token operator" style=color:#393A34>--</span><span class="token plain">stackidx</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>clearstack</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    assert stackidx </span><span class="token operator" style=color:#393A34>>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">stackidx </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> false</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    stackidx </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> true</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<p><code>wcount.p: page 19</code></p>
<hr>
<p>The file stack.inc includes the file rational again. This is technically not
necessary (rpnparse.inc already included the definitions for rational number
support), but it does not do any harm either and, for the sake of code re-use,
it is better to make any file include the definitions of the libraries that it
depends on.</p>
<p>Notice how the two global variables stack and stackidx are declared<br>
<!-- -->as “static” variables; using the keyword static instead of new. Doing this makes
the global variables “visible” in that file only. For all other files in a<br>
<!-- -->larger project, the symbols stack and stackidx are invisible and they cannot (ac-
cidentally) modify the variables. It also allows the other modules to declare
their own private variables with these names, so it avoids name clashing.</p>
<p>Embora a calculadora RPN continue sendo um programa pequeno, estruturamos o código como se fosse maior para demonstrar vários elementos da linguagem. Em um cenário real, poderíamos implementá-la de maneira mais compacta.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-event-driven-programming>• Event-driven programming<a href=#-event-driven-programming class=hash-link aria-label="Link direto para • Event-driven programming" title="Link direto para • Event-driven programming">​</a></h3>
<p>Todos os exemplos deste capítulo até aqui seguiram um modelo “linear”: começam em <code>main</code> e o código decide o que fazer e quando pedir entrada. Esse modelo é fácil de entender e se encaixa bem na maioria das linguagens, mas não atende a muitas situações do mundo real. Frequentemente, o programa não pode simplesmente processar dados e solicitar entrada apenas quando for conveniente; é o usuário quem escolhe quando interagir, e o aplicativo deve estar pronto para responder rapidamente, independentemente do que estiver fazendo.</p>
<p>Isso sugere que o programa deveria ser capaz de interromper o trabalho atual, realizar outra atividade e depois retomar a tarefa original. Nas primeiras implementações, isso era feito com sistemas multitarefa: uma thread cuidava das tarefas em segundo plano e outra ficava em loop aguardando entrada do usuário. Porém, essa solução é pesada. Um modelo mais leve para obter responsividade é o chamado “programação dirigida a eventos”.</p>
<hr>
<p>Nesse modelo, o programa divide tarefas longas em blocos curtos e, entre eles, fica disponível para processar eventos. Em vez de ficar “pollando” entradas, a aplicação hospedeira (ou outro subsistema) chama uma função associada ao evento —mas apenas quando ele ocorre.</p>
<p>O evento mais comum é “entrada”. Porém, entradas não vêm apenas de usuários: podem chegar pacotes por cabos seriais, redes, temporizadores internos e outros dispositivos conectados. Muitos desses dispositivos simplesmente enviam dados; o recebimento é um evento, como uma tecla pressionada. Se você não tratar o evento, talvez alguns fiquem em uma fila interna, mas, quando ela enche, os demais são descartados.</p>
<p>Pawn oferece suporte direto a esse modelo porque permite vários pontos de entrada. Em um programa linear, apenas <code>main</code> é o ponto inicial; em um programa dirigido a eventos, há uma função de entrada para cada evento capturado. Comparado ao modelo linear, esse estilo parece “de baixo para cima”: em vez de o programa chamar a aplicação hospedeira para decidir o próximo passo, é o host que invoca o script quando necessário, exigindo respostas rápidas.</p>
<p>Como pawn não especifica uma biblioteca padrão, não há garantia de que determinada implementação forneça funções como <code>printf</code> ou <code>getvalue</code>. Embora se recomende que todas ofereçam ao menos uma interface mínima de console/terminal com essas funções, a disponibilidade depende da implementação.</p>
<p>dependent. The same holds for the public functions —the entry points for a
script. It is implementation-dependent which public functions a host applica-
tion supports. The script in this section may therefore not run on your platform
(even if all previous scripts ran fine). The tools in the standard
distribution of
the pawn system support all scripts developed in this manual, provided that</p>
<p>your operating system or environment supports standard terminal functions</p>
<p>such as setting the cursor position.</p>
<p>An early programming language that was developed solely for teaching the
concepts of programming to children was “Logo”. This dialect of LISP made
programming visual by having a small robot, the “turtle”, drive over the floor
under control of a simple program. This concept was then copied to moving
a (usually triangular) cursor of the computer display, again under control of a
program. A novelty was that the turtle now left a trail behind it, allowing you
to create drawings by properly programming the turtle —it became known as turtle graphics.</p>
<hr>
<p><code>Public functions: 83</code></p>
<hr>
<p>The term “turtle graphics” was also used for drawing inter-
actively with the arrow keys on the keyboard and a “turtle” for the current
position. This method of drawing pictures on the computer was briefly popular
before the advent of the mouse.</p>
<p>Listing: turtle.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>keypressed</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>/</span><span class="token plain">_ get current position </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    wherexy x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>/</span><span class="token plain">_ determine how the update the current position </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>switch</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> ’u’</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> y</span><span class="token operator" style=color:#393A34>--</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>/</span><span class="token plain">_ up </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> ’d’</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> y</span><span class="token operator" style=color:#393A34>++</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>/</span><span class="token plain">_ down </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> ’l’</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> x</span><span class="token operator" style=color:#393A34>--</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>/</span><span class="token plain">_ left </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> ’r’</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> x</span><span class="token operator" style=color:#393A34>++</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>/</span><span class="token plain">_ right </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> ’\e’</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> exit </span><span class="token operator" style=color:#393A34>/</span><span class="token plain">_ Escape </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> exit </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>/</span><span class="token plain">_ adjust the cursor position and draw something </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    moveturtle x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>moveturtle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    gotoxy x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print ’</span><span class="token comment" style=color:#999988;font-style:italic>/*’</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>    gotoxy x, y</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>}</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span></code></pre></div></div>
<p>The entry point of the above program is @keypressed —it is called on a
key press. If you run the program and do not type any key, the<br>
<!-- -->function @keypressed never runs; if you type ten keys, @keypressed runs ten times.
Contrast this behaviour with main: function main runs immediately after you
start the script and it runs only once.</p>
<p>It is still allowed to add a main function to an event-driven program: the main
function will then serve for one-time initialization. A simple addition to this
example program is to add a main function, in order to clear the<br>
<!-- -->console/
terminal window on entry and perhaps set the initial position of the “turtle”
to the centre.</p>
<p>Support for function keys and other special keys (e.g. the arrow keys) is highly
system-dependent. On ANSI terminals, these keys produce different codes
than in a Windows “DOS box”.</p>
<hr>
<p>In the spirit of keeping the example program
portable, I have used common letters (“u” for up, “l” for left, etc.). This
does not mean, however, that special keys are beyond pawn’s capabilities.</p>
<p>In the “turtle” script, the “Escape” key terminates the host application through
the instruction exit. For a simple pawn run-time host, this will indeed work.
With host applications where the script is an add-on, or<br>
<!-- -->host-applications</p>
<p>that are embedded in a device, the script usually cannot terminate the host application.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-múltiplos-eventos>• Múltiplos eventos<a href=#-múltiplos-eventos class=hash-link aria-label="Link direto para • Múltiplos eventos" title="Link direto para • Múltiplos eventos">​</a></h3>
<p>As vantagens do modelo dirigido a eventos para construir programas reativos ficam claras quando há diversos eventos. Na prática, ele só faz sentido se houver mais de um ponto de entrada; se seu script lida com apenas um evento, um loop de polling seria suficiente. Quanto mais eventos precisamos tratar, mais difícil fica usar o modelo linear. O script a seguir implementa um chat bem simples com dois eventos: envio e recebimento. Ele permite que usuários em rede (ou outro meio) troquem mensagens de uma linha.</p>
<p>O script depende de a aplicação hospedeira fornecer funções nativas/públicas para enviar e receber datagramas e reagir a teclas digitadas. O método de envio (serial, TCP/IP etc.) fica a cargo do host. As ferramentas da distribuição padrão do pawn usam TCP/IP e permitem um modo de “broadcast” para que mais de duas pessoas conversem.</p>
<hr>
<p>Listing: chat.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property string" style=color:#e3116c>&lt;datagram></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>receivestring</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> message</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> source</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">printf </span><span class="token string" style=color:#e3116c>"[%s] says: %s\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> source</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> message</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>keypressed</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>static</span><span class="token plain"> string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>100</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>char</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>static</span><span class="token plain"> index</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> ’\e’</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        exit </span><span class="token comment" style=color:#999988;font-style:italic>/* quit on ’Esc’ key */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    echo key</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> ’\r’ </span><span class="token operator" style=color:#393A34>||</span><span class="token plain"> key </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> ’\n’ </span><span class="token operator" style=color:#393A34>||</span><span class="token plain"> index </span><span class="token keyword" style=color:#00009f>char</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token plain"> string</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        string</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ’\</span><span class="token number" style=color:#36acaa>0</span><span class="token plain">’ </span><span class="token comment" style=color:#999988;font-style:italic>/* terminate string */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        sendstring string</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        index </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ’\</span><span class="token number" style=color:#36acaa>0</span><span class="token plain">’</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        string</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain">index</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> key</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>echo</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new string</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>2</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>char</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    string</span><span class="token punctuation" style=color:#393A34>{</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> key </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> ’\r’ </span><span class="token operator" style=color:#393A34>?</span><span class="token plain"> ’\n’ </span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> key</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    printf string</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>Grande parte do script se ocupa de juntar os caracteres digitados em uma string e enviá-la quando o usuário pressiona Enter. A tecla Escape encerra o programa. A função <code>echo</code> gera um feedback visual do que é digitado: monta uma string com terminador zero a partir da tecla e a imprime.</p>
<p>Apesar da simplicidade, o script demonstra uma característica interessante: não há ordem rígida para enviar ou receber mensagens —não existe o esquema pergunta–resposta em que cada host “espera a vez”. Uma mensagem pode chegar enquanto o usuário ainda está digitando.∗</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-programação-com-estados>• Programação com estados<a href=#-programação-com-estados class=hash-link aria-label="Link direto para • Programação com estados" title="Link direto para • Programação com estados">​</a></h3>
<p>Em um programa dirigido a eventos, cada evento chega isoladamente e recebe uma resposta isolada. Às vezes, porém, um evento faz parte de um fluxo sequencial que deve ser tratado na ordem correta. Protocolos de transferência de dados em linhas seriais são um exemplo: cada evento pode carregar um comando, um pedaço de arquivo, um reconhecimento ou outro sinal do protocolo.</p>
<hr>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=-as-this-script-makes-no-attempt-to-separate-received-messages-from-typed-messages-for-example-in-two-different-scrollable-regions-the-terminalconsole-will-look-confusing-when-this-happens-with-an-improved-user-interface-this-simple-script-could-indeed-be-a-nice-message-base-chat-program>∗ As this script makes no attempt to separate received messages from typed messages (for example, in two different scrollable regions), the terminal/console will look confusing when this happens. With an improved user-interface, this simple script could indeed be a nice message-base chat program<a href=#-as-this-script-makes-no-attempt-to-separate-received-messages-from-typed-messages-for-example-in-two-different-scrollable-regions-the-terminalconsole-will-look-confusing-when-this-happens-with-an-improved-user-interface-this-simple-script-could-indeed-be-a-nice-message-base-chat-program class=hash-link aria-label="Link direto para ∗ As this script makes no attempt to separate received messages from typed messages (for example, in two different scrollable regions), the terminal/console will look confusing when this happens. With an improved user-interface, this simple script could indeed be a nice message-base chat program" title="Link direto para ∗ As this script makes no attempt to separate received messages from typed messages (for example, in two different scrollable regions), the terminal/console will look confusing when this happens. With an improved user-interface, this simple script could indeed be a nice message-base chat program">​</a></h6>
<hr>
<p>Para que esse fluxo faça sentido, o programa precisa seguir um protocolo rigoroso de “handshake”. Isso significa que ele deve reagir a cada evento considerando o histórico recente de eventos anteriores e as respostas enviadas. Ou seja, o tratamento de um evento pode definir a “condição” ou “contexto” em que os próximos serão processados.</p>
<p>Uma abstração simples e eficaz para construir sistemas reativos que seguem protocolos parcialmente sequenciais é o autômato ou máquina de estados. Como o número de estados costuma ser finito, falamos em Máquinas de Estados Finitos (MEF). No autômato, o contexto do evento é o estado atual. Um mesmo evento pode ser tratado de maneiras diferentes dependendo desse estado e, em resposta, o autômato pode mudar para outro estado —essa mudança é chamada transição.</p>
<p>Autômatos são comuns tanto em software quanto em dispositivos mecânicos (o tear de Jacquard é um exemplo clássico). Com um número finito de estados, são determinísticos (comportamento previsível) e fáceis de implementar a partir de um diagrama de estados.</p>
<p><img decoding=async loading=lazy src=https://i.ibb.co/k3kWVvy/image.png alt="State diagram" class=img_ev3q></p>
<p>In a state diagram, the states are usually represented as circles or<br>
<!-- -->rounded rectangles and the arrows represent the transitions. As transitions are
the response of the automaton to events, an arrow may also be seen as an event “that does something”.</p>
<hr>
<p>An event/transition that is not defined in a particular
state is assumed to have no effect —it is silently ignored. A filled dot
represents the entry state, which your program (or the host application) must set in start-
up. It is common to omit in a state diagram all event arrows that drop back
into the same state, but here I have chosen to make the response to all events explicit.</p>
<p>O diagrama acima corresponde à análise de comentários iniciados por <code>/*</code> e terminados em <code>*/</code>. Há estados para texto normal, para texto dentro do comentário e dois estados intermediários para entrada e saída. O autômato foi pensado para processar caracteres digitados pelo usuário, então reage apenas a eventos de tecla. Na prática há um único evento (“tecla pressionada”); as transições dependem do parâmetro (a própria tecla).</p>
<p>Pawn oferece suporte nativo a autômatos e estados. Cada função∗ pode ter um ou mais estados associados. A linguagem também permite múltiplos autômatos, e cada estado pertence a um autômato específico.</p>
<p>O script abaixo implementa o diagrama descrito (usando um autômato anônimo). Para destacar o texto normal dos comentários, cada tipo recebe uma cor diferente.</p>
<p>Listing: comment.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/* parse C comments interactively, using events and a state machine */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    state plain</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>keypressed</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">plain</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>state</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> ’</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">’</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> slash</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain"> ’</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">’</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        echo key</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>keypressed</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">slash</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>state</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain"> ’</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">’</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> plain</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>state</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> ’</span><span class="token comment" style=color:#999988;font-style:italic>/*’) comment</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>    echo ’/’    /* print ’/’ held back from previous state */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain"> ’</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">’</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        echo key</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>keypressed</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">comment</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    echo key</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>state</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> ’</span><span class="token comment" style=color:#999988;font-style:italic>/*’) star</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>}</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>@keypressed(key) &lt;star></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>{</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>    echo key</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>    state (key != ’/*’) comment</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>    state (key == ’/’) plain</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>}</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>echo(key) &lt;plain, slash></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>    printchar key, yellow</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>echo(key) &lt;comment, star></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>    printchar key, green</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>printchar(ch, colour)</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>{</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>    setattr .foreground = colour</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>    printf "%c", ch</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>}</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span></code></pre></div></div>
<hr>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=-with-the-exception-of-native-functions-and-user-defined-operators>∗ With the exception of “native functions” and user-defined operators.<a href=#-with-the-exception-of-native-functions-and-user-defined-operators class=hash-link aria-label="Link direto para ∗ With the exception of “native functions” and user-defined operators." title="Link direto para ∗ With the exception of “native functions” and user-defined operators.">​</a></h6>
<hr>
<p><code>main</code> define o estado inicial como <code>plain</code> e termina; toda a lógica é dirigida a eventos. Quando uma tecla chega no estado <code>plain</code>, verificamos se é uma barra e, dependendo disso, imprimimos ou não o caractere. A interação entre os estados <code>plain</code> e <code>slash</code> mostra uma característica típica dos autômatos: é preciso decidir como reagir no momento em que o evento acontece, sem “olhar à frente” nem desfazer respostas anteriores. Em sistemas dirigidos a eventos, geralmente não sabemos qual será o próximo evento nem quando virá, e o que fizermos agora dificilmente poderá ser anulado depois.</p>
<p>Neste caso, quando uma barra chega, ela <strong>pode</strong> indicar o início de um comentário (<code>/*</code>), mas não necessariamente. Não dá para decidir de imediato em que cor imprimir o caractere, então o mantemos “em espera”. Note que não declaramos nenhuma variável global para isso; na verdade, além dos parâmetros, não há variáveis declaradas. A informação de que há um caractere pendente está implícita no estado do autômato.</p>
<p>Como mostra o script, mudanças de estado podem ser condicionais. A condição é opcional, e também podemos usar <code>if/else</code> tradicionais para alterá-los.</p>
<p>A dependência de estado não se restringe às funções de evento. Outras funções podem declarar estados, como <code>echo</code> faz. Quando várias situações compartilham a mesma implementação, basta escrever uma função e listar todos os estados aplicáveis. Em <code>echo</code> existem duas versões para cobrir os quatro estados.†</p>
<p>Um autômato deve estar preparado para tratar todos os eventos em qualquer estado. Normalmente ele não controla quais eventos chegam nem quando, portanto ignorá-los em certo estado pode levar a falhas. Muitas vezes alguns eventos fazem sentido somente em poucos estados e, nos demais, deveriam disparar erros ou uma rotina de “reset”. Para evitar listar manualmente todos os estados inválidos, podemos omitir o conteúdo entre os colchetes angulares: assim, a função atende a todos os estados que não têm implementação específica. Por exemplo, poderíamos declarar <code>echo(key) &lt;></code> em vez de listar explicitamente cada estado (mas apenas em uma das implementações).</p>
<p>Existe um autômato anônimo predefinido. Se o programa contiver mais de um, precisamos mencionar seu nome tanto no qualificador quanto no comando <code>state</code>. Basta colocar o nome do autômato antes do estado, separados por <code>:</code> —por exemplo, <code>parser:slash</code> refere-se ao estado <code>slash</code> do autômato <code>parser</code>. Uma função só pode pertencer a um autômato; podemos reutilizar a mesma implementação em vários estados desse autômato, mas não em estados de autômatos diferentes.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-funções-entry-e-teoria-de-autômatos>• Funções <code>entry</code> e teoria de autômatos<a href=#-funções-entry-e-teoria-de-autômatos class=hash-link aria-label="Link direto para -funções-entry-e-teoria-de-autômatos" title="Link direto para -funções-entry-e-teoria-de-autômatos">​</a></h3>
<p>As máquinas de estados e a própria teoria dos autômatos têm origem no design mecânico e em circuitos elétricos/pneumáticos de comutação (com relés, não transistores). Exemplos típicos são aceitadores de moedas, semáforos e centrais de comunicação. Nesses sistemas, robustez e previsibilidade são fundamentais, e descobriu-se que esses objetivos são alcançados com mais facilidade quando as ações (saídas) estão ligadas aos estados em vez dos eventos (entradas).</p>
<hr>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=-a-function-that-has-the-same-implementation-for-all-states-does-not-need-a-state-classifierat-all-see-printchar>* A function that has the same implementation for all states, does not need a state classifierat all —see printchar.<a href=#-a-function-that-has-the-same-implementation-for-all-states-does-not-need-a-state-classifierat-all-see-printchar class=hash-link aria-label="Link direto para * A function that has the same implementation for all states, does not need a state classifierat all —see printchar." title="Link direto para * A function that has the same implementation for all states, does not need a state classifierat all —see printchar.">​</a></h6>
<hr>
<p><img decoding=async loading=lazy src=https://i.ibb.co/PYnBGS9/image.png alt=pcl class=img_ev3q></p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=figure-1-pedestrian-crossing-lights>Figure 1: Pedestrian crossing lights<a href=#figure-1-pedestrian-crossing-lights class=hash-link aria-label="Link direto para Figure 1: Pedestrian crossing lights" title="Link direto para Figure 1: Pedestrian crossing lights">​</a></h6>
<hr>
<p>Ao entrar em um estado, opcionalmente realizamos alguma ação; os eventos apenas provocam a mudança de estado, mas não executam operações por conta própria.</p>
<p>Em um semáforo para pedestres, as luzes dos veículos e dos pedestres precisam ficar sincronizadas. Certamente, exibir verde para os carros e “andar” para os pedestres seria desastroso —o mesmo vale para amarelo/andar. Restam quatro combinações possíveis. O diagrama a seguir descreve o processo: tudo começa com um botão e é controlado por temporizadores.</p>
<p><img decoding=async loading=lazy src=https://i.ibb.co/9wNR3ry/image.png alt=pcl class=img_ev3q></p>
<p>When the state red/walk times out, the state cannot immediately go back to
green/wait, because the pedestrians that are busy crossing the road at<br>
<!-- -->that moment need some time to clear the road —the state red/wait
allows for this.</p>
<hr>
<p>Para fins de demonstração, este semáforo tem um extra: se o pedestre aperta o botão enquanto a luz já está vermelha para os carros, o tempo de travessia é prolongado. Ou seja, se estamos em <code>red/wait</code> e alguém pressiona o botão, voltamos para <code>red/walk</code>. A caixa que envolve esses estados no diagrama é apenas uma convenção visual; poderíamos ter desenhado duas setas voltando a <code>red/walk</code>. O código abaixo segue a mesma convenção.</p>
<p>Na implementação em pawn, as funções de evento sempre têm uma única instrução: ou mudam de estado ou não fazem nada. Os eventos que não provocam mudanças não aparecem no diagrama, mas precisam ser tratados no script —daí as funções “fallback” vazias.</p>
<p>A saída (neste caso, apenas mensagens no console) é feita nas funções especiais <code>entry</code>. Podemos vê-las como “main” de cada estado: são chamadas automaticamente quando o estado correspondente é ativado. Note que elas também são executadas em reentradas, ou seja, quando mudamos para o mesmo estado em que já estávamos.</p>
<p>Listing: traffic.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/* traffic light synchronizer, using states in an event-driven model */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property string" style=color:#e3116c>&lt;time></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain">                     state green_wait</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>keypressed</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">green_wait</span><span class="token operator" style=color:#393A34>></span><span class="token plain">         state yellow_wait</span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>keypressed</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">red_walk</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> red_wait</span><span class="token operator" style=color:#393A34>></span><span class="token plain">     state red_walk</span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>keypressed</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token operator" style=color:#393A34>></span><span class="token plain">             </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>/* fallback */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>timer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">yellow_wait</span><span class="token operator" style=color:#393A34>></span><span class="token plain">            state red_walk</span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>timer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">red_walk</span><span class="token operator" style=color:#393A34>></span><span class="token plain">             state red_wait</span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>timer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">red_wait</span><span class="token operator" style=color:#393A34>></span><span class="token plain">             state green_wait</span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>timer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token operator" style=color:#393A34>></span><span class="token plain">                 </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>/* fallback */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>entry</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">green_wait</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"Green / Don’t walk\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>entry</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">yellow_wait</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"Yellow / Don’t walk\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    settimer </span><span class="token number" style=color:#36acaa>2000</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>entry</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">red_walk</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"Red / Walk\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    settimer </span><span class="token number" style=color:#36acaa>5000</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>entry</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">red_wait</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"Red / Don’t walk\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    settimer </span><span class="token number" style=color:#36acaa>2000</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<p>Este exemplo depende de mais um recurso da aplicação hospedeira: além de <code>@keypressed</code>, precisamos de um evento <code>@timer</code> configurável. Por isso o script inclui o arquivo <code>time.inc</code>.</p>
<p>As funções de evento com mudanças de estado estão no topo do arquivo, uma por linha, lembrando uma tabela. Neste caso são todas incondicionais, mas poderíamos adicionar condições. As funções <code>entry</code> vêm depois.</p>
<p>Existem duas transições para <code>red_walk</code> (ou três, se considerarmos que uma função atende mais de um estado): provenientes de <code>yellow_wait</code> e da combinação <code>red_walk/red_wait</code>. Todas passam pela mesma função <code>entry</code>, reduzindo código.</p>
<p>Na teoria, um autômato que associa saídas às entradas nos estados (como este semáforo) é um autômato de Moore; quando a saída está ligada aos eventos/transições dependentes de estado, falamos em autômato de Mealy. O analisador de comentários mostrado antes é típico Mealy. Os dois modelos são equivalentes: podemos converter um Mealy em Moore e vice-versa, embora o Moore, às vezes, precise de mais estados para o mesmo comportamento. Na prática, costuma-se misturar: um design geral no estilo Moore com alguns estados Mealy quando isso economiza estados.</p>
<p>• State variables</p>
<p>The previous example was crafted to demonstrate a few properties of<br>
<!-- -->state programming with pawn, but its model of a pedestrian crossing light is not</p>
<p>very realistic. The first thing that is lacking is a degree of fairness : pedestrians
should not be able to block car traffic indefinitly. The car traffic should
see a green light for a period of some minimum duration after pedestrians have had
their time slot for crossing the road. Secondly, many traffic lights have a kind
of remote control ability, so that emergency traffic (ambulance, firetruck, . . . )
can force green lights on their path. A well-known example of such remote</p>
<p>control is the mirt system (Mobile Infra-Red Transmitter) but not de facto
standard exists —the Netherlands use a radiographic system called vetag for
instance.</p>
<hr>
<p>The new state diagram for the pedestrian crossing light has two more states,
but more importantly: it needs to save data across events and share it between
states. When the pedestrian presses the button while the state is red_wait, we
neither want to react on the button immediately (this was our “fairness rule”),
nor the button to be ignored or “forgotten”. In other words, we move to the
state green_wait_interim regardless of the button press, but memorize the
press for a decision made at the point of leaving state green_wait_interim.</p>
<p>Automatons excel in modelling control flow in reactive/interactive
systems, but data flow has traditionally been a weak point. To see why, consider that
each event is handled individually by a function and that the local variables in
that function disappear when the function returns. Local variables can, hence,
not be used to pass data from one event to the next. Global variables, while
providing a work-around, have drawbacks: global scope and and<br>
<!-- -->“eternal” lifespan. If a variable is used only in the event handlers of a single state,
it is desirable to hide it from the other states, in order to protect it from
accidental modification. Likewise, shortening the lifespan to the state(s) that the
variable is active in, reduces the memory footprint. “State variables” provide
this mix of variable scope and variable lifespan that are tied to a series of states,
rather than to functions or modules.</p>
<p>pawn enriches the standard finite state machine (or automaton) with variables
that are declared with a state classifier. These variables are only
accessible from the listed states and the memory these variable hold may be<br>
<!-- -->reused by other purposes while the automaton is in a different state (different than
the ones listed). Apart from the state classifier, the declaration of a state</p>
<p>variable is similar to that of a global variable. The declaration of the
variable button_memo in the next listing illustrates the concept.</p>
<hr>
<p>Listing: traffic2.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/* a more realistic traffic light synchronizer, including an</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic> * "override" for emergency vehicles</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic> */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property string" style=color:#e3116c>&lt;time></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    state green_wait_interim</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">new bool</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> button_memo </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">red_wait</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> green_wait_interim</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> yellow_wait</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>keypressed</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>switch</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> ’ ’</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> button_press</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> ’</span><span class="token comment" style=color:#999988;font-style:italic>/*’: mirt_detect</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>    }</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>}</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>button_press() &lt;green_wait></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>    state yellow_wait</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>button_press() &lt;red_wait, green_wait_interim></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>    button_memo = true</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>button_press() &lt;>         /* fallback */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>mirt_detect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    state mirt_override</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>timer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">yellow_wait</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    state red_walk</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>timer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">red_walk</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    state red_wait</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>timer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">red_wait</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    state green_wait_interim</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>timer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">green_wait_interim</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>state</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>!</span><span class="token plain">button_memo</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> green_wait</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>state</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">button_memo</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> yellow_wait</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>timer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">mirt_override</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    state green_wait</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>timer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token operator" style=color:#393A34>></span><span class="token plain">             </span><span class="token comment" style=color:#999988;font-style:italic>/* fallback */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>entry</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">green_wait_interim</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"Green / Don’t walk\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    settimer </span><span class="token number" style=color:#36acaa>5000</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>entry</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">yellow_wait</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"Yellow / Don’t walk\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    button_memo </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> false</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    settimer </span><span class="token number" style=color:#36acaa>2000</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>entry</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">red_walk</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"Red / Walk\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    settimer </span><span class="token number" style=color:#36acaa>5000</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>entry</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">red_wait</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"Red / Don’t walk\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    settimer </span><span class="token number" style=color:#36acaa>2000</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>entry</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">mirt_override</span><span class="token operator" style=color:#393A34>></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"Green / Don’t walk\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    settimer </span><span class="token number" style=color:#36acaa>5000</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<p>If a pedestrian pushes the button during mirt activity, that button press
is
forgotten. Unless emergencies are a frequent occurence, this is<br>
<!-- -->probably a
minor nuisance; and it is easy to fix, too.</p>
<p>• State programming wrap-up</p>
<p>States are ubiquitous, even if we do not always recognize them as such. The
concept of finite state machines has traditionally been applied mostly to pro-</p>
<p>grams mimicking mechanical apparatus and software that implements commu-
nication protocols. With the appearance of event-driven windowing systems,
state machines now also appear in the GUI design of desktop programs. States
Esses casos abundam em aplicações web, porque o navegador e o host de scripts têm pouca integração; ainda assim, a máquina de estados nesses contextos costuma ser implementada “no improviso”.</p>
<p>Também é possível enxergar estados em problemas e charadas conhecidas. No enigma do homem que precisa atravessar um rio levando um repolho, uma ovelha e um lobo∗, os estados são óbvios —o desafio é evitar os proibidos. Mas, agora que estamos identificando estados em todo lugar, o cuidado é não exagerar.</p>
<hr>
<p>No segundo exemplo do semáforo para pedestres (página 47), usei uma variável (<code>button_memo</code>) para guardar um critério que seria usado mais tarde. Seria possível eliminar essa variável criando dois estados extras, como “red-wait & botão pressionado” e “green-wait-interim & botão pressionado”. Porém, isso deixaria o diagrama e a implementação mais complexos. Em geral, o número de estados deve ser mantido pequeno.</p>
<p>Embora autômatos sejam uma boa abstração para sistemas reativos, construir o diagrama correto não é trivial. Com frequência desenhamos primeiro o “cenário perfeito” e vamos adicionando exceções conforme aparecem, o que aumenta o risco de esquecer combinações de estado + evento. Já vi dois diagramas de analisador de comentários (como o da página 40) em livros diferentes que falhavam exatamente por isso. Minha sugestão é focar nos eventos e nas respostas individuais: para cada estado, avalie todos os eventos. Não empurre casos demais para um “fallback” genérico.</p>
<p>Infelizmente, virou prática apresentar a teoria de autômatos com exemplos em que há soluções melhores. O clássico é o autômato que soma o valor de moedas ou calcula o resto da divisão por 3 de um número binário. Esses casos até faziam sentido em designs mecânicos/pneumáticos, onde o “estado” era a única memória. Em software, variáveis e operações aritméticas resolvem melhor. Outro exemplo é usar uma máquina de estados para casar palavras ou padrões, mudando de estado a cada letra. Scanners léxicos de compiladores até podem usar a técnica, mas para um conjunto razoável de palavras reservadas o autômato fica impraticável —ninguém o desenharia à mão. Além disso, nada impede que um analisador léxico olhe adiante no texto ou retorne a um marcador, um dos motivos de usar autômatos. Sem contar que estruturas como <code>tries</code> costumam ser mais simples e tão rápidas quanto.</p>
<p>Não entrei nos detalhes formais da notação dos diagramas, até porque ela segue o padrão usual: o retângulo arredondado traz o nome do estado e, se necessário, um resumo do que a <code>entry</code> faz; cada transição é uma seta com o nome do evento, uma condição opcional entre colchetes e uma ação opcional após uma barra.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-verificação-de-programas>• Verificação de programas<a href=#-verificação-de-programas class=hash-link aria-label="Link direto para • Verificação de programas" title="Link direto para • Verificação de programas">​</a></h3>
<p>“O compilador não deveria pegar todos os bugs?” Essa pergunta retórica tem lados técnicos e filosóficos. Deixando a filosofia de lado, existe um equilíbrio entre a expressividade de uma linguagem e o nível de correção “forçada” (ou provável) dos programas escritos nela. Restringir demais o idioma não é solução quando o trabalho extrapola o tamanho de um exercício simples: o programador passa a lutar contra a linguagem, quando o foco deveria ser o problema.</p>
<p>O objetivo do pawn é oferecer um mecanismo informal e prático para testar se o programa se comporta como o esperado. Esse mecanismo são as “assertions”. Embora anteriores ao “design by contract”, elas são mais fáceis de explicar com base nessa ideia.</p>
<p>No paradigma de design por contrato, cada função declara as condições que devem ser verdadeiras antes de ser executada (pré-condições), e aquelas que devem ser verdadeirase ao terminar (pós-condições). Isso forma o “contrato” da função. Parte-se do princípio de que o programador conhece o problema, o ambiente e os requisitos.</p>
<hr>
<p>Bertrand Meyer cunhou o termo “design by contract”, inspirado na lógica de predicados e na análise de algoritmos. Em resumo:</p>
<ul>
<li><strong>Pré-condições</strong> definem valores válidos para parâmetros de entrada e atributos do ambiente;</li>
<li><strong>Pós-condições</strong> descrevem a saída (e o ambiente) após a execução;</li>
<li><strong>Invariantes</strong> são condições que devem ser verdadeiras em pontos-chave da função, independentemente do caminho percorrido.</li>
</ul>
<p>Por exemplo, uma função que calcula raízes quadradas pode exigir que o parâmetro seja não negativo —pré-condição. Pode ainda afirmar que o resultado, ao ser elevado ao quadrado, difere da entrada em no máximo 0,01% —pós-condição. Se calculada via “bisseção”, cada iteração garante ao menos um bit adicional de precisão, o que seria um invariante (embora difícil de verificar).</p>
<p>Pré-condições, pós-condições e invariantes são testes cujo fracasso indica erro na implementação. Em pawn, todos podem ser expressos com <code>assert</code>. Coloque as pré-condições no início da função; invariantes nos pontos relevantes; pós-condições antes de cada <code>return</code> ou no final.</p>
<p>A instrução <code>assert</code> avalia uma expressão: se o resultado for verdadeiro, nada acontece; se for falso, o programa termina exibindo detalhes sobre a asserção que falhou.</p>
<p>Asserções são verificações que não deveriam falhar. Erros genuínos (como entrada inválida do usuário) merecem testes explícitos, não <code>assert</code>. Em geral, mantenha as expressões em <code>assert</code> sem efeitos colaterais —não escreva ali código essencial ao funcionamento.</p>
<hr>
<p><code>Example square root funczion (usin bisection): 79</code></p>
<hr>
<p>Claro que, em um programa sem bugs, as asserções nunca serão disparadas —o que aumenta o código sem um benefício direto. Para contornar, o compilador permite desativar as <code>assert</code>s via flag. A recomendação é deixá-las ativadas durante o desenvolvimento e gerar a versão final sem elas. Assim, basta recompilar para recuperá-las em futuros ajustes.</p>
<p>Durante manutenção (ou até no desenvolvimento inicial), se encontrar um defeito não detectado por uma <code>assert</code>, primeiro pense em qual asserção teria flagrado o erro. Adicione-a e verifique se realmente acusa o problema antes de corrigi-lo. Aos poucos, o código fica mais robusto.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-comentários-de-documentação>• Comentários de documentação<a href=#-comentários-de-documentação class=hash-link aria-label="Link direto para • Comentários de documentação" title="Link direto para • Comentários de documentação">​</a></h3>
<p>À medida que o programa cresce, documentar funções e módulos fica essencial, especialmente em equipes. As ferramentas do pawn ajudam a gerar documentação a partir dos comentários do código. Isso mantém o texto sincronizado com o programa, reaproveita os comentários como documentação e permite que o parser gere descrições e referências cruzadas.</p>
<p>Comentários que começam com três barras (<code>///</code>) seguidas de espaço, ou com <code>/**</code> seguidos de espaço, são tratados como documentação. O compilador pode extrair esses comentários e gravá-los em um arquivo de relatório (veja o apêndice B para habilitar).</p>
<p>Observação: comentários iniciados por <code>/*</code> continuam precisando de <code>*/</code>. Comentários de linha (<code>///</code>) terminam no fim da linha.</p>
<p>O relatório é um arquivo XML que pode ser transformado em HTML via XSL/XSLT ou processado por outras ferramentas. O formato é compatível com o dos produtos .NET, mas o compilador pawn armazena informações adicionais. O arquivo já referencia a folha de estilos <code>smalldoc.xsl</code>.</p>
<hr>
<p><code>Comment syntax: 97</code></p>
<hr>
<p>The example below illustrates documentation comments in a simple script that
has a few functions. You may write documentation comments for a function
above its declaration or in its body. All documentation comments that appear
before the end of the function are attributed to the function. You can<br>
<!-- -->also
add documentation comments to global variables and global constants —these
comments must appear above the declaration of the variable or constant. Fig-
ure 2 shows part of the output for this (rather long) example. The style
of the
output is adjustable in the cascading style sheet (CSS-file) associated with the
XSLT transformation file.</p>
<p>Listing: weekday.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/**</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- This program illustrates Zeller’s congruence algorithm to calculate</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- the day of the week given a date.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>*/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/**</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;summary></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-        The  main  program:  asks  the  user  to  input  a  date  and  prints</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>  on</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-        what  day  of  the  week  that  date  falls.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/summary></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>*/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new day</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> month</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> year</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>readdate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">day</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> month</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> year</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        new wkday </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>weekday</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">day</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> month</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> year</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        printf </span><span class="token string" style=color:#e3116c>"The date %d-%d-%d falls on a "</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> day</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> month</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> year</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>switch</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">wkday</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            print </span><span class="token string" style=color:#e3116c>"Saturday"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            print </span><span class="token string" style=color:#e3116c>"Sunday"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            print </span><span class="token string" style=color:#e3116c>"Monday"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            print </span><span class="token string" style=color:#e3116c>"Tuesday"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            print </span><span class="token string" style=color:#e3116c>"Wednesday"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>5</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            print </span><span class="token string" style=color:#e3116c>"Thursday"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>6</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            print </span><span class="token string" style=color:#e3116c>"Friday"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        print </span><span class="token string" style=color:#e3116c>"Invalid date"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/**</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;summary></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      The  core  function  of  Zeller’s  congruence  algorithm.  The  function</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      works  for  the  Gregorian  calender.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/summary></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;param  name="day"></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      The  day  in  the  month,  a  value  between  1  and  31.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/param></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;param  name="month"></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      The  month:  a  value  between  1  and  12.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/param></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;param  name="year"></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      The  year  in  four  digits.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/param></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;returns></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      The  day  of  the  week,  where  0  is  Saturday  and  6  is  Friday.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/returns></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;remarks></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      This  function  does  not  check  the  validity  of  the  date;  when</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>  the</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      date  in  the  parameters  is  invalid,  the  returned  "day  of  the</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>  week"</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      will  hold  an  incorrect  value.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      &lt;p/></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      This  equation  fails  in  many  programming  languages,  notably  most</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      implementations  of  C,  C++  and  Pascal,  because  these  languages</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>  have</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      a  loosely  defined  "remainder"  operator.  Pawn,  on  the  other</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>  hand,</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      provides  the  true  modulus  operator,  as  defined  in  mathematical</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      theory  and  as  was  intended  by  Zeller.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/remarks></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>*/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>weekday</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">day</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> month</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> year</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/**</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;remarks></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      For  Zeller’s  congruence  algorithm,  the  months  January  and</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      February  are  the  13th  and  14th  month  of  the  &lt;em>preceding&lt;/em></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      year.  The  idea  is  that  the  "difficult  month"  February  (which</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      has  either  28  or  29  days)  is  moved  to  the  end  of  the  year.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/remarks></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>*/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">month </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        month </span><span class="token operator" style=color:#393A34>+=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>12</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>--</span><span class="token plain">year</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new j </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> year </span><span class="token operator" style=color:#393A34>%</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>100</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new e </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> year </span><span class="token operator" style=color:#393A34>/</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>100</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">day </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">month</span><span class="token operator" style=color:#393A34>+</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>*</span><span class="token number" style=color:#36acaa>26</span><span class="token operator" style=color:#393A34>/</span><span class="token number" style=color:#36acaa>10</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> j </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> j</span><span class="token operator" style=color:#393A34>/</span><span class="token number" style=color:#36acaa>4</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> e</span><span class="token operator" style=color:#393A34>/</span><span class="token number" style=color:#36acaa>4</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">e</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>%</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>7</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/**</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;summary></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      Reads  a  date  and  stores  it  in  three  separate  fields.  tata</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/summary></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;param  name="day"></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      Will  hold  the  day  number  upon  return.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/param></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;param  name="month"></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      Will  hold  the  month  number  upon  return.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/param></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;param  name="year"></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      Will  hold  the  year  number  upon  return.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/param></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;returns></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      &lt;em>true&lt;/em>  if  the  date  is  valid,  &lt;em>false&lt;/em>  otherwise;</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      if  the  function  returns  &lt;em>false&lt;/em>,  the  values  of</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      &lt;paramref  name="day"/>,  &lt;paramref  name="month"/>  and</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      &lt;paramref  name="year"/>  cannot  be  relied  upon.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/returns></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>*/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">bool</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>readdate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">day</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">month</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">year</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"Give a date (dd-mm-yyyy): "</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    day </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">\_</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">’</span><span class="token operator" style=color:#393A34>-</span><span class="token plain">’</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">’</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">’</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    month </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">\_</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">’</span><span class="token operator" style=color:#393A34>-</span><span class="token plain">’</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">’</span><span class="token operator" style=color:#393A34>/</span><span class="token plain">’</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    year </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain"> month </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>12</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain"> day </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>daysinmonth</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">month</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">year</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/**</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;summary></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      Returns  whether  a  year  is  a  leap  year.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/summary></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;param  name="year"></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      The  year  in  4  digits.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/param></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;remarks></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      A  year  is  a  leap  year:</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      &lt;ul></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-          &lt;li>  if  it  is  divisable  by  4,  &lt;/li></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-          &lt;li>  but  &lt;strong>not&lt;/strong>  if  it  is  divisable  by  100,</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>&lt;/li></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-          &lt;li>  but  it  &lt;strong>is&lt;/strong>  it  is  divisable  by  400.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>&lt;/li></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      &lt;/ul></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/remarks></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>*/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">bool</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>isleapyear</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">year</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> year </span><span class="token operator" style=color:#393A34>%</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>400</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>||</span><span class="token plain"> year </span><span class="token operator" style=color:#393A34>%</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>100</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain"> year </span><span class="token operator" style=color:#393A34>%</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/**</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;summary></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      Returns  the  number  of  days  in  a  month  (the  month  is  an</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>  integer</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      in  the  range  1  ..  12).  One  needs  to  pass  in  the  year  as</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>  well,</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      because  the  function  takes  leap  years  into  account.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/summary></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;param  name="month"></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      The  month  number,  a  value  between  1  and  12.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/param></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;param  name="year"></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>-      The  year  in  4  digits.</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>- &lt;/param></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic></span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>*/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>daysinmonth</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">month</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> year</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>static</span><span class="token plain"> daylist</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>31</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>28</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>31</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>30</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>31</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>30</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>31</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>31</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>30</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>31</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>30</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>31</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    assert </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain"> month </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>12</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> daylist</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">month</span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> \_</span><span class="token operator" style=color:#393A34>:</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">month </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>isleapyear</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">year</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>The format of the XML file created by “.Net” developer products is<br>
<!-- -->documented in the Microsoft documentation. The pawn parser creates a mini-
mal description of each function or global variable or constant that is used<br>
<!-- -->in a project, regardless of whether you used documentation comments on that
function/variable/constant. The parser also generates few tags of its own:</p>
<table><thead><tr><th>name<th>info<tbody><tr><td>attribute<td>Attributes for a function, such as “native” or “stock”.<tr><td>automaton<td>The automaton that the function belongs to (if any).<tr><td>dependency<td>The names of the symbols (other functions, global variables and/global constants) that the function requires. If desired, a call tree can be constructed from the dependencies.<tr><td>param<td>Function parameters. When you add a parameter description in a documentation comment, this description is combined with the auto-generated content for the parameter.<tr><td>paraminfo<td>Tags and array or reference information on a parameter.<tr><td>referrer<td>All functions that refer to this symbol; i.e., all functions that use or call this variable/function. This information is sufficient to serve as a “cross-reference” —the “referrer” tree is the inverse of the “dependency” tree.</table>
<hr>
<p><img decoding=async loading=lazy src=https://i.ibb.co/VmQS0fL/image.png alt=fig2 class=img_ev3q></p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=figure-2-documentation-generated-from-the-source-code>Figure 2: Documentation generated from the source code<a href=#figure-2-documentation-generated-from-the-source-code class=hash-link aria-label="Link direto para Figure 2: Documentation generated from the source code" title="Link direto para Figure 2: Documentation generated from the source code">​</a></h6>
<table><thead><tr><th>name<th>info<tbody><tr><td>stacksize<td>The estimated number of cells that the function will allocate on the stack and heap. This stack usage estimate excludes the stack requirements of any functions that are “called” from the function to which the documentation applies. For example, function readdate is documented as taking 6 cells on the stack, but it also calls daysinmonth which takes 4 additional cells —and in turn calls isleapyear. To calculate the total stack requirements for function readdate, the call tree should be considered. In addition to the local variables and function parameters, the compiler also uses the stack for storing intermediate results in complex expressions. The stack space needed for these intermediate results are also excluded from this report. In general, the required overhead for the intermediate results is not cumulative (over all functions), which is why it would be inaccurate to add a “safety margin” to every function. For the program as a whole, a safety margin would be highly advised. See appendix B (page 168. for the -v option which can tell you the maximum estimate stack usage, based on the call tree.<tr><td>tagname<td>The tag of the constant, variable, function result or function parameter(s).<tr><td>transition<td>The transitions that the function provokes and their conditions —see the section of automatons on page 38.</table>
<hr>
<p>All text in the documentation comment(s) is also copied to each<br>
<!-- -->function,
variable or constant to which it is attached. The text in the documentation
comment is copied without further processing —with one exception, see below.
Como o restante do relatório está em XML (e a forma mais comum de gerar documentação online é via XSLT), você pode formatar o texto usando tags HTML nos comentários. Apenas lembre-se de fechar as tags explicitamente; embora HTML seja permissivo, os processadores XML/XSLT não são. O toolkit do pawn inclui um exemplo de XSLT (com sua folha de estilos) que suporta as tags abaixo:</p>
<table><thead><tr><th>name<th>info<tbody><tr><td><code>&lt;code> &lt;/code></code><td>Preformatted source code in a monospaced font; although the “&”, “&lt;” and “>” must be typed as “&”, “&lt;” and “&rt;” respectively.<tr><td><code>&lt;example> &lt;/example></code><td>Text set under the sub-header “Example”.<tr><td><code>&lt;param name="..."> &lt;/param></code><td>A parameter description, with the parameter name appearing inside the opening tag (the “name=” option) and the parameter description following it.<tr><td><code>&lt;paramref name="..." /></code><td>A reference to a parameter, with the parameter name appearing inside the opening tag (the “name=” option).<tr><td><code>&lt;remarks> &lt;/remarks></code><td>Text set under the sub-header "Remarks”.<tr><td><code>&lt;returns> &lt;/returns></code><td>Text set under the sub-header “Returns”.<tr><td><code>&lt;seealso> &lt;/seealso></code><td>Text set under the sub-header “See also”.<tr><td><code>&lt;summary> &lt;/summary></code><td>Text set immediately below the header of the symbol.<tr><td><code>&lt;section> &lt;/section></code><td>Sets the text in a header. This should only be used in documentation that is not attached to a function or a variable.<tr><td><code>&lt;subsection> &lt;/subsection></code><td>Sets the text in a sub-header. This should only be used in documentation that is not attached to a function or a variable.</table>
<hr>
<p>The following additional HTML tags are supported for general purpose formatting text inside any of the above sections:</p>
<table><thead><tr><th>name<th>info<tbody><tr><td><code>&lt;c> &lt;/c></code><td>Text set in a monospaced font.<tr><td><code>&lt;em> &lt;/em></code><td>Text set emphasized, usually in italics.<tr><td><code>&lt;p> &lt;/p></code><td>Text set in a new paragraph. Instead of wrapping <p> and </p> around every paragraph, inserting <p></p> as a separator between two paragraphs produces the same effect.<tr><td><code>&lt;para> &lt;/para></code><td>An alternative for <p> </p>.<tr><td><code>&lt;ul> &lt;/ul></code><td>An unordered (bulleted) list.<tr><td><code>&lt;ol> &lt;/ol></code><td>An ordered (numbered) list.<tr><td><code>&lt;li> &lt;/li></code><td>An item in an ordered or unordered list.</table>
<hr>
<p>Há uma exceção: se o comentário contiver <code>&lt;param ...></code> e <code>&lt;/param></code>, o parser combina a descrição que você escreveu com a informação que ele próprio gera para o parâmetro.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-avisos-e-erros>• Avisos e erros<a href=#-avisos-e-erros class=hash-link aria-label="Link direto para • Avisos e erros" title="Link direto para • Avisos e erros">​</a></h3>
<p>Não descrevi como compilar os exemplos porque o procedimento varia conforme o ambiente: alguns têm botão/menu “Compile script” ou “Make”, outros exigem rodar <code>sc script.p</code> no terminal. Se estiver usando o conjunto padrão de ferramentas, consulte o livreto “The pawn booklet — Implementor’s Guide”.</p>
<p>Independentemente da forma de compilar, os resultados costumam ser:</p>
<ul>
<li>a compilação funciona e gera um executável (que pode ou não ser executado automaticamente); ou</li>
<li>a compilação acusa avisos/erros.</li>
</ul>
<p>Naturalmente erros acontecem, e o parser tenta detectá-los. Às vezes é difícil entender por que ele reclamou de determinado trecho; alguns lembretes podem ajudar:</p>
<ul>
<li>Cada erro/aviso tem um número. Procure-o no apêndice A para ver a descrição detalhada.</li>
<li>Se houver vários erros, o primeiro realmente indica o problema original; os seguintes podem ser apenas reflexos. Após detectar um erro, o parser tenta continuar, mas pode “se perder” e marcar trechos válidos como inválidos. Quando em dúvida, corrija o primeiro e recompile.</li>
<li>O parser verifica apenas sintaxe (gramática), não semântica. Um mesmo trecho errado pode ser “corrigido” de várias maneiras, mesmo que o resultado não faça sentido. Por isso o compilador às vezes não consegue apontar exatamente onde está o erro e fornece um intervalo de linhas.</li>
<li>Um programa sem erros sintáticos ainda pode conter falhas lógicas —para essas, use <code>assert</code> (página 112).</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-concluindo>• Concluindo<a href=#-concluindo class=hash-link aria-label="Link direto para • Concluindo" title="Link direto para • Concluindo">​</a></h3>
<p>Se você já conhece C, viu muitos conceitos familiares e alguns novos. Se não conhece, o ritmo talvez tenha sido acelerado. Em ambos os casos, leia as próximas páginas com atenção; e, para quem já domina C ou linguagens similares, o capítulo “Armadilhas” (página 134) pode ser um bom próximo passo.</p>
<p>Este livreto tenta ser ao mesmo tempo uma introdução informal e uma especificação formal —talvez não cumpra perfeitamente nenhum dos dois papéis. Como é o livro de referência padrão do pawn∗, privilegia a precisão e a completude, mesmo que isso o torne mais denso.</p>
<p>Essa dualidade aparece na ordem dos assuntos: começamos com os blocos conceituais (variáveis e funções) e só depois tratamos de operadores, instruções e regras gerais de sintaxe —não porque sejam menos importantes, mas porque são mais fáceis de aprender ou consultar.</p>
<hr>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=-hoje-existem-outras-publicações-sobre-pawn>∗ Hoje existem outras publicações sobre Pawn.<a href=#-hoje-existem-outras-publicações-sobre-pawn class=hash-link aria-label="Link direto para ∗ Hoje existem outras publicações sobre Pawn." title="Link direto para ∗ Hoje existem outras publicações sobre Pawn.">​</a></h6>
<hr>
<p><a href=/pt-BR/docs/scripting/language/reference/00-Contents>Voltar ao sumário</a></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/openmultiplayer/web/edit/master/frontend/i18n/pt-BR/docusaurus-plugin-content-docs/current/scripting/language/reference/02-A-tutorial-introduction.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Editar essa página</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Páginas de documentação"><a class="pagination-nav__link pagination-nav__link--prev" href=/pt-BR/docs/scripting/language/reference/Foreword><div class=pagination-nav__sublabel>Anterior</div><div class=pagination-nav__label>Foreword</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/pt-BR/docs/scripting/language/reference/Data-and-declarations><div class=pagination-nav__sublabel>Próxima</div><div class=pagination-nav__label>Data-and-declarations</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#-arithmetic class="table-of-contents__link toc-highlight">• Arithmetic</a><li><a href=#-arrays-e-constantes class="table-of-contents__link toc-highlight">• Arrays e constantes</a><li><a href=#-funções class="table-of-contents__link toc-highlight">• Funções</a><li><a href=#-call-by-reference--call-by-value class="table-of-contents__link toc-highlight">• Call-by-reference & call-by-value</a><li><a href=#-números-racionais class="table-of-contents__link toc-highlight">• Números racionais</a><li><a href=#-strings class="table-of-contents__link toc-highlight">• Strings</a><li><a href=#-arrays-e-enumerações-dados-estruturados class="table-of-contents__link toc-highlight">• Arrays e enumerações (dados estruturados)</a><li><a href=#-bit-operations-to-manipulate-sets class="table-of-contents__link toc-highlight">• Bit operations to manipulate ‘‘sets’’</a><li><a href=#-a-simple-rpn-calculator class="table-of-contents__link toc-highlight">• A simple RPN calculator</a><li><a href=#-event-driven-programming class="table-of-contents__link toc-highlight">• Event-driven programming</a><li><a href=#-múltiplos-eventos class="table-of-contents__link toc-highlight">• Múltiplos eventos</a><li><a href=#-programação-com-estados class="table-of-contents__link toc-highlight">• Programação com estados</a><li><a href=#-funções-entry-e-teoria-de-autômatos class="table-of-contents__link toc-highlight">• Funções <code>entry</code> e teoria de autômatos</a><li><a href=#-verificação-de-programas class="table-of-contents__link toc-highlight">• Verificação de programas</a><li><a href=#-comentários-de-documentação class="table-of-contents__link toc-highlight">• Comentários de documentação</a><li><a href=#-avisos-e-erros class="table-of-contents__link toc-highlight">• Avisos e erros</a><li><a href=#-concluindo class="table-of-contents__link toc-highlight">• Concluindo</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Documentação</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/pt-BR/docs>Introdução</a><li class=footer__item><a class=footer__link-item href=/pt-BR/docs>Migração para open.mp</a><li class=footer__item><a class=footer__link-item href=/pt-BR/docs/server/config.json>config.json</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Comunidade</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://discord.gg/samp target=_blank rel="noopener noreferrer" class=footer__link-item>Discord<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://github.com/openmultiplayer/open.mp target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://opencollective.com/openmultiplayer target=_blank rel="noopener noreferrer" class=footer__link-item>Doar<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://youtube.com/openmultiplayer target=_blank rel="noopener noreferrer" class=footer__link-item>YouTube<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://x.com/openmultiplayer target=_blank rel="noopener noreferrer" class=footer__link-item>X<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Mais</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/pt-BR/servers>Servidores</a><li class=footer__item><a class=footer__link-item href=/pt-BR/blog>Blog</a><li class=footer__item><a class=footer__link-item href=/pt-BR/animations>Animações</a><li class=footer__item><a class=footer__link-item href=/pt-BR/uid>Gerador de UID</a><li class=footer__item><a href=https://sa-mp.mp/ target=_blank rel="noopener noreferrer" class=footer__link-item>SA-MP<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=margin-bottom--sm><img src=/pt-BR/images/assets/logo.svg alt="open.mp logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src=/pt-BR/images/assets/logo.svg alt="open.mp logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></div><div class=footer__copyright>Copyright © 2025 open.mp. Feito com Docusaurus.</div></div></div></footer></div>