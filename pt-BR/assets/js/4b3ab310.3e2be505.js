"use strict";(self.webpackChunkomp_web=self.webpackChunkomp_web||[]).push([["34958"],{26714:function(e,s,n){n.r(s),n.d(s,{frontMatter:()=>c,toc:()=>t,default:()=>p,metadata:()=>r,assets:()=>d,contentTitle:()=>i});var r=JSON.parse('{"id":"scripting/language/reference/The-preprocessor","title":"O pr\xe9-processador","description":"---","source":"@site/i18n/pt-BR/docusaurus-plugin-content-docs/current/scripting/language/reference/05-The-preprocessor.md","sourceDirName":"scripting/language/reference","slug":"/scripting/language/reference/The-preprocessor","permalink":"/pt-BR/docs/scripting/language/reference/The-preprocessor","draft":false,"unlisted":false,"editUrl":"https://github.com/openmultiplayer/web/edit/master/frontend/i18n/pt-BR/docusaurus-plugin-content-docs/current/scripting/language/reference/05-The-preprocessor.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Functions","permalink":"/pt-BR/docs/scripting/language/reference/Functions"},"next":{"title":"General-syntax","permalink":"/pt-BR/docs/scripting/language/reference/General-syntax"}}'),a=n(85893),o=n(50065);let c={},i="O pr\xe9-processador",d={},t=[];function l(e){let s={a:"a",code:"code",h1:"h1",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"o-pr\xe9-processador",children:"O pr\xe9-processador"})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.p,{children:"A primeira etapa da compila\xe7\xe3o de um arquivo Pawn para P-code \xe9 o \u201Cpr\xe9-processamento\u201D: um filtro gen\xe9rico que ajusta o texto antes de envi\xe1-lo ao parser. Nesse est\xe1gio, coment\xe1rios s\xe3o removidos, blocos condicionais s\xe3o avaliados, diretivas s\xe3o executadas e ocorrem substitui\xe7\xf5es de texto. As diretivas s\xe3o resumidas na p\xe1gina 117; aqui focamos nas substitui\xe7\xf5es."}),"\n",(0,a.jsx)(s.p,{children:"O pr\xe9-processador age sobre cada linha imediatamente ap\xf3s ser lida. N\xe3o h\xe1 checagem sint\xe1tica nessa fase. Embora ofere\xe7a recursos poderosos, o uso descuidado pode introduzir erros dif\xedceis de rastrear."}),"\n",(0,a.jsx)(s.p,{children:"Farei men\xe7\xf5es a C/C++ porque o pr\xe9-processador Pawn se inspira nele \u2014embora n\xe3o seja compat\xedvel."}),"\n",(0,a.jsxs)(s.p,{children:["A diretiva ",(0,a.jsx)(s.code,{children:"#define"})," cria macros. Alguns exemplos:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-c",children:'\n#define maxsprites          25\n#define CopyRightString     "(c) Copyright 2004 by me"\n\n'})}),"\n",(0,a.jsx)(s.p,{children:"No script, eles podem ser usados como constantes. Exemplo:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-c",children:'\n#define maxsprites          25\n#define CopyRightString     "(c) Copyright 2004 by me"\nmain()\n{\n    print( Copyright )\n    new sprites[maxsprites]\n}\n\n'})}),"\n",(0,a.jsx)(s.p,{children:"Para casos simples, \xe9 melhor usar as constru\xe7\xf5es equivalentes da linguagem:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-c",children:'\nconst maxsprites = 25\n\nstock const CopyRightString[] = "(c) Copyright 2004 by me"\n\n'})}),"\n",(0,a.jsxs)(s.p,{children:["Essas declara\xe7\xf5es oferecem melhor checagem e permitem tags. No caso de strings, declare o array como ",(0,a.jsx)(s.code,{children:"const"})," e ",(0,a.jsx)(s.code,{children:"stock"}),": ",(0,a.jsx)(s.code,{children:"const"})," impede altera\xe7\xf5es, e ",(0,a.jsx)(s.code,{children:"stock"})," retira o s\xedmbolo se nunca for usado."]}),"\n",(0,a.jsx)(s.p,{children:"Macros com substitui\xe7\xe3o podem ter at\xe9 10 par\xe2metros. Um uso comum \xe9 simular fun\xe7\xf5es pequenas:"}),"\n",(0,a.jsx)(s.p,{children:"Listing: the \u201Cmin\u201D macro"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-c",children:"\n#define min(%1,%2) ((%1) < (%2) ? (%1) : (%2))\n\n"})}),"\n",(0,a.jsx)(s.p,{children:"Se voc\xea veio de C/C++, reconhecer\xe1 o h\xe1bito de cercar argumentos e a express\xe3o inteira com par\xeanteses."}),"\n",(0,a.jsx)(s.p,{children:"Se a macro for usada assim:"}),"\n",(0,a.jsx)(s.p,{children:"Listing: bad usage of the \u201Cmin\u201D macro"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-c",children:"\nnew a = 1, b = 4\nnew min = min(++a,b)\n\n"})}),"\n",(0,a.jsx)(s.p,{children:"the preprocessor translates it to:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-c",children:"\nnew a = 1, b = 4\nnew min = ((++a) < (b) ? (++a) : (b))\n\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Isso pode incrementar ",(0,a.jsx)(s.code,{children:"a"})," duas vezes \u2014uma armadilha cl\xe1ssica. Por isso, \xe9 comum adotar uma conven\xe7\xe3o (como usar mai\xfasculas) para distinguir macros de fun\xe7\xf5es."]}),"\n",(0,a.jsx)(s.p,{children:"Para entender a import\xe2ncia dos par\xeanteses, veja:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-c",children:"\n#define ceil_div(%1,%2) (%1 + %2 - 1) / %2\n\n"})}),"\n",(0,a.jsx)(s.p,{children:"Essa macro divide arredondando \u201Cpara cima\u201D. Usando-a assim:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-c",children:"\nnew a = 5\nnew b = ceil_div(8, a - 2)\n\n"})}),"\n",(0,a.jsxs)(s.p,{children:["o pr\xe9-processador gera ",(0,a.jsx)(s.code,{children:"new b = (8 + a - 2 - 1) / a - 2"}),". Devido \xe0 preced\xeancia dos operadores, ",(0,a.jsx)(s.code,{children:"b"})," vira 0 (se ",(0,a.jsx)(s.code,{children:"a = 5"}),"). O esperado era ",(0,a.jsx)(s.code,{children:"ceil(8 / (a - 2))"}),". Envolver os par\xe2metros (e, de prefer\xeancia, toda a express\xe3o) em par\xeanteses resolve:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-c",children:"\n#define ceil_div(%1,%2) ( ((%1) + (%2) - 1) / (%2) )\n\n"})}),"\n",(0,a.jsx)(s.p,{children:"O matching de padr\xf5es \xe9 mais sutil do que detectar trechos parecidos com chamadas. O padr\xe3o \xe9 literal, mas aceita qualquer texto nos lugares marcados como par\xe2metros. Por exemplo:"}),"\n",(0,a.jsx)(s.p,{children:"Listing: macro that translates a syntax for array access to a function call"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-c",children:"\n#define Object[%1] CallObject(%1)\n\n"})}),"\n",(0,a.jsx)(s.p,{children:"Se a expans\xe3o de uma macro cont\xe9m trechos que coincidem com outras macros, essas substitui\xe7\xf5es ocorrem durante a invoca\xe7\xe3o, n\xe3o na defini\xe7\xe3o:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-c",children:"\n#define a(%1)       (1+b(%1))\n#define b(%1)       (2\\*(%1))\nnew c = a(8)\n\n"})}),"\n",(0,a.jsx)(s.p,{children:"will evaluate to \u201Cnew c = (1+(2*(8)))\u201D, even though the macro \u201Cb\u201D was not\ndefined at the time of the definition of \u201Ca\u201D."}),"\n",(0,a.jsx)(s.p,{children:"As regras para matching s\xe3o:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["N\xe3o h\xe1 espa\xe7os no padr\xe3o. Se precisar, use a sequ\xeancia ",(0,a.jsx)(s.code,{children:"\\32;"}),". J\xe1 o texto resultante pode ter espa\xe7os."]}),"\n",(0,a.jsxs)(s.li,{children:["Sequ\xeancias de escape s\xe3o aceitas (\xfateis, por exemplo, para casar com ",(0,a.jsx)(s.code,{children:"%"})," literal)."]}),"\n",(0,a.jsxs)(s.li,{children:["O padr\xe3o n\xe3o pode terminar com par\xe2metro (isto \xe9, \u201Cset:%1=%2\u201D \xe9 inv\xe1lido). Para casar com fim de instru\xe7\xe3o, adicione ",(0,a.jsx)(s.code,{children:";"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["O padr\xe3o deve come\xe7ar com letra, ",(0,a.jsx)(s.code,{children:"_"})," ou ",(0,a.jsx)(s.code,{children:"@"}),". O trecho inicial alfanum\xe9rico \xe9 o \u201Cnome\u201D ou prefixo da macro \u2014\xe9 o que voc\xea usa em ",(0,a.jsx)(s.code,{children:"defined"}),"/",(0,a.jsx)(s.code,{children:"#undef"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["Ao casar padr\xf5es, o pr\xe9-processador ignora espa\xe7os entre s\xedmbolos alfanum\xe9ricos \u2194 n\xe3o alfanum\xe9ricos, exceto entre s\xedmbolos id\xeanticos. Ex.: ",(0,a.jsx)(s.code,{children:"abc(+-)"})," casa com ",(0,a.jsx)(s.code,{children:"abc ( + - )"}),", enquanto ",(0,a.jsx)(s.code,{children:"abc(--)"})," n\xe3o casa com ",(0,a.jsx)(s.code,{children:"abc(- -)"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["Existem at\xe9 10 par\xe2metros (",(0,a.jsx)(s.code,{children:"%0"}),"\u2013",(0,a.jsx)(s.code,{children:"%9"}),"), em qualquer ordem."]}),"\n",(0,a.jsxs)(s.li,{children:["Assim como outras diretivas, o ",(0,a.jsx)(s.code,{children:"#define"})," deve caber em uma linha. Se necess\xe1rio, finalize a linha com ",(0,a.jsx)(s.code,{children:"\\"}),". O texto de entrada tamb\xe9m precisa caber em uma linha."]}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"Lembre-se de que macros (especialmente as parametrizadas) podem mudar completamente o significado de uma linha \u2014o que parece acesso a array pode virar chamada de fun\xe7\xe3o, por exemplo."}),"\n",(0,a.jsx)(s.p,{children:"Hosts que embutem o parser podem oferecer op\xe7\xf5es para visualizar o resultado dessas substitui\xe7\xf5es. No conjunto de ferramentas padr\xe3o, consulte o \u201CPawn booklet \u2014 Implementor\u2019s Guide\u201D para instru\xe7\xf5es de uso do compilador e runtime."}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.code,{children:"Operator precedence: 110"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.code,{children:"Directives: 117"})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.a,{href:"00-Contents",children:"Go Back to Contents"})})]})}function p(e={}){let{wrapper:s}={...(0,o.a)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},50065:function(e,s,n){n.d(s,{Z:()=>i,a:()=>c});var r=n(67294);let a={},o=r.createContext(a);function c(e){let s=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),r.createElement(o.Provider,{value:s},e.children)}}}]);