---
title: "Управление сервером"
sidebar_label: "Управление сервером"
description: Полезные команды для управления сервером.
---

## Изменения игрового режима

### Запуска стороннего/загруженного из интернета режима

- Откройте папку с файлами сервера
- Скопируйте загруженные файлы с расширением .amx в папку gamemodes
- Используйте RCON команду для переключения на новый режим (2.1)
- Как альтернативу, вы можете использовать этот мод, как дополнительный для переключения (2.3)

### Использование подгружаемых скриптов/фильтрскриптов (Filterscripts)

Шаги точно такие же, как и с модом, но если отличия:

- Поместите файл с расширением .amx в папку `filterscripts`
- Добавьте скрипт в server.cfg: `filterscripts <названиескрипта>`

## Установка пароля

- Если вы хотите установить на сервер пароль, чтобы войти могли только доверенные люди, добавьте следующую строку в [server.cfg](server.cfg):

```
password парольдлявхода
```

- Это сделает ваш сервер защищённым с помощью пароль, где 'парольдлявхода' будет паролем, необходимым, для входа на сервер, всё логично. Вы можете изменить пароль на любой, какой вздумается.
- Пароль так же можно изменить через RCON прямо во время работы сервера с помощью команды `/rcon password парольдлявхода` или `password парольдлявхода`, используя консоль сервера или удалённую консоль.
- Убрать вход по паролю можно, установив `0` в качестве пароля любым из вышеуказанных способов.

## Использование RCON

### Авторизация

Вы можете авторизоваться, как RCON администратор, при помощи команды `/rcon login password` в игре, или используя [удалённую консоль (rcon)](RemoteConsole).

Пароль будет точно таким же, как и тот, что указан в [server.cfg](server.cfg)

### Блокировка пользователей

##### samp.ban

samp.ban это файл, располагающейся в папку с сервером и содержащий в себе список блокировок, он содержит следующую информацию:

- IP
- Дата блокировки
- Время блокировки
- Имя игрока (Имя игрока или причина блокировки, см. [BanEx](../scripting/functions/BanEx))
- Тип блокировки

Чтобы заблокировать пользователя, добавьте строку по примеру:

```
IP_ПОЛЬЗОВАТЕЛЯ [28/05/09 | 13:37:00] НИК - ПРИЧИНА БЛОКИРОВКИ
```

Где `IP_ПОЛЬЗОВАТЕЛЯ` это IP адрес, который вы хотите заблокировать.

##### Функция Ban()

Функция [Ban](../scripting/functions/Ban) используется для аналогичного метода блокировки, но из самого скрипта. Функция [BanEx](../scripting/functions/BanEx) добавляет к параметрам причину блокировки:

```
13.37.13.37 [28/05/09 | 13:37:00] Читер - INGAME BAN
```

##### Блокировка через RCON

Чтобы заблокировать пользователя, используя полномочия RCON администратора, необходимо использовать команду `ban` (Как блокировать по IP, смотрите далее).

Пример использования:

```
# В игре:
/rcon ban ID_ИГРОКА

# Консоль:
ban ID_ИГРОКА
```

##### banip

Чтобы заблокировать определённый IP адрес, используя полномочия RCON администратора, необходимо использовать команду `banip`.

Пример использования:

```
# В игре:
/rcon banip IP

# Консоль:
banip IP
```

### Разблокировка

Есть 2 способа разблокировать заблокированного пользователя.

- Удалить соответствующую строку из samp.ban
- Использовать RCON команду `unbanip`

#### samp.ban

samp.ban это файл, располагающейся в папку с сервером и содержащий в себе список блокировок, он содержит следующую информацию:

- IP
- Дата блокировки
- Время блокировки
- Имя игрока (Имя игрока или причина блокировки, см. [BanEx](../scripting/functions/BanEx))
- Тип блокировки

Например:

```
127.8.57.32 [13/06/09 | 69:69:69] NONE - IP BAN
13.37.13.37 [28/05/09 | 13:37:00] Kalcor - INGAME BAN
```

Чтобы разблокировать данных пользователей, удалите нужные строки из файла и используйте RCON команду `reloadbans`, чтобы обновить список блокировок, не перезапуская сервер.

#### unbanip

RCON команда `unbanip` используется для разблокировки IP адреса (`/rcon unbanip IP_АДРЕС` в игре или `unbanip IP_АДРЕС` в консоли).

Пример:

```
13.37.13.37 [28/05/09 | 13:37:00] Kalcon - INGAME BAN
```

```
# В игре:
/rcon unbanip 13.37.13.37

# Консоль
unbanip 13.37.13.37
```

Не забудьте использовать RCON команду `reloadbans`, чтобы обновить список блокировок, не перезапуская сервер.

#### reloadbans

Как было указано ранее, файл `samp.ban` содержит в себе список блокировок. Содержимое этого файла считывается лишь при запуске сервера, однако, если вы хотите обновить список во время работы сервера, используйте RCON команду `reloadbans`

### RCON команды

Введите `cmdlist`, чтобы получить список со всеми доступными RCON командами:

| Команда                           | Описание                                                                                                                          |
| --------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| `/rcon cmdlist`                   | Выводит список команд.                                                                                                            |
| `/rcon varlist`                   | Выводит список текущих параметров в [server.cfg](server.cfg)                                                                      |
| `/rcon exit`                      | Прекращает работу сервера.                                                                                                        |
| `/rcon echo [text]`               | Выводит текст, указанный в `[text]` в консоль сервера.                                                                            |
| `/rcon hostname [name]`           | Изменяет название сервера в поиске (_пример: /rcon hostname my server_).                                                          |
| `/rcon gamemodetext [name]`       | Изменяет название режима сервера в поиске (_пример: /rcon gamemodetext my gamemode_).                                             |
| `/rcon mapname [name]`            | Изменяет название карты сервера в поиске (_пример: /rcon mapname San Andreas_).                                                   |
| `/rcon exec [filename]`           | Выполняет файл, содержащий настройки, как в server.cfg (_пример: /rcon exec blah.cfg_).                                           |
| `/rcon kick [ID]`                 | Кикает игрока с указанным ID (_пример: /rcon kick 2_).                                                                            |
| `/rcon ban [ID]`                  | Блокирует ID (_пример: /rcon ban 2_).                                                                                             |
| `/rcon changemode [mode]`         | Изменяет загруженный игровой мод (_пример: /rcon changemode new_v2_).                                                             |
| `/rcon gmx`                       | Загрузит следующий игровой мод, указанный в `gamemodes` в [server.cfg](server.cfg).                                               |
| `/rcon reloadbans`                | Обновляет список блокировок из файла samp.ban.                                                                                    |
| `/rcon reloadlog`                 | Перезагружает файл server_log.txt. Нет видимого эффекта.                                                                          |
| `/rcon say`                       | Отправить сообщение в чат на сервере из RCON (_пример: `/rcon say привет всем` выведет всем в чат `Admin: привет всем`).          |
| `/rcon players`                   | Выводит список игроков на сервере (с их именами, IP и пингом).                                                                    |
| `/rcon banip [IP]`                | Блокирует указанный IP (_пример: /rcon banip 127.0.0.1_).                                                                         |
| `/rcon unbanip [IP]`              | Разблокирует указанный IP (_пример: /rcon unbanip 127.0.0.1_).                                                                    |
| `/rcon gravity`                   | Меняет гравитацию на сервере (_пример: /rcon gravity 0.008_).                                                                     |
| `/rcon weather [ID]`              | Меняет погоду на сервере (_пример: /rcon weather 1_).                                                                             |
| `/rcon loadfs`                    | Загружает указанный filterscript (_пример: /rcon loadfs adminfs_).                                                                |
| `/rcon weburl [server url]`       | Изменяет веб-адрес сервера в лаунчере                                                                                             |
| `/rcon unloadfs`                  | Выгружает указанный filterscript (_пример: /rcon unloadfs adminfs_).                                                              |
| `/rcon reloadfs`                  | Перезагружает указанный filterscript (_пример: /rcon reloadfs adminfs_).                                                          |
| `/rcon rcon\_password [PASSWORD]` | Меняет пароль RCON администраторов                                                                                                |
| `/rcon password [password]`       | Устанавливает/снимает пароль сервера                                                                                              |
| `/rcon messageslimit [count]`     | Устанавливает лимит сообщений, отправляемых клиентом в секунду. (по умолчанию 500)                                                |
| `/rcon ackslimit [count]`         | Устанавливает лимит подтверждений (acks), отправляемых клиентом в секунду (по умолчанию 3000)                                     |
| `/rcon messageholelimit [count]`  | Устанавливает лимит 'messagehole', отправляемых клиентом в секунду (по умолчанию 3000)                                            |
| `/rcon playertimeout [limit m/s]` | Устанавливает количество миллисекунд, после которых игрок будет отключен, если не отправляет никаких пакетов. (по умолчанию 1000) |
| `/rcon language [language]`       | Изменяет текст языка сервера в лаунчере (_пример: /rcon language Русский_).                                                       |

Первые 4 вышеприведённых команды для 0.3z R2 были сделаны для противодействия атакам на серверы SA-MP, вызывающие фризы и сбои. Поэтому, используйте их на своём сервере. Значения по умолчанию должны быть корректными для большинства серверов, однако, если вы замечаете ложные кики из-за этого, просто повысьте значения, пока невинные игроки не были исключены/заблокированы. [Подробнее здесь](https://sampforum.blast.hk/showthread.php?tid=506214&pid=2990193#pid2990193).

### Коллбэки и функции

Следующие коллбэки и функции могут быть полезными, так как относятся к содержимому данной статьи.

#### Коллбэки

- [OnRconLoginAttempt](../scripting/callbacks/OnRconLoginAttempt): Вызывается, когда совершается попытка авторизации RCON администратора.

#### Функции

- [IsPlayerAdmin](../scripting/functions/IsPlayerAdmin): Проверяет, авторизован-ли пользователь, как RCON администратор.

- [SendRconCommand](../scripting/functions/SendRconCommand): Отправляет любую из вышеприведённых RCON команд прямо из скрипта.
