<!doctype html><html lang=zh-CN dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-scripting/language/reference/Functions" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.8.1"><title data-rh=true>Functions | open.mp</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://open.mp/zh-CN/images/assets/wordmark-coloured-bg.png><meta data-rh=true name=twitter:image content=https://open.mp/zh-CN/images/assets/wordmark-coloured-bg.png><meta data-rh=true property=og:url content=https://open.mp/zh-CN/docs/scripting/language/reference/Functions><meta data-rh=true property=og:locale content=zh_CN><meta data-rh=true property=og:locale:alternate content=en><meta data-rh=true property=og:locale:alternate content=es><meta data-rh=true property=og:locale:alternate content=ru><meta data-rh=true property=og:locale:alternate content=ar><meta data-rh=true property=og:locale:alternate content=bs><meta data-rh=true property=og:locale:alternate content=de><meta data-rh=true property=og:locale:alternate content=fil><meta data-rh=true property=og:locale:alternate content=fr><meta data-rh=true property=og:locale:alternate content=fa><meta data-rh=true property=og:locale:alternate content=hu><meta data-rh=true property=og:locale:alternate content=id><meta data-rh=true property=og:locale:alternate content=it><meta data-rh=true property=og:locale:alternate content=nl><meta data-rh=true property=og:locale:alternate content=pl><meta data-rh=true property=og:locale:alternate content=pt_BR><meta data-rh=true property=og:locale:alternate content=ro><meta data-rh=true property=og:locale:alternate content=sl><meta data-rh=true property=og:locale:alternate content=sr><meta data-rh=true property=og:locale:alternate content=ta><meta data-rh=true property=og:locale:alternate content=th><meta data-rh=true property=og:locale:alternate content=tr><meta data-rh=true property=og:locale:alternate content=vi><meta data-rh=true property=og:locale:alternate content=zh_TW><meta data-rh=true name=docusaurus_locale content=zh-CN><meta data-rh=true name=docsearch:language content=zh-CN><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="Functions | open.mp"><meta data-rh=true name=description content=---><meta data-rh=true property=og:description content=---><link data-rh=true rel=icon href=/zh-CN/favicon.ico><link data-rh=true rel=canonical href=https://open.mp/zh-CN/docs/scripting/language/reference/Functions><link data-rh=true rel=alternate href=https://open.mp/docs/scripting/language/reference/Functions hreflang=en><link data-rh=true rel=alternate href=https://open.mp/es/docs/scripting/language/reference/Functions hreflang=es><link data-rh=true rel=alternate href=https://open.mp/ru/docs/scripting/language/reference/Functions hreflang=ru><link data-rh=true rel=alternate href=https://open.mp/ar/docs/scripting/language/reference/Functions hreflang=ar><link data-rh=true rel=alternate href=https://open.mp/bs/docs/scripting/language/reference/Functions hreflang=bs><link data-rh=true rel=alternate href=https://open.mp/de/docs/scripting/language/reference/Functions hreflang=de><link data-rh=true rel=alternate href=https://open.mp/fil/docs/scripting/language/reference/Functions hreflang=fil><link data-rh=true rel=alternate href=https://open.mp/fr/docs/scripting/language/reference/Functions hreflang=fr><link data-rh=true rel=alternate href=https://open.mp/fa/docs/scripting/language/reference/Functions hreflang=fa><link data-rh=true rel=alternate href=https://open.mp/hu/docs/scripting/language/reference/Functions hreflang=hu><link data-rh=true rel=alternate href=https://open.mp/id/docs/scripting/language/reference/Functions hreflang=id><link data-rh=true rel=alternate href=https://open.mp/it/docs/scripting/language/reference/Functions hreflang=it><link data-rh=true rel=alternate href=https://open.mp/nl/docs/scripting/language/reference/Functions hreflang=nl><link data-rh=true rel=alternate href=https://open.mp/pl/docs/scripting/language/reference/Functions hreflang=pl><link data-rh=true rel=alternate href=https://open.mp/pt-BR/docs/scripting/language/reference/Functions hreflang=pt-BR><link data-rh=true rel=alternate href=https://open.mp/ro/docs/scripting/language/reference/Functions hreflang=ro><link data-rh=true rel=alternate href=https://open.mp/sl/docs/scripting/language/reference/Functions hreflang=sl><link data-rh=true rel=alternate href=https://open.mp/sr/docs/scripting/language/reference/Functions hreflang=sr><link data-rh=true rel=alternate href=https://open.mp/ta/docs/scripting/language/reference/Functions hreflang=ta><link data-rh=true rel=alternate href=https://open.mp/th/docs/scripting/language/reference/Functions hreflang=th><link data-rh=true rel=alternate href=https://open.mp/tr/docs/scripting/language/reference/Functions hreflang=tr><link data-rh=true rel=alternate href=https://open.mp/vi/docs/scripting/language/reference/Functions hreflang=vi><link data-rh=true rel=alternate href=https://open.mp/zh-CN/docs/scripting/language/reference/Functions hreflang=zh-CN><link data-rh=true rel=alternate href=https://open.mp/zh-TW/docs/scripting/language/reference/Functions hreflang=zh-TW><link data-rh=true rel=alternate href=https://open.mp/docs/scripting/language/reference/Functions hreflang=x-default><link data-rh=true rel=preconnect href=https://AOKXGK39Z7-dsn.algolia.net crossorigin=anonymous><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://open.mp/zh-CN/docs/scripting/language/reference/Functions","name":"Functions","position":1}]}</script><link rel=alternate type=application/rss+xml href=/zh-CN/blog/rss.xml title="open.mp RSS Feed"><link rel=alternate type=application/atom+xml href=/zh-CN/blog/atom.xml title="open.mp Atom Feed"><link rel=search type=application/opensearchdescription+xml title=open.mp href=/zh-CN/opensearch.xml><link rel=stylesheet href=/zh-CN/assets/css/styles.535380ff.css><script src=/zh-CN/assets/js/runtime~main.5b4618e0.js defer></script><script src=/zh-CN/assets/js/main.2d524f91.js defer></script><body class=navigation-with-keyboard><svg xmlns=http://www.w3.org/2000/svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light",e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/zh-CN/images/assets/logo-light-trans.svg><link rel=preload as=image href=/zh-CN/images/assets/logo.svg><div role=region aria-label=跳到主要内容><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>跳到主要内容</a></div><nav aria-label=主导航 class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label=切换导航栏 aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/zh-CN/><div class=navbar__logo><img src=/zh-CN/images/assets/logo-light-trans.svg alt="open.mp logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/zh-CN/images/assets/logo-light-trans.svg alt="open.mp logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Open Multiplayer</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/zh-CN/docs>文档</a><a class="navbar__item navbar__link" href=/zh-CN/blog>博客</a><a href=https://forum.open.mp/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">论坛</a><a class="navbar__item navbar__link" href=/zh-CN/servers>服务器</a><a class="navbar__item navbar__link" href=/zh-CN/partners>合作伙伴</a><a href=https://opencollective.com/openmultiplayer target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">捐赠<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>简体中文</a><ul class=dropdown__menu><li><a href=/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=en>English</a><li><a href=/es/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=es>Español</a><li><a href=/ru/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=ru>Русский</a><li><a href=/ar/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=ar>العربية</a><li><a href=/bs/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=bs>Bosanski</a><li><a href=/de/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=de>Deutsch</a><li><a href=/fil/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=fil>Filipino</a><li><a href=/fr/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=fr>Français</a><li><a href=/fa/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=fa>فارسی</a><li><a href=/hu/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=hu>Magyar</a><li><a href=/id/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=id>Indonesia</a><li><a href=/it/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=it>Italiano</a><li><a href=/nl/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=nl>Nederlands</a><li><a href=/pl/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=pl>Polski</a><li><a href=/pt-BR/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=pt-BR>Português (Brasil)</a><li><a href=/ro/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=ro>Română</a><li><a href=/sl/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=sl>Slovenščina</a><li><a href=/sr/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=sr>Српски</a><li><a href=/ta/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=ta>தமிழ்</a><li><a href=/th/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=th>ไทย</a><li><a href=/tr/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=tr>Türkçe</a><li><a href=/vi/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=vi>Tiếng Việt</a><li><a href=/zh-CN/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=zh-CN>简体中文</a><li><a href=/zh-TW/docs/scripting/language/reference/Functions target=_self rel="noopener noreferrer" class=dropdown__link lang=zh-TW>繁體中文</a></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>搜索</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label=返回顶部 class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label=文档侧边栏 class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/zh-CN/docs>简介</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/zh-CN/docs/scripting/callbacks/OnActorStreamIn>Scripting</a></div><ul class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/zh-CN/docs/scripting/callbacks/OnActorStreamIn>Callbacks</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/zh-CN/docs/scripting/functions/AddCharModel>Functions</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true tabindex=0 href=/zh-CN/docs/scripting/language/reference/Contents>Language</a></div><ul class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true tabindex=0 href=/zh-CN/docs/scripting/language/reference/Contents>Reference</a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/reference/Contents>Contents</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/reference/Foreword>Foreword</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/reference/A-tutorial-introduction>A-tutorial-introduction</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/reference/Data-and-declarations>Data-and-declarations</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/zh-CN/docs/scripting/language/reference/Functions>Functions</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/reference/The-preprocessor>The-preprocessor</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/reference/General-syntax>General-syntax</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/reference/Operators-and-expressions>Operators-and-expressions</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/reference/Statements>Statements</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/reference/Directives>Directives</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/reference/Proposed-function-library>Proposed-function-library</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/reference/Pitfalls-differences-from-C>Pitfalls-differences-from-C</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/reference/Assorted-tips>Assorted-tips</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/reference/Appendices>Appendices</a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/ControlStructures>控制结构</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/Directives>关键字：预处理器指令</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/Initialisers>关键字：初始化器</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/Operators>关键字：操作符</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/Statements>关键字：语句</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/Style>Pawn 代码风格指南</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/Tags>脚本编写: 标签</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/scripting/language/Variables>基础：变量</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/zh-CN/docs/scripting/resources/anglemodes>Resources</a></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/zh-CN/docs/server/CommonServerIssues>Server</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/zh-CN/docs/client/ClientCommands>Client</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/zh-CN/docs/tutorials/AdvancedStructures>Tutorials</a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/zh-CN/docs/awesome>Awesome</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/zh-CN/docs/changelog>更新日志</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/zh-CN/docs/meta/Contributing>meta</a></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=页面路径><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label=主页面 class=breadcrumbs__link href=/zh-CN/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Scripting</span><li class=breadcrumbs__item><span class=breadcrumbs__link>Language</span><li class=breadcrumbs__item><span class=breadcrumbs__link>Reference</span><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>Functions</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Functions</h1></header>
<hr>
<p>A function declaration specifies the name of the function and, between paren-
theses, its formal parameters. A function may also return a value. A function
declaration must appear on a global level (i.e. outside any other functions) and
is globally accessible.</p>
<p>If a semicolon follows the function declaration (rather than a statement), the
declaration denotes a forward declaration of the function.</p>
<p>The return statement sets the function result. For example, function sum (see below)
has as its result the value of both its arguments added together. The
return expression is optional for a function, but one cannot use the value of
a function that does not return a value.</p>
<p>Listing: sum function</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>sum</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> a </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> b</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>Arguments of a function are (implicitly declared) local variables for that function.
The function call determines the values of the arguments.</p>
<p>Another example of a complete definition of the function leapyear
(which returns true for a leap year and false for a non-leap year):</p>
<p>Listing: leapyear function</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>leapyear</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">y</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> y </span><span class="token operator" style=color:#393A34>%</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain"> y </span><span class="token operator" style=color:#393A34>%</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>100</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>||</span><span class="token plain"> y </span><span class="token operator" style=color:#393A34>%</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>400</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>The logical and arithmetic operators used in the leapyear example are covered
on pages 108 and 104 respectively.</p>
<p>Usually a function contains local variable declarations and consists of a com-
pound statement. In the following example, note the assert statement to
guard against negative values for the exponent.</p>
<p>Listing: power function (raise to a power)</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>power</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/* returns x raised to the power of y */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    assert y </span><span class="token operator" style=color:#393A34>>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new r </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new i </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> y</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        r </span><span class="token operator" style=color:#393A34>*=</span><span class="token plain"> x</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> r</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>A function may contain multiple return statements —one usually does this
to quickly exit a function on a parameter error or when it turns<br>
<!-- -->out that the function has nothing to do. If a function returns an array,<br>
<!-- -->all return statements must specify an array with the same size and the same dimensions.</p>
<hr>
<p><code>The preferred way to declare forward functions is at page 82</code></p>
<p><code>“assert” statement: 112</code></p>
<hr>
<p>• Function arguments (call-by-value versus call-by-reference)</p>
<p>The “faculty” function in the next program has one parameter which it uses
in a loop to calculate the faculty of that number. What deserves attention is
that the function modifies its argument.</p>
<p>Listing: faculty.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/* Calculation of the faculty of a value */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"Enter a value: "</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new v </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new f </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>faculty</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">v</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    printf </span><span class="token string" style=color:#e3116c>"The faculty of %d is %d\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> v</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> f</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>faculty</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">n</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    assert n </span><span class="token operator" style=color:#393A34>>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new result </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>while</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">n </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        result </span><span class="token operator" style=color:#393A34>*=</span><span class="token plain"> n</span><span class="token operator" style=color:#393A34>--</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> result</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>Whatever (positive) value that “n” had at the entry of the while
loop in function faculty, “n” will be zero at the end of the loop. In the case of the
faculty function, the parameter is passed “by value”, so the change of “n”
is local to the faculty function. In other words, function main passes “v” as
input to function faculty, but upon return of faculty, “v” still has the same
value as before the function call.</p>
<p>Arguments that occupy a single cell can be passed by value or by reference.
The default is “pass by value”. To create a function argument that is passed
by reference, prefix the argument name with the character &.</p>
<p>Example:</p>
<p>Listing: swap function</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>swap</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">b</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new temp </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> b</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    b </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> a</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    a </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> temp</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>To pass an array to a function, append a pair of brackets to the<br>
<!-- -->argument name. You may optionally indicate the size of the array; doing so improves
error checking of the parser.</p>
<p>Example:</p>
<p>Listing: addvector function</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>addvector</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> size</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new i </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> size</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        a</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+=</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>Arrays are always passed by reference. As a side note, array b in the above
example does not change in the body of the function. The function argument
has been declared as const to make this explicit. In addition to improving
error checking, it also allows the pawn parser to generate more efficient code.</p>
<p>To pass an array of literals to a function, use the same syntax as for<br>
<!-- -->array initiallers: a literal string or the series of array indices enclosed in braces
(see page 99; the ellipsis for progressive initiallers cannot be used). Literal
arrays can only have a single dimension.</p>
<p>The following snippet calls addvector to add five to every element of the array “vect”:</p>
<p>Listing: addvector usage</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">new vect</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>3</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>addvector</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">vect</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token number" style=color:#36acaa>5</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>5</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>5</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/* vect[] now holds the values 6, 7 and 8 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>The invocation of function printf with the string "Hello world\n" in the first
ubiquitous program is another example of passing a literal array to a function.</p>
<hr>
<p><code>Another example is function JulianToDate at page 13</code></p>
<p><code>Constant variables: 64</code></p>
<p><code>“Hello world” program: 5</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-calling-functions>• Calling functions<a href=#-calling-functions class=hash-link aria-label="• Calling functions的直接链接" title="• Calling functions的直接链接">​</a></h3>
<p>When inserting a function name with its parameters in a statement or<br>
<!-- -->expression, the function will get executed in that statement/expression.<br>
<!-- -->The statement that refers to the function is the “caller” and the function itself,
at that point, is the “callee”: the one being called.</p>
<p>The standard syntax for calling a function is to write the<br>
<!-- -->function’s name, followed by a list with all explicitly passed parameters between parentheses.
If no parameters are passed, or if the function does not have any, the pair of
parentheses behind the function name are still present. For example, to try
out the power function, the following program calls it thus:</p>
<p>Listing: example program for the power function</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"Please give the base value and the power to raise it to:"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new base </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new power </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new result </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>power</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">base</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> power</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    printf </span><span class="token string" style=color:#e3116c>"%d raised to the power %d is %d"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> base</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> power</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> result</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>A function may optionally return a value. The sum, leapyear and power
functions all return a value, but the swap function does not. Even if a
function returns a value, the caller may ignore it.</p>
<p>For the situation that the caller ignores the function’s return value, there is
an alternative syntax to call the function, which is also illustrated
by the preceding example program calls the power function. The parentheses around
all function arguments are optional if the caller does not use the return value.</p>
<p>In the last statement, the example program reads</p>
<p><code>printf "%d raised to the power %d is %d", base, power, result</code></p>
<p>rather than</p>
<p><code>printf("%d raised to the power %d is %d", base, power, result)</code></p>
<p>which does the same thing.</p>
<p>The syntax without parentheses around the parameter list is called the “pro-
cedure call” syntax. You can use it only if:</p>
<ul>
<li>
<p>the caller does not assign the function’s result to a variable and does not use it in an expression, or as the “test expression” of an if statement for example;</p>
</li>
<li>
<p>the first parameter does not start with an opening paranthesis;</p>
</li>
<li>
<p>the first parameter is on the same line as the function name, unless you use named parameters (see the next section).</p>
</li>
</ul>
<p>As you may observe, the procedure call syntax applies to cases where a function
call behaves rather as a statement, like in the calls to print and printf in the
preceding example. The syntax is aimed at making such statements appear less
cryptic and friendlier to read, but not that the use of the syntax is optional.</p>
<p>As a side note, all parentheses in the example program presented in this section
are required: the return values of the calls to getvalue are stored<br>
<!-- -->in two variables, and therefore an empty pair of parentheses must follow the function
name. Function getvalue has optional parameters, but none are passed in this example program.</p>
<hr>
<p><code>Function power: 70</code></p>
<p><code>Functions sum & leapyear: 70</code></p>
<p><code>Function swap: 71</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-named-parameters-versus-positional-parameters>• Named parameters versus positional parameters<a href=#-named-parameters-versus-positional-parameters class=hash-link aria-label="• Named parameters versus positional parameters的直接链接" title="• Named parameters versus positional parameters的直接链接">​</a></h3>
<p>In the previous examples, the order of parameters of a function call was im-
portant, because each parameter is copied to the function argument with the
same sequential position. For example, with the function weekday (which
uses Zeller’s congruence algorithm) defined as below, you would call<br>
<!-- -->weekday(12,31,1999) to get the week day of the last day of the preceding century.</p>
<p>Listing: weekday function</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>weekday</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">month</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> day</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> year</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/* returns the day of the week: 0=Saturday, 1=Sunday, etc. */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">month </span><span class="token operator" style=color:#393A34>&lt;=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        month </span><span class="token operator" style=color:#393A34>+=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>12</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>--</span><span class="token plain">year</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new j </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> year </span><span class="token operator" style=color:#393A34>%</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>100</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new e </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> year </span><span class="token operator" style=color:#393A34>/</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>100</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">day </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">month</span><span class="token operator" style=color:#393A34>+</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token operator" style=color:#393A34>*</span><span class="token number" style=color:#36acaa>26</span><span class="token operator" style=color:#393A34>/</span><span class="token number" style=color:#36acaa>10</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> j </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> j</span><span class="token operator" style=color:#393A34>/</span><span class="token number" style=color:#36acaa>4</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> e</span><span class="token operator" style=color:#393A34>/</span><span class="token number" style=color:#36acaa>4</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">e</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>%</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>7</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>Date formats vary according to culture and nation. While the format month/
day/year is common in the United States of America, European<br>
<!-- -->countries often use the day/month/year format, and technical publications sometimes
standardize on the year/month/day format (ISO/IEC 8824). In other words,
no order of arguments in the weekday function is “logical” or “conventional”.
That being the case, the alternative way to pass parameters to a function is
to use “named parameters”, as in the next examples (the three function calls are equivalent):</p>
<p>Listing: weekday usage —positional parameters</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">new wkday1 </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>weekday</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">month </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>12</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">day </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>31</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">year </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1999</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">new wkday2 </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>weekday</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">day </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>31</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">month </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>12</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">year </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1999</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">new wkday3 </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>weekday</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">year </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1999</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">month </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>12</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">day </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>31</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>With named parameters, a period (“.”) precedes the name of the<br>
<!-- -->function argument. The function argument can be set to any expression that is valid
for the argument. The equal sign (“=”) does in the case of a named
parameter not indicate an assignment; rather it links the expression that follows the
equal sign to one of the function arguments.</p>
<p>One may mix positional parameters and named parameters in a function call
with the restriction that all positional parameters must precede any named
parameters.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-default-values-of-function-arguments>• Default values of function arguments<a href=#-default-values-of-function-arguments class=hash-link aria-label="• Default values of function arguments的直接链接" title="• Default values of function arguments的直接链接">​</a></h3>
<p>A function argument may have a default value. The default value for a function
argument must be a constant. To specify a default value, append the equal
sign (“=”) and the value to the argument name.</p>
<p>When the function call specifies an argument placeholder instead of a valid ar-
gument, the default value applies. The argument placeholder is the underscore
character (“_”). The argument placeholder is only valid for function arguments
that have a default value.</p>
<p>The rightmost argument placeholders may simply be stripped from the function
argument list. For example, if function increment is defined as:</p>
<p>Listing: increment function —default values</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>increment</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">value</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> incr</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> value </span><span class="token operator" style=color:#393A34>+=</span><span class="token plain"> incr</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>the following function calls are all equivalent:</p>
<p>Listing: increment usage</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>increment</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>increment</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> \_</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>increment</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>Default argument values for passed-by-reference arguments are useful to make
the input argument optional. For example, if the function divmod is designed
to return both the quotient and the remainder of a division operation through
its arguments, default values make these arguments optional:</p>
<p>Listing: divmod function —default values for reference parameters</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>divmod</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">quotient</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">remainder</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    quotient </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> a </span><span class="token operator" style=color:#393A34>/</span><span class="token plain"> b</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    remainder </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> a </span><span class="token operator" style=color:#393A34>%</span><span class="token plain"> b</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>With the preceding definition of function divmod, the following function calls
are now all valid:</p>
<p>Listing: divmod usage</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">new p</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> q</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>divmod</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> p</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> q</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>divmod</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> p</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> \_</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>divmod</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> \_</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> q</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>divmod</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> p</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">divmod </span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> p</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> q</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>Default arguments for array arguments are often convenient to set a default
string or prompt to a function that receives a string argument. For example:</p>
<p>Listing: print error function</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>print_error</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> message</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> title</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"Error: "</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print title</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print message</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>The next example adds the fields of one array to another array, and by default
increments the first three elements of the destination array by one:</p>
<p>Listing: addvector function, revised</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>addvector</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> size </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new i </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> size</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    a</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+=</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<p><code>Public functions do not support default argument values; see page 83</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-sizeof-operator--default-function-arguments>• sizeof operator & default function arguments<a href=#-sizeof-operator--default-function-arguments class=hash-link aria-label="• sizeof operator & default function arguments的直接链接" title="• sizeof operator & default function arguments的直接链接">​</a></h3>
<p>A default value of a function argument must be a constant, and its value is
determined at the point of the function’s declaration. Using the<br>
<!-- -->“sizeof” operator to set the default value of a function argument is a special case: the
calculation of the value of the sizeof expression is delayed to the point of the
function call and it takes the size of the actual argument rather than that of
the formal argument. When the function is used several times in a program,
with different arguments, the outcome of the “sizeof” expression is potentially
different at every call —which means that the “default value” of the function
argument may change.</p>
<p>Below is an example program that draws ten random numbers in the range of
0–51 without duplicates. An example for an application for drawing random
numbers without duplicates is in card games —those ten numbers could repre-
sent the cards for two “hands” in a poker game. The virtues of the algorithm
used in this program, invented by Robert W. Floyd, are that it is efficient and
unbiased —provided that the pseudo-random number generator is unbiased as well.</p>
<p>Listing: randlist.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new HandOfCards</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>FillRandom</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">HandOfCards</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>52</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"A draw of 10 numbers from a range of 0 to 51 \</span><br></span><span class=token-line style=color:#393A34><span class="token string" style=color:#e3116c>        (inclusive) without duplicates:\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new i </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token plain"> HandOfCards</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        printf </span><span class="token string" style=color:#e3116c>"%d "</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> HandOfCards</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>FillRandom</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Series</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Range</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Number </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token plain"> Series</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    assert Range </span><span class="token operator" style=color:#393A34>>=</span><span class="token plain"> Number          </span><span class="token comment" style=color:#999988;font-style:italic>/* cannot select 50 values</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>                                     * without duplicates in the</span><br></span><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>                                     * range 0..40, for example */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new Index </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new Seq </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Range </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> Number</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> Seq </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> Range</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> Seq</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        new Val </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>random</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Seq </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        new Pos </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>InSeries</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Series</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Val</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Index</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Pos </span><span class="token operator" style=color:#393A34>>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            Series</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Series</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Pos</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            Series</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Pos</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Seq</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            Series</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">Index</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> Val</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        Index</span><span class="token operator" style=color:#393A34>++</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>InSeries</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Series</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Value</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Top </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token plain"> Series</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new i </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> Top</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Series</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> Value</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> i</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>Function main declares the array HandOfCards with a size of ten cells and then
calls function FillRandom with the purpose that it draws ten positive random
numbers below 52. Observe, however, that the only two parameters that main
passes into the call to FillRandom are the array HandsOfCards, where<br>
<!-- -->the random numbers should be stored, and the upper bound “52”. The number of
random numbers to draw (“10”) is passed implicitly to FillRandom.</p>
<p>The definition of function FillRandom below main specifies for its third param-
eter “Number = sizeof Series”, where “Series” refers to the first parameter
of the function. Due to the special case of a “sizeof default value”, the
default value of the Number argument is not the size of the formal argument Series,
but that of the actual argument at the point of the function call: HandOfCards.</p>
<p>Note that inside function FillRandom, asking the “sizeof” the function ar-
gument Series would (still) evaluate in zero, because the Series array<br>
<!-- -->is declared with unspecified length (see page 109 for the behaviour of sizeof).
Using sizeof as a default value for a function argument is a specific case. If
the formal parameter Series were declared with an explicit size, as in
Series[10], it would be redundant to add a Number argument with the array
size of the actual argument, because the parser would then enforce that both
formal and actual arguments have the size and dimensions.</p>
<hr>
<p><code>“sizeof ” operator 109</code></p>
<p><code>“random” is a proposed core function, see page 124</code></p>
<p><code>Array declarations: 64</code></p>
<p><code>Tag names: 68</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-arguments-with-tag-names>• Arguments with tag names<a href=#-arguments-with-tag-names class=hash-link aria-label="• Arguments with tag names的直接链接" title="• Arguments with tag names的直接链接">​</a></h3>
<p>A tag optionally precedes a function argument. Using tags improves<br>
<!-- -->the compile-time error checking of the script and it
serves as “implicit documenta-
tion” of the function. For example, a function that computes the square root</p>
<p>of an input value in fixed point precision may require that the input parameter
is a fixed point value and that the result is fixed point as well. The function
below uses the fixed point extension module, and an approximation algorithm
known as “bisection” to calculate the square root. Note the use of tag overrides
on numeric literals and expression results.</p>
<p>Listing: sqroot function —strong tags</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>sqroot</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> value</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> low </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> high </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> value</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>while</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">high </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> low </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        new Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> mid </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">low </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> high</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>>></span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>fmul</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">mid</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> mid</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> value</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            low </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> mid</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            high </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> mid</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> low</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>With the above definition, the pawn parser issues a diagnostic if one calls the
sqroot function with a parameter with a tag different from “Fixed:”, or when
it tries to store the function result in a variable with a “non-Fixed:” tag.</p>
<p>The bisection algorithm is related to binary search, in the sense that it
continuously halves the interval in which the result must lie. A “successive substi-
tution” algorithm like Newton-Raphson, that takes the slope of the function’s
curve into account, achieves precise results more quickly, but at the cost that
a stopping criterion is more difficult to state. State of the art algorithms
for computing square roots combine bisection and Newton-Raphson algorithms.</p>
<p>In the case of an array, the array indices can be tagged as well. For example,
a function that creates the intersection of two rectangles may be written as:</p>
<p>Listing: intersection function</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>intersection</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">dest</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">rectangle</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> src1</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">rectangle</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> src2</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">rectangle</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">src1</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">right</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> src2</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">left</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain"> src1</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">left</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> src2</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">right</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain"> src1</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">bottom</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> src2</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">top</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&&</span><span class="token plain"> src1</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">top</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> src2</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">bottom</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        \</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> there is an intersection</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> calculate it using the </span><span class="token string" style=color:#e3116c>"min"</span><span class="token plain"> and</span><br></span><span class=token-line style=color:#393A34><span class="token plain">         </span><span class="token operator" style=color:#393A34>*</span><span class="token string" style=color:#e3116c>"max"</span><span class="token plain"> functions from the </span><span class="token string" style=color:#e3116c>"core"</span><span class="token plain"> library</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> see page </span><span class="token number" style=color:#36acaa>124.</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        dest</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">left</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>max</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">src1</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">left</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> src2</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">left</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        dest</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">right</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>min</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">src1</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">right</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> src2</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">right</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        dest</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">top</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>max</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">src1</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">top</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> src2</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">top</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        dest</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">bottom</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>min</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">src1</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">bottom</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> src2</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">bottom</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> true</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>/* "src1" and "src2" do not intersect */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        dest </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> false</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<p><code>Fixed point arithmetic: 90; see also the application note “Fixed Point Support Library”</code></p>
<p><code>For the “rectangle” tag, see page 68</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-variable-arguments>• Variable arguments<a href=#-variable-arguments class=hash-link aria-label="• Variable arguments的直接链接" title="• Variable arguments的直接链接">​</a></h3>
<p>A function that takes a variable number of arguments, uses the “ellipsis” oper-
ator (“...”) in the function header to denote the position of the first variable
argument. The function can access the arguments with the predefined func-
tions numargs, getarg and setarg (see page 124).</p>
<p>Function sum returns the summation of all of its parameters.
It uses a variable length parameter list.</p>
<p>Listing: sum function, revised</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>sum</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new result </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">new i </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>numargs</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>++</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        result </span><span class="token operator" style=color:#393A34>+=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>getarg</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> result</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>This function could be used in:</p>
<p>Listing: sum function usage</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">new v </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>sum</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>5</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>A tag may precede the ellipsis to enforce that all subsequent parameters have the same tag, but otherwise there is no error
checking with a variable argument list and this feature should therefore be used with caution.</p>
<p>The functions getarg and setarg assume that the argument is passed “by
reference”. When using getarg on normal function parameters (instead of
variable arguments) one should be cautious of this, as neither the compiler nor
the abstract machine can check this. Actual parameters that are passed
as part of a “variable argument list” are always passed by reference.</p>
<hr>
<p><code>Tag names: 68</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-coercion-rules>• Coercion rules<a href=#-coercion-rules class=hash-link aria-label="• Coercion rules的直接链接" title="• Coercion rules的直接链接">​</a></h3>
<p>If the function argument, as per the function definition (or its declaration),
is a “value parameter”, the caller can pass as a parameter to the function:</p>
<ul>
<li>
<p>a value, which is passed by value;</p>
</li>
<li>
<p>a reference, whose dereferenced value is passed;</p>
</li>
<li>
<p>an (indexed) array element, which is a value.</p>
</li>
</ul>
<p>If the function argument is a reference, the caller can pass to the function:</p>
<ul>
<li>
<p>a value, whose address is passed;</p>
</li>
<li>
<p>a reference, which is passed by value because it has the type that the function expects;</p>
</li>
<li>
<p>an (indexed) array element, which is a value.</p>
</li>
</ul>
<p>If the function argument is an array, the caller can pass to the function:</p>
<ul>
<li>
<p>an array with the same dimensions, whose starting address is passed;</p>
</li>
<li>
<p>an (indexed) array element, in which case the address of the element is passed.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-recursion>• Recursion<a href=#-recursion class=hash-link aria-label="• Recursion的直接链接" title="• Recursion的直接链接">​</a></h3>
<p>A faculty example function earlier in this chapter used a simple loop. An
example function that calculated a number from the Fibonacci series also used
a loop and an extra variable to do the trick. These two functions are the most
popular routines to illustrate recursive functions, so by implementing<br>
<!-- -->these as iterative procedures, you might be inclined to think that pawn does not support recursion.</p>
<p>Well, pawn does support recursion, but the calculation of faculties and of Fi-
bonacci numbers happen to be good examples of when not to use recursion.
Faculty is easier to understand with a loop than it is with recursion.<br>
<!-- -->Solving Fibonacci numbers by recursion indeed simplifies the problem, but at the
cost of being extremely inefficient: the recursive Fibonacci calculates the same
values over and over again.</p>
<p>The program below is an implementation of the famous “Towers of Hanoi” game in a recursive function:</p>
<p>Listing: hanoi.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>/* The Towers of Hanoi, a game solved through recursion */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"How many disks: "</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new disks </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    move </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> disks</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>move</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">from</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> to</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> spare</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> numdisks</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">numdisks </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        move from</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> spare</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> to</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> numdisks</span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    printf </span><span class="token string" style=color:#e3116c>"Move disk from pillar %d to pillar %d\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> from</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> to</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">numdisks </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        move spare</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> to</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> from</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> numdisks</span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<p><code>“faculty”: 71</code></p>
<p><code>“fibonacci”: 11</code></p>
<p><code>There exists an intriguing iterative solution to the Towers of Hanoi.</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-forward-declarations>• Forward declarations<a href=#-forward-declarations class=hash-link aria-label="• Forward declarations的直接链接" title="• Forward declarations的直接链接">​</a></h3>
<p>For standard functions, the current “reference implementation” of the pawn
compiler does not require functions to be declared before their first use.∗<br>
<!-- -->Userdefined operators are special functions, and unlike standard functions<br>
<!-- -->theymust be declared before use. In many cases it is convenient to put the
implementation of a user-defined operator in an include file, so that the implementation and declaration precedes any
call/invocation. Sometimes, it may however be required (or convenient) to declare a user- defined operator first
and implement it elsewhere. A particular use of this technique is to implement
“forbidden” user-defined operators.</p>
<p>To create a forward declaration, precede the function name and its parame-
ter list with the keyword forward. For compatibility with early versions of
pawn, and for similarity with C/C⁺⁺, an alternative way to forwardly declare
a function is by typing the function header and terminating it with a semicolon
(which follows the closing parenthesis of the parameter list).</p>
<p>The full definition of the function, with a non-empty body, is
implemented elsewhere in the source file (except for forbidden user-defined operators).</p>
<p>State classifiers are ignored on forward declarations.</p>
<hr>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=-other-implementations-of-the-pawn-language-if-they-exist-may-use-single-pass-parsers-requiring-functions-to-be-defined-before-use>∗ Other implementations of the Pawn language (if they exist) may use “single pass” parsers, requiring functions to be defined before use.<a href=#-other-implementations-of-the-pawn-language-if-they-exist-may-use-single-pass-parsers-requiring-functions-to-be-defined-before-use class=hash-link aria-label="∗ Other implementations of the Pawn language (if they exist) may use “single pass” parsers, requiring functions to be defined before use.的直接链接" title="∗ Other implementations of the Pawn language (if they exist) may use “single pass” parsers, requiring functions to be defined before use.的直接链接">​</a></h6>
<hr>
<p><code>Forbidden userdefined operators: 92</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-state-classifiers>• State classifiers<a href=#-state-classifiers class=hash-link aria-label="• State classifiers的直接链接" title="• State classifiers的直接链接">​</a></h3>
<p>All functions except native functions may optionally have a state attribute.
This consists of a list of state (and automata) names between angle brackets
behind the function header. The names are separated by commas. When the
state is part of a non-default automaton, the name of the automaton and a
colon separator must precede the state; for example, “parser<!-- -->:slash<!-- -->” stands
for the state slash of the automaton parser.</p>
<p>If a function has states, there must be several “implementations” of the function in the source code.
All functions must have the same function header (excluding the state classifier list).</p>
<p>As a special syntax, when there are no names between the angle brackets, the
function is linked to all states that are not attributed to other
implementations of the function. The function that handles “all states not handled elsewhere”
is the so-called fall-back function.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-public-functions-function-main>• Public functions, function main<a href=#-public-functions-function-main class=hash-link aria-label="• Public functions, function main的直接链接" title="• Public functions, function main的直接链接">​</a></h3>
<p>A stand-alone program must have the function main. This function is<br>
<!-- -->the starting point of the program. The function main may not have arguments.</p>
<p>A function library need not to have a main function, but it must have it either
a main function, or at least one public function. Function main is the primary
entry point into the compiled program; the public functions are<br>
<!-- -->alternative entry points to the program. The virtual machine can start execution with
one of the public functions. A function library may have a main function to
perform one-time initialization at startup.</p>
<p>To make a function public, prefix the function name with the keyword public.
For example, a text editor may call the public function “onkey” for every key
that the user typed in, so that the user can change (or reject) keystrokes. The
onkey function below would replace every “~” character (code 126 in the ISO
Latin-1 character set) by the “hard space” code in the ANSI character table:</p>
<p>Listing: onkey function</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">public </span><span class="token function" style=color:#d73a49>onkey</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">keycode</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">key</span><span class="token operator" style=color:#393A34>==</span><span class="token plain">’</span><span class="token operator" style=color:#393A34>~</span><span class="token plain">’</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>160</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>/* replace ~ by hard space (code 160 in Latin-1) */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> key </span><span class="token comment" style=color:#999988;font-style:italic>/* leave other keys unaltered */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<p><code>Example: 40</code></p>
<hr>
<p>Functions whose name starts with the “@” symbol are also public. So
an alternative way to write the public function onkey function is:</p>
<p>Listing: @onkey function</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">@</span><span class="token function" style=color:#d73a49>onkey</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">keycode</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> key</span><span class="token operator" style=color:#393A34>==</span><span class="token plain">’</span><span class="token operator" style=color:#393A34>~</span><span class="token plain">’ </span><span class="token operator" style=color:#393A34>?</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>160</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> key</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>The “@” character, when used, becomes part of the function name; that is, in
the last example, the function is called “@onkey”. The host application decides
on the names of the public functions that a script may implement.</p>
<p>Arguments of a public function may not have default values. A public func-
tion interfaces the host application to the pawn script. Hence, the arguments
passed to the public function originate from the host application, and the host
application cannot know what “default values” the script writer plugged for
function arguments —which is why the pawn parser flags the use of default
values for arguments of public functions as an error. The issue of default
values in public function arguments only pops up in the case that you wish to call public functions from the script itself.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-static-functions>• Static functions<a href=#-static-functions class=hash-link aria-label="• Static functions的直接链接" title="• Static functions的直接链接">​</a></h3>
<p>When the function name is prefixed with the keyword static, the scope of the
function is restricted to the file that the function resides in.</p>
<p>The static attribute can be combined with the “stock” attribute.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-stock-functions>• Stock functions<a href=#-stock-functions class=hash-link aria-label="• Stock functions的直接链接" title="• Stock functions的直接链接">​</a></h3>
<p>A “stock” function is a function that the pawn parser must “plug into” the
program when it is used, and that it may simply “remove” from the program
(without warning) when it is not used. Stock functions allow a compiler or
interpreter to optimize the memory footprint and the file size of a (compiled)
pawn program: any stock function that is not referred to, is completely skipped
—as if it were lacking from the source file.</p>
<p>A typical use of stock functions, hence, is in the creation of a set of
“library” functions. A collection of general purpose functions, all marked as “stock” may
be put in a separate include file, which is then included in any pawn<br>
<!-- -->script. Only the library functions that are actually used get “linked” in.</p>
<p>To declare a stock function, prefix the function name with the keyword stock.
Public functions and native functions cannot be declared “stock”.</p>
<p>When a stock function calls other functions, it is usually a good practice to
declare those other functions as “stock” too —with the exception of<br>
<!-- -->native functions. Similarly, any global variables that are used by a stock
function should in most cases also be defined “stock”. The removal of unused (stock)
functions can cause a chain reaction in which other functions and global vari-
ables are not longer accessed either. Those functions are then removed as well,
thereby continuing the chain reaction until only the functions that are used,
directly or indirectly, remain.</p>
<hr>
<p><code>Default values of function arguments: 75</code></p>
<p><code>Public variables can be declared “stock”</code></p>
<p><code>Stock variables: 63</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-native-functions>• Native functions<a href=#-native-functions class=hash-link aria-label="• Native functions的直接链接" title="• Native functions的直接链接">​</a></h3>
<p>A pawn program can call application-specific functions through a “native function”.
The native function must be declared in the pawn program by means
of a function prototype. The function name must be preceded by the keyword native.</p>
<p>Examples:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native </span><span class="token function" style=color:#d73a49>getparam</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> size</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native </span><span class="token function" style=color:#d73a49>multiply_matrix</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> size</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native </span><span class="token function" style=color:#d73a49>openfile</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> name</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>The names “getparam”, “multiply_matrix” and “openfile” are the internal
names of the native functions; these are the names by which the<br>
<!-- -->functions are known in the pawn program. Optionally, you may also set an external
name for the native function, which is the name of the function as the “host application” knows it.
To do so, affix an equal sign to the function prototype followed by the external name. For example:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native </span><span class="token function" style=color:#d73a49>getparam</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> size</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> host_getparam</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native </span><span class="token function" style=color:#d73a49>multiply_matrix</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> size</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> mtx_mul</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>When a native function returns an array, the dimensions and size of the ar-
ray must be explicitly declared. The array specification occurs between<br>
<!-- -->the function name and the parameter list. For example:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>enum</span><span class="token plain"> </span><span class="token class-name">rect</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> left</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> top</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> right</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> bottom </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native intersect</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">rect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">src1</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">rect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> src2</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">rect</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>Unless specified explicitly, the external name is equal to the internal name of
a native function. One typical use for explicit external names is to set a
symbolic name for a user-defined operator that is implemented as a native function.</p>
<p>See the “Implementor’s Guide” for implementing native functions in C/C++(on the “host application” side).</p>
<p>Native functions may not have state specifiers.</p>
<hr>
<p><code>An example of a native user-defined operator is on page 89</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-user-defined-operators>• User-defined operators<a href=#-user-defined-operators class=hash-link aria-label="• User-defined operators的直接链接" title="• User-defined operators的直接链接">​</a></h3>
<p>The only data type of pawn is a “cell”, typically a 32-bit number or bit
pattern.</p>
<p>Tags: 68 The meaning of a value in a cell depends on the particular application —it need
not always be a signed integer value. pawn allows to attach a “meaning” to a cell with its “tag” mechanism.</p>
<p>Based on tags, pawn also allows you to redefine operators for cells<br>
<!-- -->with a specific purpose. The example below defines a tag “ones” and an<br>
<!-- -->operator to add two “ones” values together (the example also implements<br>
<!-- -->operators for subtraction and negation). The example was inspired by the checksum
algorithm of several protocols in the TCP/IP protocol suite: it simulates one’s
complement arithmetic by adding the carry bit of an arithmetic overflow back
to the least significant bit of the value.</p>
<p>Listing: ones.p</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">forward ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>+</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> a</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">forward ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>-</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> a</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">forward ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>-</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> a</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> chksum </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0xffffffff</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    print </span><span class="token string" style=color:#e3116c>"Input values in hexadecimal, zero to exit\n"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> value</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>do</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        print </span><span class="token string" style=color:#e3116c>">> "</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        value </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>getvalue</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>.</span><span class="token plain">base</span><span class="token operator" style=color:#393A34>=</span><span class="token number" style=color:#36acaa>16</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        chksum </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> chksum </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> value</span><br></span><span class=token-line style=color:#393A34><span class="token plain">        printf </span><span class="token string" style=color:#e3116c>"Checksum = %x\n"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> chksum</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>while</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">value</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">stock ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>+</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> a</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> mask </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0xffff</span><span class="token plain">                 </span><span class="token comment" style=color:#999988;font-style:italic>/* word mask */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> shift </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>16</span><span class="token plain">                    </span><span class="token comment" style=color:#999988;font-style:italic>/* word shift */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/* add low words and high words separately */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> r1 </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a </span><span class="token operator" style=color:#393A34>&</span><span class="token plain"> mask</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">b </span><span class="token operator" style=color:#393A34>&</span><span class="token plain"> mask</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> r2 </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a </span><span class="token operator" style=color:#393A34>>></span><span class="token operator" style=color:#393A34>></span><span class="token plain"> shift</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">b </span><span class="token operator" style=color:#393A34>>></span><span class="token operator" style=color:#393A34>></span><span class="token plain"> shift</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> carry</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    restart</span><span class="token operator" style=color:#393A34>:</span><span class="token plain">                                        </span><span class="token comment" style=color:#999988;font-style:italic>/* code label (goto target) */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    \</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> add carry of the new low word to the high word</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> then</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> strip it from the low word </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    carry </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">r1 </span><span class="token operator" style=color:#393A34>>></span><span class="token operator" style=color:#393A34>></span><span class="token plain"> shift</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    r2 </span><span class="token operator" style=color:#393A34>+=</span><span class="token plain"> carry</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    r1 </span><span class="token operator" style=color:#393A34>&=</span><span class="token plain"> mask</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    \</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> add the carry from the new high word back to the low</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> word</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> then strip it from the high word </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    carry </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">r2 </span><span class="token operator" style=color:#393A34>>></span><span class="token operator" style=color:#393A34>></span><span class="token plain"> shift</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    r1 </span><span class="token operator" style=color:#393A34>+=</span><span class="token plain"> carry</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    r2 </span><span class="token operator" style=color:#393A34>&=</span><span class="token plain"> mask</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    \</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> a carry from the high word injected back into the low</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> word may cause the new low to overflow</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> so restart in that </span><span class="token keyword" style=color:#00009f>case</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>/</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">carry</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>goto</span><span class="token plain"> restart</span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">r2 </span><span class="token operator" style=color:#393A34>&lt;&lt;</span><span class="token plain"> shift</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> r1</span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">stock ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>-</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> a</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0xffffffff</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>?</span><span class="token plain"> a </span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>~</span><span class="token plain">a</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">stock ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>-</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> a</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> a </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token plain">b</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>The notable line in the example is the line “chksum = chksum + value” in
the loop in function main. Since both the variables chksum and value have
the tag ones, the “+” operator refers to the user-defined operator<br>
<!-- -->(instead of the default “+” operator). User-defined operators are merely a notational
convenience. The same effect is achieved by calling functions explicitly.</p>
<p>The definition of an operator is similar to the definition of a function, with
the difference that the name of the operator is composed by the keyword “opera-
tor” and the character of the operator itself. In the above example, both the
unary “-” and the binary “-” operators are redefined. An operator function
for a binary operator must have two arguments, one for an unary<br>
<!-- -->operator must have one argument. Note that the binary “-” operator adds the two val-
ues together after inverting the sign of the second operand. The subtraction</p>
<p>operator thereby refers to both the user-defined “negation” (unary “-”) and addition operators.</p>
<p>A redefined operator must adhere to the following restrictions:</p>
<ul>
<li>
<p>A user-defined operator must be declared before use (this is in contrast to “normal” functions): either put the implementation of the user-defined operator above the functions that use it, or add a forward declaration near the top of the file.</p>
</li>
<li>
<p>Only the following operators may be redefined: +, -, *, /, %, ++, --, ==, !=, &lt;, > , &lt;=, >=, ! and =. That is, the sets of arithmetic and relational operators can be overloaded, but the bitwise operators and the logical operators cannot. The = and ! operators are a special case.</p>
</li>
<li>
<p>You cannot invent new operators; you cannot define operator “#” for example.</p>
</li>
<li>
<p>The precedence level and associativity of the operators, as well as their “arity” remain as defined. You cannot make an unary “+” operator, for example.</p>
</li>
<li>
<p>The return tag of the relational operators and of the “!” operator must be “bool:”.</p>
</li>
<li>
<p>The return tag of the arithmetic operators is at your choosing, but you cannot redefine an operator that is identical to another operator except for its return tag. For example, you cannot make both <code>alpha: operator+(alpha: a, alpha: b)</code> and <code>beta: operator+(alpha: a, alpha: b)</code> (The assignment operator is an exception to this rule.)</p>
</li>
<li>
<p>PAWN already defines operators to work on untagged cells, you cannot redefine the operators with only arguments without tags.</p>
</li>
<li>
<p>The arguments of the operator function must be non-arrays passed by value. You cannot make an operator work on arrays.</p>
</li>
</ul>
<p>In the example given above, both arguments of the binary operators have the
same tag. This is not required; you may, for example, define a<br>
<!-- -->binary “+” operator that adds an integer value to a “ones:” number.</p>
<p>Au fond, the operation of the pawn parser is to look up the tag(s)
of the operand(s) that the operator works on and to look up whether a user-defined
operator exists for the combination of the operator and the tag(s). However,
the parser recognizes special situations and provides the following features:</p>
<p>The parser recognizes operators like “+=” as a sequence of “+” and<br>
<!-- -->“=” and it will call a user-defined operator “+” if available and/or a user-defined
operator “=”. In the example program, the line “chksum = chksum + value”
might have been abbreviated to “chksum += value”.</p>
<p>The parser recognizes commutative operators (“+”, “*”, “==”, and “!=”)
and it will swap the operands of a commutative operator if that produces
a fit with a user-defined operator. For example, there is usually no need to implement both</p>
<p><code>ones:operator+(ones:a, b)</code></p>
<p>and</p>
<p><code>ones:operator+(a, ones:b)</code></p>
<p>(implementing both functions is valid, and it is useful in case the user-defined
operator should not be commutative).</p>
<ul>
<li>
<p>Prefix and postfix operators are handled automatically. You only need to define one user operator for the “++” and “--” operators for a tag.</p>
</li>
<li>
<p>The parser calls the “!” operator implicitly in case of a test without explicit comparison. For example, in the statement “if (var) ...” when “var” has tag “ones:”, the user-defined operator “!” will be called for var. The “!” operator thus doubles as a “test for zero” operator. (In one’s complement arithmetic, both the “all-ones” and the “all-zeros” bit patterns represent zero.)</p>
</li>
<li>
<p>The user-defined assignment operator is implicitly called for a function argument that is passed “by value” when the tag names of the formal and the actual arguments match the tag names of the left and right hand sides of the operator. In other words, the pawn parser simulates that “pass by value” happens through assignment. The user-defined operator is not called for function arguments that are passed “by reference”.</p>
</li>
<li>
<p>If you wish to forbid an operation, you can “forward declare” the operator without ever defining it (see page 82). This will flag an error when the user-defined operator is invoked. For example, to forbid the “%” operator (remainder after division) on floating point values, you can add the line: <code>forward Float: operator%(Float: a, Float: b)</code></p>
</li>
</ul>
<p>User-defined operators can optionally be declared “stock” or “native”. In the case of a native operator function, the definition should include an external name. For example (when, on the host’s side, the native function is called float_add):</p>
<p>Listing: native operator+ function</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native Float</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>+</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Float</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> val</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Float</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> val</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> float_add</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>The user-defined assignment operator is a special case, because it is an
operator that has a side effect. Although the operator has the appearance of a binary
operator, its “expression result” is the value at the right hand —the assignment
operator would be a “null”-operator if it weren’t for its side-effect. In pawn
a user-defined assignment operator is declared as:</p>
<p>Listing: operator= function</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>=</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> ones</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a </span><span class="token operator" style=color:#393A34>>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>?</span><span class="token plain"> a </span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>~</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>-</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>The user-defined “=” operator looks like a unary operator in this
definition, but it is a special case nevertheless. In contrast to the other
operators, the tag of the return value for the user-defined operator is important: the pawn
parser uses the tags of the argument and the return value to find a matching user-defined operator.</p>
<p>The example function above is a typical application for a user-defined assign-
ment operator: to automatically coerce/convert an untagged value to a tagged
value, and to optionally change the memory representation of the value in the
process. Specifically, the statement “new ones<!-- -->:A<!-- --> = -5” causes the user-defined
operator to run, and for the constant -5 the operator will return “~(- -5)”, or ~5, or −6.∗</p>
<hr>
<p><code>Tags: 68</code></p>
<p><code>Forward declaration: 82</code></p>
<p><code>“Call by value” versus “call by reference”: 71</code></p>
<p><code>Native functions: 85</code></p>
<p><code>Rational literals: 98</code></p>
<p><code>#pragma rational: 121</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-floating-point-and-fixed-point-arithmetic>• Floating point and fixed point arithmetic<a href=#-floating-point-and-fixed-point-arithmetic class=hash-link aria-label="• Floating point and fixed point arithmetic的直接链接" title="• Floating point and fixed point arithmetic的直接链接">​</a></h3>
<p>pawn only has intrinsic support for integer arithmetic (the -domain: “whole
numbers”, both positive and negative). Support for floating point arithmetic
or fixed point arithmetic must be implemented through (native) functions.
User operators, then, allow a more natural notation of expressions with fixed or floating point numbers.</p>
<p>The pawn parser has support for literal values with a fractional part, which it
calls “rational numbers”. Support for rational literals must be enabled explic-
itly with a #pragma. The #pragma indicates how the rational numbers must
be stored —floating point or fixed point. For fixed point rational values, the
#pragma also specifies the precision in decimals. Two examples for the #pragma are:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>pragma</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>rational Float </span><span class="token macro property comment" style=color:#999988;font-style:italic>/* floating point format */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>pragma</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>rational </span><span class="token macro property expression function" style=color:#d73a49>Fixed</span><span class="token macro property expression punctuation" style=color:#393A34>(</span><span class="token macro property expression number" style=color:#36acaa>3</span><span class="token macro property expression punctuation" style=color:#393A34>)</span><span class="token macro property expression" style=color:#36acaa> </span><span class="token macro property comment" style=color:#999988;font-style:italic>/* fixed point, with 3 decimals */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<hr>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=-modern-cpus-use-twos-complement-integer-arithmetic-for-positive-values-the-bitwise-representation-of-a-value-is-the-same-in-ones-complement-and-twos-complement-but-the-representations-differ-for-negative-values-for-instance-the-same-bit-pattern-that-means--5-in-ones-complement-stands-for--6-in-twos-complement>∗ Modern CPUs use two’s complement integer arithmetic. For positive values, the bitwise representation of a value is the same in one’s complement and two’s complement, but the representations differ for negative values. For instance, the same bit pattern that means -5 in one’s complement stands for -6 in two’s complement.<a href=#-modern-cpus-use-twos-complement-integer-arithmetic-for-positive-values-the-bitwise-representation-of-a-value-is-the-same-in-ones-complement-and-twos-complement-but-the-representations-differ-for-negative-values-for-instance-the-same-bit-pattern-that-means--5-in-ones-complement-stands-for--6-in-twos-complement class=hash-link aria-label="∗ Modern CPUs use two’s complement integer arithmetic. For positive values, the bitwise representation of a value is the same in one’s complement and two’s complement, but the representations differ for negative values. For instance, the same bit pattern that means -5 in one’s complement stands for -6 in two’s complement.的直接链接" title="∗ Modern CPUs use two’s complement integer arithmetic. For positive values, the bitwise representation of a value is the same in one’s complement and two’s complement, but the representations differ for negative values. For instance, the same bit pattern that means -5 in one’s complement stands for -6 in two’s complement.的直接链接">​</a></h6>
<hr>
<p>Since a fixed point value must still fit in a cell, the number of decimals
has a direct influence of the range of a fixed point value. For a fixed point value
with 3 decimals, the range would be −2, 147, 482 . . . + 2, 147, 482.</p>
<p>The format for a rational number may only be specified once for the entire
pawn program. In an implementation one typically chooses either<br>
<!-- -->floating point support or fixed point support. As stated above, for the actual imple-
mentation of the floating point or fixed point arithmetic, pawn requires the
help of (native) functions and user-defined operators. A good place to put
the #pragma for rational number support would be in the include file that<br>
<!-- -->also defines the functions and operators.</p>
<p>The include file † for fixed point arithmetic contains definitions like:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator\</span><span class="token operator" style=color:#393A34>*</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> val1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> val2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> fmul</span><br></span><span class=token-line style=color:#393A34><span class="token plain">native Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>/</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> val1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> val2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> fdiv</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>The user-defined operators for multiplication and division of two fixed
point numbers are aliased directly to the native functions fmul and fdiv. The host
application must, then, provide these native functions.</p>
<p>Another native user-defined operator is convenient to transform an integer to
fixed point automatically, if it is assigned to a variable tagged as “Fixed:”:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>=</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">oper</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> fixed</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>With this definition, you can say “new Fixed: fract = 3” and the value
will be transformed to 3.000 when it is stored in variable fract. As explained
in the section on user-defined operators, the assignment operator also runs for
function arguments that are passed by value. In the expression “new Fixed:
root = sqroot(16)” (see the implementation of function sqroot on page 79),
the user-defined assignment operator is called on the argument 16.</p>
<p>For adding two fixed point values together, the default “+” operator is suffi-
cient, and the same goes for subtraction. Adding a normal (integer) number
to a fixed point number is different: the normal value must be scaled before
adding it. Hence, the include file implements operators for that purpose too:</p>
<h6 class="anchor anchorWithStickyNavbar_LWe7" id=-see-the-application-note-fixed-point-support-library-for-where-to-obtain-the-include-file>† See the application note “Fixed Point Support Library” for where to obtain the include file.<a href=#-see-the-application-note-fixed-point-support-library-for-where-to-obtain-the-include-file class=hash-link aria-label="† See the application note “Fixed Point Support Library” for where to obtain the include file.的直接链接" title="† See the application note “Fixed Point Support Library” for where to obtain the include file.的直接链接">​</a></h6>
<p>Listing: additive operators, commutative and non-commutative</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">stock Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>+</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> val1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> val2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> val1 </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>fixed</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">val2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">stock Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>-</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> val1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> val2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> val1 </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>fixed</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">val2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">stock Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>-</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">val1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> val2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>fixed</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">val1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> val2</span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>The “+” operator is commutative, so one implementation handles both cases.
For the “-” operator, both cases must be implemented separately.</p>
<p>Finally, the include file forbids the use of the modulus operator (“%”) on fixed
point values: the modulus is only applicable to integer values:</p>
<p>Listing: forbidden operators on fixed point values</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">forward Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>%</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> val1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> val2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">forward Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>%</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> val1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> val2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">forward Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> operator</span><span class="token operator" style=color:#393A34>%</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">val1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Fixed</span><span class="token operator" style=color:#393A34>:</span><span class="token plain"> val2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span></code></pre></div></div>
<p>Because of the presence of the (forward) declaration of the operator, the pawn
parser will attempt to use the user-defined operator rather than the default
“%” operator. By not implementing the operator, the parser will subsequently issue an error message.
<code>User-defined operators: 86</code></p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-call-by-value-and-call-by-reference>• Call by Value and Call by Reference<a href=#-call-by-value-and-call-by-reference class=hash-link aria-label="• Call by Value and Call by Reference的直接链接" title="• Call by Value and Call by Reference的直接链接">​</a></h3>
<p>In Pawn, function arguments can be passed in two ways: by value and by reference.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=call-by-value>Call by value<a href=#call-by-value class=hash-link aria-label="Call by value的直接链接" title="Call by value的直接链接">​</a></h4>
<p>In this method, the value of the variable is passed to the function. A copy of the variable is created and the function operates on the copy, not the original variable. Any changes made to the variable inside the function do not affect the original variable.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>swap</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	new c </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> a</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	a </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	b </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> c</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	new x </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>20</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	</span><span class="token function" style=color:#d73a49>printf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"The value of x is %d and value of y is %d, before calling 'swap'."</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	</span><span class="token function" style=color:#d73a49>swap</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	</span><span class="token function" style=color:#d73a49>printf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"The value of x is %d and value of y is %d, after calling 'swap'."</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<p>Output</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">The value of x is 10 and value of y is 20, before calling 'swap'.</span><br></span><span class=token-line style=color:#393A34><span class="token plain">The value of x is 10 and value of y is 20, after calling 'swap'.</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=call-by-reference>Call by reference<a href=#call-by-reference class=hash-link aria-label="Call by reference的直接链接" title="Call by reference的直接链接">​</a></h4>
<p>In this method, the address of the variable is passed to the function. The function operates on the original variable and any changes made to the variable inside the function are reflected in the original variable.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>swap</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">a</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">b</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	new c </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> a</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	a </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> b</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	b </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> c</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	new x </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>10</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>20</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	</span><span class="token function" style=color:#d73a49>printf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"The value of x is %d and value of y is %d, before calling 'swap'."</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	</span><span class="token function" style=color:#d73a49>swap</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	</span><span class="token function" style=color:#d73a49>printf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"The value of x is %d and value of y is %d, after calling 'swap'."</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<p>Output</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">The value of x is 10 and value of y is 20, before calling 'swap'.</span><br></span><span class=token-line style=color:#393A34><span class="token plain">The value of x is 20 and value of y is 10, after calling 'swap'.</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=-recursion--function-recursion>• Recursion / Function Recursion<a href=#-recursion--function-recursion class=hash-link aria-label="• Recursion / Function Recursion的直接链接" title="• Recursion / Function Recursion的直接链接">​</a></h3>
<p>Recursion in programming refers to the process of a function calling itself in order to solve a problem. It's a fundamental concept used to solve problems that can be broken down into smaller instances of the same problem. Recursion consists of two main components: base cases and recursive cases.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id=base-case>Base Case:<a href=#base-case class=hash-link aria-label="Base Case:的直接链接" title="Base Case:的直接链接">​</a></h5>
<p>Every recursive function should have one or more base cases. A base case is a condition under which the function stops calling itself and returns a result directly. Without base cases, the recursion would continue indefinitely, causing a stack overflow. Read Stack/Heap section to know more about it.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id=recursive-case>Recursive Case:<a href=#recursive-case class=hash-link aria-label="Recursive Case:的直接链接" title="Recursive Case:的直接链接">​</a></h5>
<p>The recursive case is where the function calls itself to solve a smaller instance of the problem. Each recursive call should bring the problem closer to a base case.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=example>Example<a href=#example class=hash-link aria-label=Example的直接链接 title=Example的直接链接>​</a></h4>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">stock </span><span class="token function" style=color:#d73a49>factorial</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">n</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// Base case: factorial of 0 is 1</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">n </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// Recursive case: n! = n * (n - 1)!</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>else</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> n </span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>factorial</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">n </span><span class="token operator" style=color:#393A34>-</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new num </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    new result </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>factorial</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">num</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>printf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"Factorial of %d is %d"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> num</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> result</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>// Output: Factorial of 3 is 6</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=demonstrate-the-output>Demonstrate the Output<a href=#demonstrate-the-output class=hash-link aria-label="Demonstrate the Output的直接链接" title="Demonstrate the Output的直接链接">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">main() \\ main function from where execution of program starts</span><br></span><span class=token-line style=color:#393A34><span class="token plain">new num = 3; \\ creates a num variable</span><br></span><span class=token-line style=color:#393A34><span class="token plain">new result = factorial(num); \\ create a result variable and calls the factorial() with passing value of num, factorial(5)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">factorial(3) \\ factorial initiate</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   if(3 == 0) \\ checks the condition which is false</span><br></span><span class=token-line style=color:#393A34><span class="token plain">   else{ 3 * factorial(3-1) } \\ 3 * and calls the factorial(2)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      factorial(2) \\ factorial initiate again</span><br></span><span class=token-line style=color:#393A34><span class="token plain">         if(2 == 0) \\ checks the condition which is false</span><br></span><span class=token-line style=color:#393A34><span class="token plain">         else{ 2 * factorial(2-1) } \\ 3 * 2 * and calls the factorial(1)</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            factorial(1) \\ factorial initiate again</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            if(1 == 0) \\ checks the condition which is false</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            else{ 1 * factorial(1-1) } \\ 3 * 2 * 1 and calls the factorial(0)</span><br></span><span class=token-line style=color:#393A34><span class="token plain"> 	       factorial(0) \\ factorial initiate again</span><br></span><span class=token-line style=color:#393A34><span class="token plain">               if(0 == 0) return 1 \\ checks the conition which is true and return 1</span><br></span><span class=token-line style=color:#393A34><span class="token plain">		\\ at the final call 3 * 2 * 1 * 1</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=stack-memory>Stack Memory<a href=#stack-memory class=hash-link aria-label="Stack Memory的直接链接" title="Stack Memory的直接链接">​</a></h3>
<p>The stack is a region of memory used for storing local variables, function call information, and control flow data. It operates in a Last-In-First-Out (LIFO) manner, which means that the last item pushed onto the stack is the first one to be popped off.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=example-stack-overflow>Example (Stack Overflow)<a href=#example-stack-overflow class=hash-link aria-label="Example (Stack Overflow)的直接链接" title="Example (Stack Overflow)的直接链接">​</a></h4>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-c codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>pragma</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>dynamic </span><span class="token macro property expression number" style=color:#36acaa>35</span><span class="token macro property expression" style=color:#36acaa> </span><span class="token macro property comment" style=color:#999988;font-style:italic>// (35 * 4 bytes, a cell size) #pragma dynamic [cells] helps to modify the size of stack, read docs/scripting/language/Directives to know more about #pragma</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>main</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	</span><span class="token function" style=color:#d73a49>grow_stack</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token function" style=color:#d73a49>grow_stacK</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">n</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"> </span><span class="token comment" style=color:#999988;font-style:italic>// recursive function</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	</span><span class="token function" style=color:#d73a49>printf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"N: %d"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> n</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">	</span><span class="token function" style=color:#d73a49>grow_stacK</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">n</span><span class="token operator" style=color:#393A34>+</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=output>Output<a href=#output class=hash-link aria-label=Output的直接链接 title=Output的直接链接>​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">N: 1</span><br></span><span class=token-line style=color:#393A34><span class="token plain">N: 2</span><br></span><span class=token-line style=color:#393A34><span class="token plain">N: 3</span><br></span><span class=token-line style=color:#393A34><span class="token plain">.. .</span><br></span><span class=token-line style=color:#393A34><span class="token plain">Stack/heap collision (insufficient stack size)</span><br></span></code></pre></div></div>
<p><img decoding=async loading=lazy src=https://i.imgur.com/ZaIVUkJ.png alt=Stack class=img_ev3q></p>
<p><a href=/zh-CN/docs/scripting/language/reference/00-Contents>Go Back to Contents</a></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/openmultiplayer/web/edit/master/frontend/i18n/zh-CN/docusaurus-plugin-content-docs/current/scripting/language/reference/04-Functions.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label=文件选项卡><a class="pagination-nav__link pagination-nav__link--prev" href=/zh-CN/docs/scripting/language/reference/Data-and-declarations><div class=pagination-nav__sublabel>上一页</div><div class=pagination-nav__label>Data-and-declarations</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/zh-CN/docs/scripting/language/reference/The-preprocessor><div class=pagination-nav__sublabel>下一页</div><div class=pagination-nav__label>The-preprocessor</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#-calling-functions class="table-of-contents__link toc-highlight">• Calling functions</a><li><a href=#-named-parameters-versus-positional-parameters class="table-of-contents__link toc-highlight">• Named parameters versus positional parameters</a><li><a href=#-default-values-of-function-arguments class="table-of-contents__link toc-highlight">• Default values of function arguments</a><li><a href=#-sizeof-operator--default-function-arguments class="table-of-contents__link toc-highlight">• sizeof operator & default function arguments</a><li><a href=#-arguments-with-tag-names class="table-of-contents__link toc-highlight">• Arguments with tag names</a><li><a href=#-variable-arguments class="table-of-contents__link toc-highlight">• Variable arguments</a><li><a href=#-coercion-rules class="table-of-contents__link toc-highlight">• Coercion rules</a><li><a href=#-recursion class="table-of-contents__link toc-highlight">• Recursion</a><li><a href=#-forward-declarations class="table-of-contents__link toc-highlight">• Forward declarations</a><li><a href=#-state-classifiers class="table-of-contents__link toc-highlight">• State classifiers</a><li><a href=#-public-functions-function-main class="table-of-contents__link toc-highlight">• Public functions, function main</a><li><a href=#-static-functions class="table-of-contents__link toc-highlight">• Static functions</a><li><a href=#-stock-functions class="table-of-contents__link toc-highlight">• Stock functions</a><li><a href=#-native-functions class="table-of-contents__link toc-highlight">• Native functions</a><li><a href=#-user-defined-operators class="table-of-contents__link toc-highlight">• User-defined operators</a><li><a href=#-floating-point-and-fixed-point-arithmetic class="table-of-contents__link toc-highlight">• Floating point and fixed point arithmetic</a><li><a href=#-call-by-value-and-call-by-reference class="table-of-contents__link toc-highlight">• Call by Value and Call by Reference</a><li><a href=#-recursion--function-recursion class="table-of-contents__link toc-highlight">• Recursion / Function Recursion</a><li><a href=#stack-memory class="table-of-contents__link toc-highlight">Stack Memory</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>文档</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/zh-CN/docs>入门指南</a><li class=footer__item><a class=footer__link-item href=/zh-CN/docs>迁移至open.mp</a><li class=footer__item><a class=footer__link-item href=/zh-CN/docs/server/config.json>config.json</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>社区</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://discord.gg/samp target=_blank rel="noopener noreferrer" class=footer__link-item>Discord<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://github.com/openmultiplayer/open.mp target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://opencollective.com/openmultiplayer target=_blank rel="noopener noreferrer" class=footer__link-item>捐赠<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://youtube.com/openmultiplayer target=_blank rel="noopener noreferrer" class=footer__link-item>YouTube<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://x.com/openmultiplayer target=_blank rel="noopener noreferrer" class=footer__link-item>X<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>更多</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/zh-CN/servers>服务器</a><li class=footer__item><a class=footer__link-item href=/zh-CN/blog>博客</a><li class=footer__item><a class=footer__link-item href=/zh-CN/animations>动画</a><li class=footer__item><a class=footer__link-item href=/zh-CN/uid>UID生成器</a><li class=footer__item><a href=https://sa-mp.mp/ target=_blank rel="noopener noreferrer" class=footer__link-item>SA-MP<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=margin-bottom--sm><img src=/zh-CN/images/assets/logo.svg alt="open.mp logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src=/zh-CN/images/assets/logo.svg alt="open.mp logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></div><div class=footer__copyright>版权所有 © 2025 open.mp。基于Docusaurus构建</div></div></div></footer></div>