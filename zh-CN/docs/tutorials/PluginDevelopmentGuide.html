<!doctype html><html lang=zh-CN dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorials/PluginDevelopmentGuide" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.8.1"><title data-rh=true>插件开发指南 | open.mp</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:image content=https://open.mp/zh-CN/images/assets/wordmark-coloured-bg.png><meta data-rh=true name=twitter:image content=https://open.mp/zh-CN/images/assets/wordmark-coloured-bg.png><meta data-rh=true property=og:url content=https://open.mp/zh-CN/docs/tutorials/PluginDevelopmentGuide><meta data-rh=true property=og:locale content=zh_CN><meta data-rh=true property=og:locale:alternate content=en><meta data-rh=true property=og:locale:alternate content=es><meta data-rh=true property=og:locale:alternate content=ru><meta data-rh=true property=og:locale:alternate content=ar><meta data-rh=true property=og:locale:alternate content=bs><meta data-rh=true property=og:locale:alternate content=de><meta data-rh=true property=og:locale:alternate content=fil><meta data-rh=true property=og:locale:alternate content=fr><meta data-rh=true property=og:locale:alternate content=fa><meta data-rh=true property=og:locale:alternate content=hu><meta data-rh=true property=og:locale:alternate content=id><meta data-rh=true property=og:locale:alternate content=it><meta data-rh=true property=og:locale:alternate content=nl><meta data-rh=true property=og:locale:alternate content=pl><meta data-rh=true property=og:locale:alternate content=pt_BR><meta data-rh=true property=og:locale:alternate content=ro><meta data-rh=true property=og:locale:alternate content=sl><meta data-rh=true property=og:locale:alternate content=sr><meta data-rh=true property=og:locale:alternate content=ta><meta data-rh=true property=og:locale:alternate content=th><meta data-rh=true property=og:locale:alternate content=tr><meta data-rh=true property=og:locale:alternate content=vi><meta data-rh=true property=og:locale:alternate content=zh_TW><meta data-rh=true name=docusaurus_locale content=zh-CN><meta data-rh=true name=docsearch:language content=zh-CN><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="插件开发指南 | open.mp"><meta data-rh=true name=description content=关于插件开发的指南><meta data-rh=true property=og:description content=关于插件开发的指南><link data-rh=true rel=icon href=/zh-CN/favicon.ico><link data-rh=true rel=canonical href=https://open.mp/zh-CN/docs/tutorials/PluginDevelopmentGuide><link data-rh=true rel=alternate href=https://open.mp/docs/tutorials/PluginDevelopmentGuide hreflang=en><link data-rh=true rel=alternate href=https://open.mp/es/docs/tutorials/PluginDevelopmentGuide hreflang=es><link data-rh=true rel=alternate href=https://open.mp/ru/docs/tutorials/PluginDevelopmentGuide hreflang=ru><link data-rh=true rel=alternate href=https://open.mp/ar/docs/tutorials/PluginDevelopmentGuide hreflang=ar><link data-rh=true rel=alternate href=https://open.mp/bs/docs/tutorials/PluginDevelopmentGuide hreflang=bs><link data-rh=true rel=alternate href=https://open.mp/de/docs/tutorials/PluginDevelopmentGuide hreflang=de><link data-rh=true rel=alternate href=https://open.mp/fil/docs/tutorials/PluginDevelopmentGuide hreflang=fil><link data-rh=true rel=alternate href=https://open.mp/fr/docs/tutorials/PluginDevelopmentGuide hreflang=fr><link data-rh=true rel=alternate href=https://open.mp/fa/docs/tutorials/PluginDevelopmentGuide hreflang=fa><link data-rh=true rel=alternate href=https://open.mp/hu/docs/tutorials/PluginDevelopmentGuide hreflang=hu><link data-rh=true rel=alternate href=https://open.mp/id/docs/tutorials/PluginDevelopmentGuide hreflang=id><link data-rh=true rel=alternate href=https://open.mp/it/docs/tutorials/PluginDevelopmentGuide hreflang=it><link data-rh=true rel=alternate href=https://open.mp/nl/docs/tutorials/PluginDevelopmentGuide hreflang=nl><link data-rh=true rel=alternate href=https://open.mp/pl/docs/tutorials/PluginDevelopmentGuide hreflang=pl><link data-rh=true rel=alternate href=https://open.mp/pt-BR/docs/tutorials/PluginDevelopmentGuide hreflang=pt-BR><link data-rh=true rel=alternate href=https://open.mp/ro/docs/tutorials/PluginDevelopmentGuide hreflang=ro><link data-rh=true rel=alternate href=https://open.mp/sl/docs/tutorials/PluginDevelopmentGuide hreflang=sl><link data-rh=true rel=alternate href=https://open.mp/sr/docs/tutorials/PluginDevelopmentGuide hreflang=sr><link data-rh=true rel=alternate href=https://open.mp/ta/docs/tutorials/PluginDevelopmentGuide hreflang=ta><link data-rh=true rel=alternate href=https://open.mp/th/docs/tutorials/PluginDevelopmentGuide hreflang=th><link data-rh=true rel=alternate href=https://open.mp/tr/docs/tutorials/PluginDevelopmentGuide hreflang=tr><link data-rh=true rel=alternate href=https://open.mp/vi/docs/tutorials/PluginDevelopmentGuide hreflang=vi><link data-rh=true rel=alternate href=https://open.mp/zh-CN/docs/tutorials/PluginDevelopmentGuide hreflang=zh-CN><link data-rh=true rel=alternate href=https://open.mp/zh-TW/docs/tutorials/PluginDevelopmentGuide hreflang=zh-TW><link data-rh=true rel=alternate href=https://open.mp/docs/tutorials/PluginDevelopmentGuide hreflang=x-default><link data-rh=true rel=preconnect href=https://AOKXGK39Z7-dsn.algolia.net crossorigin=anonymous><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://open.mp/zh-CN/docs/tutorials/PluginDevelopmentGuide","name":"插件开发指南","position":1}]}</script><link rel=alternate type=application/rss+xml href=/zh-CN/blog/rss.xml title="open.mp RSS Feed"><link rel=alternate type=application/atom+xml href=/zh-CN/blog/atom.xml title="open.mp Atom Feed"><link rel=search type=application/opensearchdescription+xml title=open.mp href=/zh-CN/opensearch.xml><link rel=stylesheet href=/zh-CN/assets/css/styles.535380ff.css><script src=/zh-CN/assets/js/runtime~main.5b4618e0.js defer></script><script src=/zh-CN/assets/js/main.2d524f91.js defer></script><body class=navigation-with-keyboard><svg xmlns=http://www.w3.org/2000/svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light",e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><link rel=preload as=image href=/zh-CN/images/assets/logo-light-trans.svg><link rel=preload as=image href=/zh-CN/images/assets/logo.svg><div role=region aria-label=跳到主要内容><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>跳到主要内容</a></div><nav aria-label=主导航 class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label=切换导航栏 aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/zh-CN/><div class=navbar__logo><img src=/zh-CN/images/assets/logo-light-trans.svg alt="open.mp logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/zh-CN/images/assets/logo-light-trans.svg alt="open.mp logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Open Multiplayer</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/zh-CN/docs>文档</a><a class="navbar__item navbar__link" href=/zh-CN/blog>博客</a><a href=https://forum.open.mp/ target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">论坛</a><a class="navbar__item navbar__link" href=/zh-CN/servers>服务器</a><a class="navbar__item navbar__link" href=/zh-CN/partners>合作伙伴</a><a href=https://opencollective.com/openmultiplayer target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">捐赠<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>简体中文</a><ul class=dropdown__menu><li><a href=/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=en>English</a><li><a href=/es/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=es>Español</a><li><a href=/ru/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=ru>Русский</a><li><a href=/ar/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=ar>العربية</a><li><a href=/bs/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=bs>Bosanski</a><li><a href=/de/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=de>Deutsch</a><li><a href=/fil/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=fil>Filipino</a><li><a href=/fr/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=fr>Français</a><li><a href=/fa/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=fa>فارسی</a><li><a href=/hu/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=hu>Magyar</a><li><a href=/id/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=id>Indonesia</a><li><a href=/it/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=it>Italiano</a><li><a href=/nl/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=nl>Nederlands</a><li><a href=/pl/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=pl>Polski</a><li><a href=/pt-BR/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=pt-BR>Português (Brasil)</a><li><a href=/ro/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=ro>Română</a><li><a href=/sl/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=sl>Slovenščina</a><li><a href=/sr/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=sr>Српски</a><li><a href=/ta/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=ta>தமிழ்</a><li><a href=/th/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=th>ไทย</a><li><a href=/tr/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=tr>Türkçe</a><li><a href=/vi/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=vi>Tiếng Việt</a><li><a href=/zh-CN/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=zh-CN>简体中文</a><li><a href=/zh-TW/docs/tutorials/PluginDevelopmentGuide target=_self rel="noopener noreferrer" class=dropdown__link lang=zh-TW>繁體中文</a></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>搜索</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label=返回顶部 class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label=文档侧边栏 class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/zh-CN/docs>简介</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/zh-CN/docs/scripting/callbacks/OnActorStreamIn>Scripting</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/zh-CN/docs/server/CommonServerIssues>Server</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/zh-CN/docs/client/ClientCommands>Client</a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/zh-CN/docs/tutorials/AdvancedStructures>Tutorials</a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/tutorials/AdvancedStructures>高级数据结构</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/tutorials/Binary>二进制</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/tutorials/MenuGuide>菜单指南</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/tutorials/PickupGuide>拾取物指南</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/zh-CN/docs/tutorials/PluginDevelopmentGuide>插件开发指南</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/tutorials/PortForwarding>端口转发</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/tutorials/QueryMechanism>SA:MP 查询机制</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/tutorials/colorfix>颜色修复</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/tutorials/cooldowns>冷却时间</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/tutorials/servervariablesystem>服务器变量系统</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh-CN/docs/tutorials/stringmanipulation>字符串操作</a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/zh-CN/docs/awesome>Awesome</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/zh-CN/docs/changelog>更新日志</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/zh-CN/docs/meta/Contributing>meta</a></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=页面路径><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label=主页面 class=breadcrumbs__link href=/zh-CN/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Tutorials</span><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>插件开发指南</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>插件开发指南</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id=介绍>介绍<a href=#介绍 class=hash-link aria-label=介绍的直接链接 title=介绍的直接链接>​</a></h2>
<p>我决定创建这个主题来解决有关插件开发的常见问题和疑问. 虽然我并不是 C/++或插件 SDK 方面的专家, 但我会分享我在开发插件时所学到的东西. 希望这个主题完成后能够成为一个群体项目, 其他用户可以贡献一些我可能不知道或者忘记包含的信息. 要涵盖这么大的一个话题, 我需要一些帮助.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=这不是一个-c帮助论坛>这不是一个 C/++帮助论坛<a href=#这不是一个-c帮助论坛 class=hash-link aria-label="这不是一个 C/++帮助论坛的直接链接" title="这不是一个 C/++帮助论坛的直接链接">​</a></h2>
<p>人们在阅读这篇文章时似乎非常困惑. 我看到很多人在提出关于插件 SDK 的完全合理的问题时, 收到了大量的"这不是 C/++帮助论坛！"的回复. 仅仅因为人们被期望掌握这些语言, 并<strong>不</strong>意味着他们不能就实际的 SDK 提问！问"指针是什么"和问"如何创建回调函数"是有区别的！</p>
<p>话虽如此, 以下有一些优秀的网站和论坛专门用于教授和解答关于 C/++的问题. 我自己也使用过这些网站：</p>
<p>这些网站有很棒的教程供学习：</p>
<p>cprogramming.com</p>
<p>cplusplus.com</p>
<p>learncpp.com</p>
<p>如果你在 C/++问题上遇到困难, 你可以在以下论坛寻求帮助：</p>
<p>dreamincode.net</p>
<p>stackoverflow.com</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=常见问题>常见问题<a href=#常见问题 class=hash-link aria-label=常见问题的直接链接 title=常见问题的直接链接>​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=快速问答>快速问答<a href=#快速问答 class=hash-link aria-label=快速问答的直接链接 title=快速问答的直接链接>​</a></h3>
<p><strong>问题：</strong> 插件是如何制作的？</p>
<ul>
<li><strong>回答：</strong> 插件是用 C/++和插件 SDK 制作的. 本 FAQ 假设你已经了解 C/++, 稍后在文章中会提供一些关于实际 SDK 的信息.</li>
</ul>
<p><strong>问题：</strong> 我可以用 C/++以外的编程语言创建插件吗？</p>
<ul>
<li><strong>回答：</strong> 理论上是可能的. 曾经有人尝试将 SA-MP 插件 SDK 移植到支持 C 应用程序二进制接口的 D 编程语言. 虽然我从未见过一个完全工作的 D 语言插件, 但这个例子让我们看到使用支持 C/++的语言编写插件的可能性. 也有人讨论过绑定的可能性, 但我还没有看到任何实际的支持.</li>
</ul>
<p><strong>问题：</strong> 我如何让我的插件实现跨平台(在 Linux 和 Windows 上都可用)？</p>
<ul>
<li><strong>回答：</strong> Linux 和 Windows 是两个不同的操作系统, 它们各自有不同的 API 和实现. 让你的代码在这两种平台上都能运行意味着你必须使用与平台无关的代码, 或者使用某种框架来处理与平台相关的所有问题. 在确保你的代码不依赖于任何特定 API 后, 你只需在你所选择的环境中编译代码即可(再次说明, 本指南假设你知道如何做这些).</li>
</ul>
<p><strong>问题：</strong> 我的插件可以使用内存破解吗？</p>
<ul>
<li><strong>回答：</strong> 说实话, 这是一个灰色地带. 使用内存破解来挂钩回调或调用函数似乎是完全可以接受的. 而任何修改服务器内存的行为似乎都是不被允许的(参见此处). 如果你计划制作一个需要使用内存破解的插件(不只是用于挂钩回调或调用函数), 请提前申请并获得批准后再发布；这确实是找出答案的最佳方式！</li>
</ul>
<p><strong>问题：</strong> 能否制作一个**______**的插件？</p>
<ul>
<li><strong>回答：</strong> 在大多数情况下, 任何想法都是完全可以实现的. 它可能需要一个与插件通信的独立应用程序, 但大多数情况下是可以实现的. 像这样的提问<strong>不</strong>应该被发布. 你已经听到了答案, 现在继续吧！这不是一个插件请求区. 希望有一天会有足够多的插件开发者可以有一个专门的请求区或固定主题(本指南旨在介绍和帮助新的插件开发者, 所以让我们拭目以待).</li>
</ul>
<p><strong>问题：</strong> 我应该为**______**使用什么 IDE/编译器？</p>
<ul>
<li><strong>回答：</strong> 这完全取决于你自己！我个人在 Windows 下会使用 VC++ 2010 Express 作为我的 IDE 和编译器, 计划在 Linux 下使用 g++作为我的编译器. 试用不同的选项, 看看哪个最适合你！</li>
</ul>
<p><strong>问题：</strong> 什么是模块定义文件(.def)？</p>
<ul>
<li><strong>回答：</strong> 模块定义文件是 Visual Studio IDE 中的一个特殊文件, 它为链接器提供有关正在链接的程序的信息. 在为 SA-MP 编写插件时, 我们通常只使用"EXPORTS"语句, 它提供了有关我们导出函数的信息. 我们将在文章的后面部分讨论这个语句.</li>
</ul>
<p><strong>问题：</strong> 当我发布一个插件时, 是否必须包含源代码？</p>
<ul>
<li><strong>回答：</strong> 如果你在这个论坛上发布任何东西, 它<strong>总是</strong>必须包含源代码. 插件也不例外(除非插件被开发者批准可以不附带源代码发布——比如反作弊插件).</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=入门>入门<a href=#入门 class=hash-link aria-label=入门的直接链接 title=入门的直接链接>​</a></h2>
<p>你可能会惊讶于我被问到"如何开始插件开发？"的次数之多. 因此, 我决定专门增加这一整个章节来解答这个问题！仅仅知道编程语言并不意味着你了解 IDE 的使用, 尤其是在使用 VC++ 2010 时. 对于新用户来说, Visual Studio 可能是一个非常令人生畏的环境. 我觉得直接给你插件 SDK 而不先带你熟悉环境是不公平的！弄错了属性页或链接器设置可能会轻易吓跑新手, 所以我会引导你完成这些步骤.</p>
<p><strong>注意：</strong> 如果你选择使用其他针对 Windows 的 IDE/编译器, 那你可能会遇到麻烦！看起来唯一能够成功导出函数的方法是使用模块定义文件(.DEF). 我尝试在本文中包含一种使用 __declspec(dllexport) 的替代方法, 但由于 __stdcall 调用约定会改变导出函数的名称, 这种方法并未成功 (参见: <a href=https://pastebin.com/y3xkVY70 target=_blank rel="noopener noreferrer">此处</a>).</p>
<p>以下是本节中你需要下载的内容：</p>
<p><strong>Visual C++ 2010 Express:</strong> <a href=https://visualstudio.microsoft.com/vs/express/ target=_blank rel="noopener noreferrer">免费下载</a></p>
<p><strong>插件 SDK (Plain):</strong> <a href=https://github.com/maddinat0r/samp-plugin-sdk target=_blank rel="noopener noreferrer">下载</a></p>
<ul>
<li>
<p>我们首先需要做的是创建一个新项目. 选择文件->新建->项目来创建.</p>
</li>
<li>
<p>创建新项目后, 它会询问你正在创建的项目类型. 选择 Win32 项目, 输入项目名称, 然后点击 OK 继续.</p>
</li>
<li>
<p>设置项目后, 应该会出现这个对话框. 按下"下一步"继续.</p>
</li>
<li>
<p>点击"继续"后, 你应该会看到这个弹出对话框, 询问应用程序类型和设置. 对于类型, 选择 DLL(动态链接库), 对于设置, 选择"空项目". 完成后, 点击底部的完成按钮.</p>
</li>
<li>
<p>接下来我们需要进入解决方案资源管理器. 解决方案资源管理器通常在 IDE 的左侧. 如果你不小心禁用了它, 可以通过按下 CTRL+ALT+L 或选择视图->其他窗口->解决方案资源管理器重新启用. 一旦找到解决方案资源管理器, 右键点击项目名称(在此例中为"Test")并选择属性.</p>
</li>
<li>
<p>在属性页中, 导航到配置属性->链接器->输入. 到达此处后, 你需要添加一个模块定义文件. 你可以随意命名这个文件, 只要它的扩展名是".def"；人们通常用项目名称命名 def 文件. 命名好定义文件后, 按下 OK.</p>
</li>
<li>
<p>现在我们只需添加我们的文件(包括定义文件). 要将文件添加到项目中, 再次导航到解决方案资源管理器, 右键点击项目名称, 选择添加, 然后选择新建项. 在此示例中, 我们将添加我们的定义文件. 由于没有定义文件的选项, 只需选择源文件(.cpp)并输入你决定的模块定义文件名称(注意：确保包含".def"扩展名, 否则将会添加".cpp"扩展名). 完成此操作后, 以相同方式添加项目的源文件(但不添加扩展名). 大多数人将他们的主源文件命名为"Main".</p>
</li>
<li>
<p>在开始向两个空文件中添加任何内容之前, 我们需要将 SDK 添加到项目中. 如果你还没有下载, 可以通过本节开始时提供的链接下载 SDK. 下载完成后, 将 SDK 文件夹解压到当前项目目录中. 注意, 这部分是可选的：我个人喜欢创建过滤器来组织所有文件和代码. 过滤器是 Visual Studio 中的一种组织工具, 它会在项目中创建文件夹, 但不会在 Windows 中创建相应的文件夹(建议创建对应的 Windows 文件夹). 要创建过滤器, 右键点击解决方案资源管理器中的项目->添加->新建过滤器并选择过滤器名称(在此例中命名为 SDK).</p>
</li>
<li>
<p>下一步是将所有 SDK 文件添加到当前项目中. 要将现有文件添加到项目中, 只需右键点击你希望添加到的文件夹或项目, 然后选择添加->现有项. 你需要将项目目录中 SDK 文件夹内的所有内容添加进去(注意：你可以通过按住 Ctrl 键并点击文件来选择多个文件). 为了保持文件夹一致性, 我们将在 SDK 过滤器内创建另一个过滤器, 并将其命名为 amx. 当然, 你需要将 SDK\amx\文件夹中的所有内容添加到 amx 过滤器中.</p>
</li>
</ul>
<p>现在是时候编译这个插件了！如果你正确遵循了说明, 应该已经打开了模块定义文件和源文件；如果没有, 请返回几步并仔细按照说明操作. 接下来将以下信息复制并粘贴到对应的文件中. 如果不理解其中的内容也不要担心, 我们将在下一节中详细讲解.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=源文件-cpp>源文件 (*.cpp)<a href=#源文件-cpp class=hash-link aria-label="源文件 (*.cpp)的直接链接" title="源文件 (*.cpp)的直接链接">​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property string" style=color:#e3116c>"SDK\amx\amx.h"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property string" style=color:#e3116c>"SDK\plugincommon.h"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>typedef</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>void</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">logprintf_t</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>char</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> format</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">logprintf_t logprintf</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>extern</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>void</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">pAMXFunctions</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>HelloWorld</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>logprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"这是从测试插件中打印出来的!"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">PLUGIN_EXPORT </span><span class="token keyword" style=color:#00009f>unsigned</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> PLUGIN_CALL </span><span class="token function" style=color:#d73a49>Supports</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> SUPPORTS_VERSION </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> SUPPORTS_AMX_NATIVES</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">PLUGIN_EXPORT </span><span class="token keyword" style=color:#00009f>bool</span><span class="token plain"> PLUGIN_CALL </span><span class="token function" style=color:#d73a49>Load</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>void</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">ppData</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    pAMXFunctions </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ppData</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PLUGIN_DATA_AMX_EXPORTS</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    logprintf </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">logprintf_t</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> ppData</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PLUGIN_DATA_LOGPRINTF</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>logprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>" * 测试插件已加载."</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>true</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">PLUGIN_EXPORT </span><span class="token keyword" style=color:#00009f>void</span><span class="token plain"> PLUGIN_CALL </span><span class="token function" style=color:#d73a49>Unload</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>logprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>" * 测试插件已卸载."</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">AMX_NATIVE_INFO PluginNatives</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"HelloWorld"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> HelloWorld</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">PLUGIN_EXPORT </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> PLUGIN_CALL </span><span class="token function" style=color:#d73a49>AmxLoad</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"> AMX </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_Register</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> PluginNatives</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">PLUGIN_EXPORT </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> PLUGIN_CALL </span><span class="token function" style=color:#d73a49>AmxUnload</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"> AMX </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> AMX_ERR_NONE</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=模块定义文件def>模块定义文件(*.def)<a href=#模块定义文件def class=hash-link aria-label=模块定义文件(*.def)的直接链接 title=模块定义文件(*.def)的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">EXPORTS</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      Supports</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      Load</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      Unload</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      AmxLoad</span><br></span><span class=token-line style=color:#393A34><span class="token plain">      AmxUnload</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=代码分析>代码分析<a href=#代码分析 class=hash-link aria-label=代码分析的直接链接 title=代码分析的直接链接>​</a></h2>
<p>在本节中, 我们将查看 SA-MP 插件 SDK 提供的一些定义、结构和函数. 在继续之前, 你应该对 C/C++ 有一定的了解, 因为接下来的内容将<strong>仅</strong>解释 SDK 相关的信息. 从现在开始, 不会再有详细指导！</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=模块定义文件>模块定义文件<a href=#模块定义文件 class=hash-link aria-label=模块定义文件的直接链接 title=模块定义文件的直接链接>​</a></h3>
<p>在查看代码之前, 我们先来看一下我们在前一节中创建的模块定义文件. 首先, 什么是模块定义文件？我们知道它是 Visual Studio 专有的功能, 但它到底是做什么的？很简单！模块定义文件向链接器提供关于要链接的代码的信息. 这些文件中有许多规则和语句可以使用, 但我们只讨论一个, 即 EXPORTS 语句.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=什么是-exports>什么是 "<strong>EXPORTS</strong>"<a href=#什么是-exports class=hash-link aria-label=什么是-exports的直接链接 title=什么是-exports的直接链接>​</a></h4>
<p>Exports 是一个声明, 它允许我们……好吧, 导出一些东西到我们的应用程序！为什么我们要这样做？因为我们必须这样做, 就是这么简单. 我们导出的函数是 DLL 文件中的入口点. 应用程序只能访问我们导出的 DLL 函数；如果我们不导出它们, 它们将保持私有, 不能被外部访问. 我们不想这样, 对吧？不. 所以我们导出应用程序将直接访问的所有内容.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=导出的函数>导出的函数<a href=#导出的函数 class=hash-link aria-label=导出的函数的直接链接 title=导出的函数的直接链接>​</a></h4>
<p>目前需要导出的函数有 6 个. 我们在项目中使用了其中 5 个. 不要担心你在函数声明中看到的 <code>PLUGIN_EXPORT</code> 和 <code>PLUGIN_CALL</code> 定义. 我们将在文章后面介绍这些以及其他一些重要的定义(标记为绿色文本).</p>
<table><thead><tr><th>函数<th>说明<tbody><tr><td><strong>Supports()</strong><td>这个函数告诉服务器我们的插件将具备哪些功能, 基于它返回的内容. 通常我们在插件中只使用 3 个支持标志：<strong>SUPPORTS_VERSION</strong>、<strong>SUPPORTS_AMX_NATIVES</strong> 和 <strong>SUPPORTS_PROCESS_TICK</strong>.<tr><td><strong>Load(void**)</strong><td>Load 函数是相当简单的. 它在插件被加载时调用, 并传递一个地址数组, 插件将用来执行功能. 我们通常使用的两个索引是 <strong>PLUGIN_DATA_AMX_EXPORTS</strong> 和 <strong>PLUGIN_DATA_LOGPRINTF</strong>.<tr><td><strong>Unload()</strong><td>Unload 在插件卸载时调用(服务器关闭时).<tr><td><strong>AmxLoad(AMX*)</strong><td>当一个新的 AMX 实例被加载到服务器中时调用这个函数. 这将对每个过滤脚本/游戏模式调用！因此, 最好不要为整个插件存储单个 AMX 实例, 而是使用队列/列表/向量. 在这个函数中, 我们还注册我们希望提供给 PAWN 的自定义原生函数.<tr><td><strong>AmxUnload(AMX*)</strong><td>当 AMX 实例被卸载时调用这个函数. 如果你存储 AMX 实例, 请确保将其删除. 否则, 你会有指向不存在的游戏模式/过滤脚本的实例.<tr><td><strong>ProcessTick()</strong><td>ProcessTick 是一个在服务器循环的每次迭代时调用的函数. 人们通常使用这个函数来通过跟踪经过的 ticks 数量来管理时间. SA-MP 服务器的休眠时间为 5ms, 所以如果 50 个 ticks 过去, 你就有了经过的时间的一个大致了解(5 * 50 = 250ms). **注意：**任何在插件中使用线程并且需要 PAWN 交互的用户都需要使用这个函数, 以确保 PAWN 不忙于其他任务！</table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=定义和结构>定义和结构<a href=#定义和结构 class=hash-link aria-label=定义和结构的直接链接 title=定义和结构的直接链接>​</a></h3>
<p>现在来看看代码的有趣部分！你可能会发现我们在前面的小例子中使用了大量的定义和结构. 如果你之前从未开发过 SA-MP 插件, 这些可能会显得非常混乱甚至令人生畏. 我们将在本节中阐明这些定义和结构.</p>
<table><thead><tr><th>定义/结构<th>说明<tbody><tr><td><strong>cell</strong><td>"cell" 是一个 typedef, 旨在提供可移植性. PAWN 支持 16 位、32 位和 64 位整数. typedef "cell" 始终是正确的大小, 而 "int" 可能不是. 通常在 SA-MP 插件中, 这个 typedef 始终是 32 位整数. <strong>注意：</strong> 还有一个 "ucell" typedef 用于无符号整数, 但几乎不使用.<tr><td><strong>AMX_NATIVE_CALL</strong><td>这个定义了我们的原生函数将使用的调用约定. 目前它被定义为空, 因此将使用默认值.<tr><td><strong>AMX</strong><td>这个结构的名称应该很清楚, 它是一个 AMX 实例. 这个结构包含了大量与数据段以及其他 AMX 相关的信息. 所有原生函数声明中必须包含这个结构以及一个指向传递参数的 cell 指针；没有这些信息, 我们不知道哪个脚本调用了我们的原生函数, 也不知道传递了什么参数.<tr><td><strong>PLUGIN_EXPORT</strong><td>这个定义为 "PLUGIN_EXTERN_C".<tr><td><strong>PLUGIN_EXTERN_C</strong><td>如果使用 C++ 编译器, 这个定义为 "extern "C"". 这是为了与 C 的兼容性. C++ 提供了像函数重载这样的功能, 因此额外的信息如参数的数量/大小会与函数的名称一起存储, 这被称为 "name mangling"(名称修饰). 当使用这个定义时, 它告诉 C++ 使用 C 风格的链接, 从而避免 C++ 名称修饰.<tr><td><strong>PLUGIN_CALL</strong><td>这个定义告诉 C/C++ 我们导出的函数使用什么调用约定. 如果你使用的是针对 Windows 的编译器, 这个定义为 __stdcall. 否则, 它的定义为空, 使用默认调用约定.<tr><td><strong>SUPPORTS_VERSION</strong><td>这个定义用于在 "Supports()" 函数返回的位掩码中使用. 这个标志用于检查与服务器的兼容性.<tr><td><strong>SUPPORTS_AMX_NATIVES</strong><td>这是另一个在 "Supports()" 函数中使用的定义. 任何使用 AMX 函数的插件都必须使用这个标志！如果没有这个标志, 你将会遇到运行时 19 错误, 因为你的原生函数没有注册到服务器(amx_Register).<tr><td><strong>SUPPORTS_PROCESS_TICK</strong><td>我们在 "Supports()" 函数中的最后一个标志. 如果你打算使用 "ProcessTick()" 函数, 你必须将这个标志添加到 "Supports()" 函数返回的位掩码中.<tr><td><strong>PLUGIN_DATA_AMX_EXPORTS</strong><td>这个定义用作 Load 函数中传递的多维数组的索引. 这个特定的索引包含 AMX 函数表. 所有插件必须使用这个索引将函数表的地址分配给 pAMXFunctions.<tr><td><strong>PLUGIN_DATA_LOGPRINTF</strong><td>另一个用于 Load 函数中传递的多维数组的索引. 这个索引包含 logprintf 函数的地址, 这个函数打印信息并将这些信息保存到服务器的日志文件中. 如果你的插件使用这个函数, 你必须使用这个索引将地址分配给 logprintf 函数指针.<tr><td><strong>AMX_NATIVE_INFO</strong><td>这个结构与 amx_Register 一起使用. 它包含一个字符串, 保存你的新原生函数的名称, 以及指向它地址的指针.</table>
<p>还有一些其他重要的定义涉及 AMX 函数错误, 但它们已经在 amx 头文件中进行了记录. 因此, 我将直接发布包含所有错误代码及其对应注释的枚举. <strong>注意：</strong> 每个 amx 函数(除了 amx_NativeInfo)在遇到问题时都会返回这些错误代码中的一个.</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>enum</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_NONE</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>/* 为抽象机器的退出码保留前15个错误代码 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_EXIT</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">         </span><span class="token comment" style=color:#999988;font-style:italic>/* 强制退出 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_ASSERT</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">       </span><span class="token comment" style=color:#999988;font-style:italic>/* 断言失败 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_STACKERR</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">     </span><span class="token comment" style=color:#999988;font-style:italic>/* 栈/堆冲突 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_BOUNDS</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">       </span><span class="token comment" style=color:#999988;font-style:italic>/* 索引超出范围 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_MEMACCESS</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>/* 无效的内存访问 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_INVINSTR</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">     </span><span class="token comment" style=color:#999988;font-style:italic>/* 无效的指令 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_STACKLOW</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">     </span><span class="token comment" style=color:#999988;font-style:italic>/* 栈下溢 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_HEAPLOW</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>/* 堆下溢 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_CALLBACK</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">     </span><span class="token comment" style=color:#999988;font-style:italic>/* 无回调或无效回调 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_NATIVE</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">       </span><span class="token comment" style=color:#999988;font-style:italic>/* 本地函数失败 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_DIVIDE</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">       </span><span class="token comment" style=color:#999988;font-style:italic>/* 除零错误 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_SLEEP</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>/* 进入休眠模式 - 代码可以重新启动 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_INVSTATE</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">     </span><span class="token comment" style=color:#999988;font-style:italic>/* 对于此访问的无效状态 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_MEMORY </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>16</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">  </span><span class="token comment" style=color:#999988;font-style:italic>/* 内存不足 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_FORMAT</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">       </span><span class="token comment" style=color:#999988;font-style:italic>/* 文件格式无效 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_VERSION</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>/* 文件适用于更新版本的AMX */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_NOTFOUND</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">     </span><span class="token comment" style=color:#999988;font-style:italic>/* 未找到函数 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_INDEX</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>/* 无效的索引参数(错误的入口点) */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_DEBUG</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>/* 调试器无法运行 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_INIT</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">         </span><span class="token comment" style=color:#999988;font-style:italic>/* AMX未初始化(或重复初始化) */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_USERDATA</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">     </span><span class="token comment" style=color:#999988;font-style:italic>/* 无法设置用户数据字段(表格已满) */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_INIT_JIT</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">     </span><span class="token comment" style=color:#999988;font-style:italic>/* 无法初始化JIT */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_PARAMS</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">       </span><span class="token comment" style=color:#999988;font-style:italic>/* 参数错误 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_DOMAIN</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">       </span><span class="token comment" style=color:#999988;font-style:italic>/* 域错误, 表达式结果超出范围 */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">  AMX_ERR_GENERAL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">      </span><span class="token comment" style=color:#999988;font-style:italic>/* 一般错误(未知或不具体的错误) */</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx-函数>Amx 函数<a href=#amx-函数 class=hash-link aria-label="Amx 函数的直接链接" title="Amx 函数的直接链接">​</a></h2>
<p>amx 函数在 PAWN 实施者指南中有非常详细的文档, 可以在这里找到. 为了避免重复解释这些函数, 我将直接从实施者指南中复制它们, 并使其更具可读性；我相信这将使内容更易于访问. 也就是说, 本节主要是下一节的参考, 下一节专注于实施者指南中缺少的内容：示例代码. 注意：我将仅覆盖我认为对插件至关重要的函数(目前). 其他内容可以在实施者指南中找到, 只需确保使用我在本节中链接的版本！</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=关键>关键<a href=#关键 class=hash-link aria-label=关键的直接链接 title=关键的直接链接>​</a></h3>
<p>+ => 不可用</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx_allot>amx_Allot<a href=#amx_allot class=hash-link aria-label=amx_Allot的直接链接 title=amx_Allot的直接链接>​</a></h2>
<p>- 在抽象机器中保留堆空间</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=语法>语法<a href=#语法 class=hash-link aria-label=语法的直接链接 title=语法的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_Allot</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> cells</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx_addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">phys_addr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<table><thead><tr><th>参数<th>说明<tbody><tr><td><strong>amx</strong><td>抽象机器.<tr><td><strong>cells</strong><td>要保留的单元格数量.<tr><td><strong>amx_addr</strong><td>分配的单元格的地址, 供 PAWN 程序(在抽象机器中运行)访问.<tr><td><strong>phys_addr</strong><td>单元格的地址, 供 C/C++程序访问.</table>
<p><strong>说明：</strong> 在早期版本的 PAWN 中, 数组和字符串必须在将其传递给脚本之前明确地为其分配内存. 在当前版本中, 这一功能已被 amx_PushArray 和 amx_PushString 函数在很大程度上取代. PAWN 函数只能访问其抽象机器内部的内存. 如果要"按引用"传递参数到 PAWN 函数, 必须将该参数的地址传递给 amx_Exec. 此外, 该地址本身也必须在抽象机器的地址范围内. 一个额外的复杂性是, 抽象机器使用相对于抽象机器数据段的地址, 而主机程序使用相对于操作系统提供的环境的地址.</p>
<p>amx_Allot 在抽象机器内部分配内存单元, 并返回两个地址. amx_addr 参数是相对于抽象机器的"数据段"的变量地址；这是你应该传递给 amx_Exec 的值(通过 amx_Push). 参数 phys_addr 持有相对于主机程序地址空间的地址. 因此, C/C++程序可以使用此地址并写入分配的内存. amx_Exec 返回后, 你可以检查内存块(amx_Exec 调用的 PAWN 函数可能已经写入其中), 然后通过调用 amx_Release 最终释放它.</p>
<p><strong>另请参见：</strong> <a href=#amx_exec>amx_Exec</a>, <a href=#amx_pusharray>amx_PushArray</a>, <a href=#amx_pushstring>amx_PushString</a>, <a href=#amx_release>amx_Release</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx_ctof>amx_ctof<a href=#amx_ctof class=hash-link aria-label=amx_ctof的直接链接 title=amx_ctof的直接链接>​</a></h2>
<p>- 将"cell"转换为"float"</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=语法-1>语法<a href=#语法-1 class=hash-link aria-label=语法的直接链接 title=语法的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>float</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_ctof</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">cell</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> c</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<table><thead><tr><th>参数<th>说明<tbody><tr><td><strong>c</strong><td>要从"cell"类型转换为"float"的值.</table>
<p><strong>返回：</strong> 相同的位模式, 但现在为浮点类型.</p>
<p><strong>说明：</strong> 此宏将"cell"类型转换为"float"类型, 而不更改位模式. 在 C/C++中, 正常的类型转换会更改表达式的内存表示, 使其在 IEEE 754 格式中的数值最接近原始整数值. PAWN 解析器和抽象机器将浮点值存储在单元格中——从单元格中检索浮点值时, 位模式不得更改.</p>
<p><strong>另请参见：</strong> <a href=#amx_ftoc>amx_ftoc</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx_exec>amx_Exec<a href=#amx_exec class=hash-link aria-label=amx_Exec的直接链接 title=amx_Exec的直接链接>​</a></h2>
<p>- 执行代码</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=语法-2>语法<a href=#语法-2 class=hash-link aria-label=语法的直接链接 title=语法的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">  </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_Exec</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>long</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">retval</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> index</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<table><thead><tr><th>参数<th>说明<tbody><tr><td><strong>amx</strong><td>从中调用函数的抽象机器.<tr><td><strong>retval</strong><td>调用函数后的返回值将保存在此处. 如果不关心返回值, 此参数可以为 NULL.<tr><td><strong>index</strong><td>"公共函数表"中的索引；它指示要执行的函数. 有关更多信息, 请参见 amx_FindPublic. 使用 AMX_EXEC_MAIN 从主函数开始执行, 使用 AMX_EXEC_CONT 继续从"休眠状态"执行.</table>
<p><strong>说明：</strong> 此函数运行脚本, 从指定的函数开始. 它调用任何本地函数调用的回调函数, 该代码在 amx 中执行. amx_Exec 假定所有本地函数都已通过 amx_Register 正确初始化.</p>
<p><strong>另请参见：</strong> <a href=#amx_findpublic>amx_FindPublic</a>, <a href=#amx_register>amx_Register</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx_findpublic>amx_FindPublic<a href=#amx_findpublic class=hash-link aria-label=amx_FindPublic的直接链接 title=amx_FindPublic的直接链接>​</a></h2>
<p>- 返回公共函数的索引</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=语法-3>语法<a href=#语法-3 class=hash-link aria-label=语法的直接链接 title=语法的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_FindPublic</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>char</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">funcname</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">index</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<table><thead><tr><th>参数<th>说明<tbody><tr><td><strong>amx</strong><td>抽象机器.<tr><td><strong>funcname</strong><td>要查找的公共函数的名称.<tr><td><strong>index</strong><td>返回时, 此参数保存所请求的公共函数的索引.</table>
<p><strong>另请参见：</strong> <a href=#amx_exec>amx_Exec</a>, amx_FindNative+, amx_FindPubVar+, amx_GetPublic+, amx_NumPublics+</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx_ftoc>amx_ftoc<a href=#amx_ftoc class=hash-link aria-label=amx_ftoc的直接链接 title=amx_ftoc的直接链接>​</a></h2>
<p>- 将"float"转换为"cell"</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=语法-4>语法<a href=#语法-4 class=hash-link aria-label=语法的直接链接 title=语法的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">cell</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_ftoc</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>float</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> f</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<table><thead><tr><th>参数<th>说明<tbody><tr><td><strong>f</strong><td>要从"float"类型转换为"cell"的值.</table>
<p><strong>返回：</strong> 相同的位模式, 但现在为"cell"类型.</p>
<p><strong>说明：</strong> 此宏将"float"类型转换为"cell"类型, 而不更改位模式. 在 C/C++中, 正常的类型转换会更改表达式的内存表示, 使其在整数格式中的数值为原始有理值的整数(截断)值. PAWN 解析器和抽象机器将浮点值存储在单元格中——将浮点值存储在单元格中时, 位模式不得更改.</p>
<p><strong>另请参见：</strong> <a href=#amx_ctof>amx_ctof</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx_getaddr>amx_GetAddr<a href=#amx_getaddr class=hash-link aria-label=amx_GetAddr的直接链接 title=amx_GetAddr的直接链接>​</a></h2>
<p>- 解析 AMX 地址</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=语法-5>语法<a href=#语法-5 class=hash-link aria-label=语法的直接链接 title=语法的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_GetAddr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell amx_addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">phys_addr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<table><thead><tr><th>参数<th>说明<tbody><tr><td><strong>amx</strong><td>抽象机器.<tr><td><strong>amx_addr</strong><td>相对于抽象机器的地址.<tr><td><strong>phys_addr</strong><td>一个指向变量的指针, 该变量将保存指定单元格的内存地址. 如果 amx_addr 参数不是抽象机器内部的有效地址, phys_addr 将被设置为 NULL.</table>
<p><strong>说明：</strong> 此函数返回抽象机器中地址的内存地址. 通常在扩展模块中使用此函数, 因为它允许你访问抽象机器内部的变量.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx_getstring>amx_GetString<a href=#amx_getstring class=hash-link aria-label=amx_GetString的直接链接 title=amx_GetString的直接链接>​</a></h2>
<p>- 从抽象机器中检索字符串</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=语法-6>语法<a href=#语法-6 class=hash-link aria-label=语法的直接链接 title=语法的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_GetString</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>char</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">dest</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">source</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> use_wchar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> size_t size</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<table><thead><tr><th>参数<th>说明<tbody><tr><td><strong>dest</strong><td>指向字符数组的指针, 该数组的大小足以容纳转换后的源字符串.<tr><td><strong>source</strong><td>指向源字符串的指针. 使用 amx_GetAddr 将 amx 中的字符串地址转换为物理地址.<tr><td><strong>use_wchar</strong><td>非零值将 dest 参数解释为指向"宽字符"的指针——即 wchar_t, 无论其 char 类型如何. 这允许函数存储 Unicode 字符串.<tr><td><strong>size</strong><td>要存储在 dest 中的最大字符数, 包括终止零字节. 如果源中的字符串更长, 则 dest 中的字符串将被截断.</table>
<p><strong>备注：</strong> 此函数将"pawn"格式的打包字符串和未打包字符串转换为"C"格式. 当检索未打包字符串且参数 use_wchar 设置为零时, 函数可能会将宽字符截断为 8 位 ASCII/ANSI 字符.</p>
<p><strong>另见：</strong> <a href=#amx_setstring>amx_SetString</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx_push>amx_Push<a href=#amx_push class=hash-link aria-label=amx_Push的直接链接 title=amx_Push的直接链接>​</a></h2>
<p>- 通过值传递数字参数</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=语法-7>语法<a href=#语法-7 class=hash-link aria-label=语法的直接链接 title=语法的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_Push</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell value</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<table><thead><tr><th>参数<th>说明<tbody><tr><td><strong>amx</strong><td>抽象机器.<tr><td><strong>value</strong><td>要传递给公共函数的值.</table>
<p><strong>备注：</strong> 任何参数必须在调用 amx_Exec 之前推送到函数. 如果公共函数有多个参数, 必须以相反的顺序推送参数.</p>
<p><strong>另见：</strong> <a href=#amx_exec>amx_Exec</a>, <a href=#amx_pusharray>amx_PushArray</a>, <a href=#amx_pushstring>amx_PushString</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx_pusharray>amx_PushArray<a href=#amx_pusharray class=hash-link aria-label=amx_PushArray的直接链接 title=amx_PushArray的直接链接>​</a></h2>
<p>- 通过引用传递参数或数组</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=语法-8>语法<a href=#语法-8 class=hash-link aria-label=语法的直接链接 title=语法的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_PushArray</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx_addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">phys_addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> cell array</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> numcells</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<table><thead><tr><th>参数<th>说明<tbody><tr><td><strong>amx</strong><td>抽象机器.<tr><td><strong>amx_addr</strong><td>分配的单元格的地址, pawn 程序(在抽象机器中运行)可以访问该地址, 需要释放内存块. 此参数可以为 NULL.<tr><td><strong>phys_addr</strong><td>C/C++ 程序访问的单元格的地址. 此参数可以为 NULL.<tr><td><strong>array</strong><td>要传递给公共函数的值数组. 必须通过引用传递的单个单元格被视为单个单元格数组.<tr><td><strong>numcells</strong><td>数组中的元素数量.</table>
<p><strong>备注：</strong> 任何参数必须在调用 amx_Exec 之前推送到函数. 如果公共函数有多个参数, 必须以相反的顺序推送参数. 此函数在抽象机器的"堆"中分配数组内存. 此内存必须使用 amx_Release 释放. 有关参数 amx_addr 和 phys_addr 的详细信息, 请参见函数 amx_Allot.</p>
<p><strong>另见：</strong> <a href=#amx_exec>amx_Exec</a>, <a href=#amx_push>amx_Push</a>, <a href=#amx_pushstring>amx_PushString</a>, <a href=#amx_release>amx_Release</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx_pushstring>amx_PushString<a href=#amx_pushstring class=hash-link aria-label=amx_PushString的直接链接 title=amx_PushString的直接链接>​</a></h2>
<p>- 传递字符串参数</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=语法-9>语法<a href=#语法-9 class=hash-link aria-label=语法的直接链接 title=语法的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_PushString</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx_addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">phys_addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>char</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">string</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> pack</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> use_wchar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<table><thead><tr><th>参数<th>说明<tbody><tr><td><strong>amx</strong><td>抽象机器.<tr><td><strong>amx_addr</strong><td>分配的单元格的地址, pawn 程序(在抽象机器中运行)可以访问该地址, 释放内存块需要此参数. 此参数可以为 NULL.<tr><td><strong>phys_addr</strong><td>C/C++ 程序访问的单元格的地址. 此参数可以为 NULL.<tr><td><strong>string</strong><td>要传递给公共函数的字符串.<tr><td><strong>pack</strong><td>非零值将源字符串转换为抽象机器中的打包字符串, 零值将源字符串转换为单元格字符串.<tr><td><strong>use_wchar</strong><td>非零值将字符串参数解释为指向"宽字符"的指针, 即 wchar_t, 无论其 char 类型如何. 这允许函数接受 Unicode 字符串.</table>
<p><strong>备注：</strong> 任何参数必须在调用 amx_Exec 之前推送到函数. 如果公共函数有多个参数, 必须以相反的顺序推送参数. 此函数在抽象机器的"堆"中分配内存. 此内存必须使用 amx_Release 释放. 有关参数 amx_addr 和 phys_addr 的详细信息, 请参见函数 amx_Allot. 当传入 Unicode 字符串并请求抽象机器中的打包格式(即 pack 和 use_wchar 都为 true)时, 字符将被截断为 8 位.</p>
<p><strong>另见：</strong> <a href=#amx_exec>amx_Exec</a>, <a href=#amx_push>amx_Push</a>, <a href=#amx_pusharray>amx_PushArray</a>, <a href=#amx_release>amx_Release</a>, <a href=#amx_setstring>amx_SetString</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx_register>amx_Register<a href=#amx_register class=hash-link aria-label=amx_Register的直接链接 title=amx_Register的直接链接>​</a></h2>
<p>- 使本地函数可知</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=语法-10>语法<a href=#语法-10 class=hash-link aria-label=语法的直接链接 title=语法的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_Register</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> AMX NATIVE INFO </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">list</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> number</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<table><thead><tr><th>参数<th>说明<tbody><tr><td><strong>amx</strong><td>抽象机器.<tr><td><strong>list</strong><td>结构数组, 每个结构包含一个指向本地函数名称的指针和一个函数指针. 列表可以用两个 NULL 指针的结构可选地终止.<tr><td><strong>number</strong><td>列表数组中的结构数量, 或 -1 如果列表以包含两个 NULL 指针的结构结束.</table>
<p><strong>备注：</strong> 成功时, 此函数返回 0(AMX_ERR_NONE). 如果此函数返回错误代码 AMX_ERR_NOTFOUND, 则表示在提供的列表中找不到一个或多个由 pawn 程序使用的本地函数. 可以再次调用 amx_Register 来注册额外的函数列表.</p>
<p>要检查编译脚本中使用的所有本地函数是否已注册, 可以将参数 list 设置为 NULL 调用 amx_Register. 此调用不会注册任何新的本地函数, 但如果有任何本地函数未注册, 则仍会返回 AMX_ERR_NOTFOUND.</p>
<p><strong>另见：</strong> amx_NativeInfo+</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx_release>amx_Release<a href=#amx_release class=hash-link aria-label=amx_Release的直接链接 title=amx_Release的直接链接>​</a></h2>
<p>- 释放抽象机器中的堆空间</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=语法-11>语法<a href=#语法-11 class=hash-link aria-label=语法的直接链接 title=语法的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_Release</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell amx_addr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<table><thead><tr><th>参数<th>说明<tbody><tr><td><strong>amx</strong><td>抽象机器.<tr><td><strong>amx_addr</strong><td>分配的单元格的地址, pawn 程序(在抽象机器中运行)看到的地址. 此值由 amx_Allot、amx_PushArray 和 amx_PushString 返回.</table>
<p><strong>备注：</strong> amx_Allot 按升序在堆上分配内存(堆向上增长). amx_Release 释放高于输入参数 amx_addr 值的所有内存. 即, 单次调用 amx_Release 可以释放多次调用 amx_Allot 的内存, 如果传递的是第一次分配的 amx_addr 值. amx_PushArray 和 amx_PushString 内部使用 amx_Allot, 因此这些函数也适用相同的过程.</p>
<p><strong>另见：</strong> <a href=#amx_allot>amx_Allot</a>, <a href=#amx_pusharray>amx_PushArray</a>, <a href=#amx_pushstring>amx_PushString</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx_setstring>amx_SetString<a href=#amx_setstring class=hash-link aria-label=amx_SetString的直接链接 title=amx_SetString的直接链接>​</a></h2>
<p>- 将字符串存储在抽象机器中</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=语法-12>语法<a href=#语法-12 class=hash-link aria-label=语法的直接链接 title=语法的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_SetString</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">cell </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">dest</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>char</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">source</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> pack</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> use_wchar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> size_t size</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<table><thead><tr><th>参数<th>说明<tbody><tr><td><strong>dest</strong><td>指向 amx 中字符数组的指针, 其中存储转换后的字符串. 使用 amx_GetAddr 将 amx 中的字符串地址转换为物理地址.<tr><td><strong>source</strong><td>指向源字符串的指针.<tr><td><strong>pack</strong><td>非零值将源字符串转换为抽象机中的打包字符串, 零值将源字符串转换为单元字符串.<tr><td><strong>string</strong><td>传递给公共函数的字符串.<tr><td><strong>use_wchar</strong><td>非零值将字符串参数解释为"宽字符"即 wchar_t 的指针, 无论其字符类型如何. 这允许函数接受 Unicode 字符串.<tr><td><strong>size</strong><td>存储在 dest 中的最大单元数, 包括终止的零字节或单元. 如果源字符串的长度超过了 dest 可以容纳的单元数, 则会被截断.</table>
<p><strong>注意：</strong> 当你传递 Unicode 字符串并要求在抽象机中使用打包格式(即 pack 和 use_wchar 都为 true)时, 字符将被截断为 8 位.</p>
<p><strong>另见:</strong> <a href=#amx_getstring>amx_GetString</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx_strlen>amx_StrLen<a href=#amx_strlen class=hash-link aria-label=amx_StrLen的直接链接 title=amx_StrLen的直接链接>​</a></h2>
<p>- 获取字符串的字符长度</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=语法-13>语法<a href=#语法-13 class=hash-link aria-label=语法的直接链接 title=语法的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_StrLen</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> cell </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">cstring</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">length</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<table><thead><tr><th>参数<th>说明<tbody><tr><td><strong>cstring</strong><td>抽象机中的字符串.<tr><td><strong>length</strong><td>该参数将在返回时保存字符串的长度.</table>
<p><strong>注意:</strong> 这个函数确定字符串的字符长度, 不包括零终止字符(或单元格). 一个打包字符串占用的单元格比其字符数少. 如果 cstring 参数为 NULL, 则长度参数将被设置为零 (0), 并且函数将返回错误代码. 对于将解包字符串转换为 UTF-8, 函数 amx_UTF8Len 可能更方便.</p>
<p><strong>另见:</strong> <a href=#amx_getaddr>amx_GetAddr</a>, <a href=#amx_getstring>amx_GetString</a>, <a href=#amx_setstring>amx_SetString</a>, <a href=#amx_strparam>amx_StrParam</a>, amx_UTF8Len+</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx_strparam>amx_StrParam<a href=#amx_strparam class=hash-link aria-label=amx_StrParam的直接链接 title=amx_StrParam的直接链接>​</a></h2>
<p>- 从抽象机器中获取字符串参数</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=语法-14>语法<a href=#语法-14 class=hash-link aria-label=语法的直接链接 title=语法的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token function" style=color:#d73a49>amx_StrParam</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>int</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> param</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>[</span><span class="token keyword" style=color:#00009f>char</span><span class="token operator" style=color:#393A34>*</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> result</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<table><thead><tr><th>参数<th>说明<tbody><tr><td><strong>amx</strong><td>抽象机器.<tr><td><strong>param</strong><td>参数编号.<tr><td><strong>result</strong><td>一个变量, 用于保存返回结果.</table>
<p><strong>注意:</strong> 这个宏分配了一块内存(使用 alloca)并将字符串参数(传递给本地函数)复制到该块内存中. 有关使用此宏的示例, 请参见第 56 页.</p>
<p><strong>另见:</strong> <a href=#amx_getaddr>amx_GetAddr</a>, <a href=#amx_getstring>amx_GetString</a>, <a href=#amx_strlen>amx_StrLen</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=amx-函数示例>Amx 函数示例<a href=#amx-函数示例 class=hash-link aria-label="Amx 函数示例的直接链接" title="Amx 函数示例的直接链接">​</a></h2>
<p>为了避免大段文字墙, 我决定在代码中添加注释来解释我在做什么, 而不是在主题中逐一说明. 阅读示例时, 最好同时打开 wiki 文章作为参考.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=注册本地函数>注册本地函数<a href=#注册本地函数 class=hash-link aria-label=注册本地函数的直接链接 title=注册本地函数的直接链接>​</a></h3>
<p>我们提供给 PAWN 的每一个函数都必须注册, 以便抽象机器能够意识到它的存在. 因此, 我认为从 amx_Register 开始可能是个好主意！幸运的是, 我们实际上已经在之前的部分使用了注册本地函数的示例, 所以我将再次使用这个示例并添加一些注释.</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>//我们希望向抽象机器注册的函数数组.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">AMX_NATIVE_INFO PluginNatives</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//在这里我们指定本地函数的信息, 并用两个空值终止数组.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"HelloWorld"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> HelloWorld</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">PLUGIN_EXPORT </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> PLUGIN_CALL </span><span class="token function" style=color:#d73a49>AmxLoad</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"> AMX </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//在这里我们将本地函数注册到抽象机器. 注意我们使用 -1. 通常这应该是我们正在注册的函数的数量, 但由于我们用两个空值终止了数组, 我们可以指定 -1.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_Register</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> PluginNatives</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<ul>
<li>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=获取字符串及其长度>获取字符串及其长度<a href=#获取字符串及其长度 class=hash-link aria-label=获取字符串及其长度的直接链接 title=获取字符串及其长度的直接链接>​</a></h3>
</li>
</ul>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>//这个函数演示了：如何从 PAWN 获取字符串(及其长度).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 本地函数：native PrintPawnString(const str[]);</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>PrintPawnString</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        len </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        ret </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    cell </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">addr  </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//获取我们字符串参数 (str) 的地址, 然后获取其长度</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>amx_GetAddr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>amx_StrLen</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">len</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//如果输入的长度不为 0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">len</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//我们增加 len, 因为我们在分配内存时要为终止的 null 字符留出空间.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//此外, 因为 GetString 的大小参数计算了 null 字符, 我们必须指定字符串的长度 + 1；否则我们的字符串将被截断以为 null 字符留出空间(我们会丢失 1 个字符).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        len</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//分配内存以容纳我们传递的字符串 (str), 然后使用分配的内存来"获取"字符串.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>char</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> text </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>char</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"> len </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_GetString</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">text</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> len</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//使用 logprintf 打印字符串 (text). 我们不使用 std::cout, 因为它不会写入服务器日志(只写入控制台).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>logprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">text</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//释放我们的内存...</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>delete</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> text</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=获取字符串的替代方法>获取字符串的替代方法<a href=#获取字符串的替代方法 class=hash-link aria-label=获取字符串的替代方法的直接链接 title=获取字符串的替代方法的直接链接>​</a></h3>
<p>我决定添加这个部分, 因为我知道人们会被它的简单性所吸引, 我认为他们应该了解使用这种方法可能带来的风险和问题.</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>//此函数演示：一种从 pawn 获取字符串的替代方法及其可能带来的风险.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数：native PrintPawnString2(const str[]);</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>PrintPawnString2</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//这种方法并不推荐, 因为 amx_StrParam 宏使用了 alloca 函数, 而 alloca 不是 C 或 C++ 的标准函数.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//使用这种方法存在堆栈溢出的风险(如果你分配了大量内存), 同时也存在错误的风险(这个函数依赖于机器和编译器 - 一些实现被认为有缺陷).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>char</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> text </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>amx_StrParam</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> text</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//检查 text 是否为 null</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">text </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//使用 logprintf 打印字符串(text). 我们不使用 std::cout, 因为它不会写入服务器日志(仅控制台).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>logprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">text</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=如何设置一个字符串>如何设置一个字符串<a href=#如何设置一个字符串 class=hash-link aria-label=如何设置一个字符串的直接链接 title=如何设置一个字符串的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>//此函数演示了：如何修改PAWN字符串.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数: native SetPawnString(str[], len = sizeof(str));</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>SetPawnString</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> string message </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"这是来自C/++的字符串!!"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> addr </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//获取字符串参数(str)的地址, 并存储我们的消息</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>amx_GetAddr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>amx_SetString</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> message</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>c_str</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=类型转换并返回浮点数>类型转换并返回浮点数<a href=#类型转换并返回浮点数 class=hash-link aria-label=类型转换并返回浮点数的直接链接 title=类型转换并返回浮点数的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>//此函数演示了：如何将浮点数转换为PAWN浮点数并返回.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数: native Float:ReturnPawnFloatVal();</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>ReturnPawnFloatVal</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//由于PAWN是一种无类型语言, 它将所有内容存储为32位整数, 并依靠标签来处理特殊数据.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//浮点数也不例外；它仍然是32位整数, 但它有一个Float标签, 表示它不应像普通整数那样处理.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//那么如何在不丢失数据的情况下将浮点数转换为32位整数(用于PAWN)呢？</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//答案是amx_ftoc宏！</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//宏amx_ftoc在保持位模式的同时, 将浮点数类型转换为单元格(amx_ctof做相反的操作).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>float</span><span class="token plain"> f </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>22.624f</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_ftoc</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">f</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=通过引用传递参数>通过引用传递参数<a href=#通过引用传递参数 class=hash-link aria-label=通过引用传递参数的直接链接 title=通过引用传递参数的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>//此函数演示了：如何通过引用传递参数.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数: native SetPawnReferenceVars(&value1, &Float:value2);</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>SetPawnReferenceVars</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> val </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>65</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>float</span><span class="token plain"> val2 </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>84.54f</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> addr</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//获取"value1"和"value2"的地址</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>amx_GetAddr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>amx_GetAddr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//取消引用指针并分配我们的值. 请记住, 始终使用宏"amx_ftoc"将浮点数转换为单元格(PAWN的适当浮点格式)！</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> val</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_ftoc</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">val2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=获取和修改数组值>获取和修改数组值<a href=#获取和修改数组值 class=hash-link aria-label=获取和修改数组值的直接链接 title=获取和修改数组值的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>//此函数演示了：如何获取和修改数组值.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数: native PrintPawnArray(arr[], size = sizeof(arr));</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>PrintPawnArray</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//确保有东西可打印...</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> addr </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//获取我们PAWN数组中第一个值的地址.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_GetAddr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>for</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> i </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> l </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> l</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token comment" style=color:#999988;font-style:italic>//这非常简单：我们取消引用addr指针以获取要打印的值.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token comment" style=color:#999988;font-style:italic>//你应该已经知道这一点, 但数组和指针几乎是同一回事, 所以我们可以使用指针运算添加偏移量, 或者只是使用下标运算符(最终*(addr+1)和addr[1]是一样的).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token function" style=color:#d73a49>logprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"arr[%d] = %d"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> i</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">addr </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> i</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token comment" style=color:#999988;font-style:italic>//如果你想修改数组, 你只需通过取消引用addr并分配一个新值来更改其值.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token comment" style=color:#999988;font-style:italic>//你也应该知道这一点, 我只是为了完整性而添加它. 在这里, 我们将数组的第一个值更改为5(注意：由于它是第一个值, 没有使用偏移量).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token comment" style=color:#999988;font-style:italic>// *(addr) = 5;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=调用回调函数>调用回调函数<a href=#调用回调函数 class=hash-link aria-label=调用回调函数的直接链接 title=调用回调函数的直接链接>​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>//此函数演示了：如何调用PAWN脚本中的回调函数.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数: native EmitPawnCallback();</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>EmitPawnCallback</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> idx</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> cell var </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> cell arr</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token number" style=color:#36acaa>100</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>33</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> string str </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"来自C++的随机消息. "</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//Pawn 回调：forward OnPawnCallbackEmitted(var, arr[], str[]);</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//找到我们的回调并将其位置存储在公共函数表中(它的索引)到我们的idx变量中.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>!</span><span class="token function" style=color:#d73a49>amx_FindPublic</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"OnPawnCallbackEmitted"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">idx</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        cell</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            ret</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            addr</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//在这里, 我们将参数推送到函数中. 注意, 如果函数有多个参数, 你必须以相反的顺序推送你的值！这就是为什么我们先推送字符串, 然后是数组, 最后是整数.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_PushString</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> str</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>c_str</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//amx_PushArray(amx, NULL, NULL, arr, sizeof(arr) / sizeof(cell));</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        cell</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            amx_addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">phys_addr</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//由于某种原因, amx_PushArray似乎会使服务器崩溃, 而我完全不知道为什么. 根据实现者的指南和代码, 我的使用应该是完全有效的. 由于此函数不起作用, 我们必须</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//使用旧方法, 自己分配内存, 设置它, 并将其推送到我们自己手动管理的空间中. 这非常简单. 我们使用amx_Allot在堆上分配内存(这会返回两个地址- 一个在抽象机器中的位置</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//(amx_addr), 另一个是相对于实际服务器的地址空间(phsy_addr - 我们可以在C++中使用)). 一旦分配了内存, 我们使用memcpy将内存从我们的数组复制到phys_addr地址位置.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_Allot</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">arr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>/</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">cell</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">amx_addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">phys_addr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>memcpy</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">phys_addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> arr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">arr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_Push</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> amx_addr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//推送我们的整数值</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_Push</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> var</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//使用我们之前获得的idx变量执行函数.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//注意：此函数的第二个参数是回调返回的值(如果你对返回值不感兴趣, 可以为NULL).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_Exec</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">ret</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> idx</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//释放我们分配的内存. 函数amx_Alloc在抽象机器的堆上分配内存.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//函数amx_PushString和amx_PushArray都在内部使用此函数, 因此每次使用这些函数时, 你都必须释放内存. 注意：我们使用了amx_PushString和amx_PushArray, 却只有一个释放调用.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//这是因为堆上的内存是按升序分配的！amx_Release会释放从某一点以上的所有内存</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//(第二个参数, amx_addr - 即我们的addr变量). 由于它是这样做的, 我们只存储了来自amx_PushString调用的地址, 因为它会删除从该点开始的所有内容.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_Release</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> addr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//打印返回值(为了完整性).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>logprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"EmitPawnCallback 注意：OnPawnCallbackEmitted回调返回%d!"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> ret</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=调用原生函数和挂钩回调函数>调用原生函数和挂钩回调函数<a href=#调用原生函数和挂钩回调函数 class=hash-link aria-label=调用原生函数和挂钩回调函数的直接链接 title=调用原生函数和挂钩回调函数的直接链接>​</a></h2>
<p>在进入回调函数挂钩或 SA-MP 原生函数调用之前, 我想先澄清一些事情. 有些人似乎认为插件是 PAWN 的替代品, 但事实并非如此. 插件的设计目的是为 PAWN 提供功能, 而不是取代它. 有时候, 将某些功能开发为插件而不是 PAWN 脚本是没有意义的——重要的是要问自己是否真的应该将某些功能开发为插件而不是 PAWN 脚本.</p>
<p>对于回调挂钩和 SA-MP 原生函数调用, 有很多不同的方法可以使用. 不过, 我现在只会专注于每种方法中的一种.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=invoke>Invoke<a href=#invoke class=hash-link aria-label=Invoke的直接链接 title=Invoke的直接链接>​</a></h3>
<p>Invoke 是一种由 incognito 创建的 SA-MP 原生函数调用方法. 你可以在<a href=https://github.com/Dystans/SA-MP_Invoke_2.0 target=_blank rel="noopener noreferrer">这里</a>找到它. 请注意, 其中有一个文本文件, 包含大量 SA-MP 原生函数调用. 这对 Invoke 至关重要, 必须添加到你的插件的 include 文件中. 如果你没有一个使用你插件所需的所有 SA-MP 原生函数的公共 PAWN 函数, Invoke 将无法工作. 此函数仅用于让 Invoke 找到原生函数的地址, 并且<strong>绝不能</strong>实际在任何地方使用.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=开始>开始<a href=#开始 class=hash-link aria-label=开始的直接链接 title=开始的直接链接>​</a></h4>
<p>在我们开始调用 SA-MP 原生函数之前, 我们必须设置 Invoke. 我们需要做的第一件事是将其包含在我们的项目中, 你应该还记得如何在前面的"开始"部分中执行此操作. 一旦将文件添加到项目中, 只需几个简单步骤即可让 Invoke 开始工作：</p>
<ul>
<li>包含 Invoke 头文件.</li>
<li>在 Load 下为 Invoke 实例分配内存.</li>
<li>每次在 AmxLoad 下加载新的 AMX 实例时, 推送 amx_list 成员变量.</li>
<li>每次卸载脚本时, 迭代 Invoke 的 amx_list, 找到卸载的 AMX 实例, 并在 AmxUnload 下擦除它.</li>
<li>创建一个原生函数, 当加载使用我们插件的 filterscript 或 gamemode 时, 调用 Invoke 的"getAddresses"成员函数供 PAWN 使用.</li>
</ul>
<p>这就是为你的插件设置 Invoke 的全部内容. 剩下要做的就是将 Invoke 包中找到的公共 PAWN 函数(我们之前提到的 txt 文件)添加到你的插件的 include 文件中, 并在加载脚本时使用最后一个设置步骤中的原生函数. 对于那些将创建用于公开发布的插件的人, 我建议你查看这个帖子. 它允许在 OnGameModeInit/OnFilterScriptInit 回调中进行干净无缝的"挂钩", 以便你可以注册 SA-MP 的原生地址, 而不会强迫最终用户自己将函数添加到这些回调中.</p>
<p><strong>注意：</strong> 我知道以文本形式解释这一点可能对大多数新用户来说并不理想；然而, 这些都是标准的 C/++任务, 你应该已经熟悉了——而那些不熟悉的(例如：创建原生函数)已经解释过了！如果你在跟进时遇到困难, 我建议你先熟悉一下 C/++. 不过话虽如此, 本文稍后将提供更新的源代码文件(以及我们插件的实际 include 文件), 其中包含我们到目前为止学到的所有内容的注释. 如果你遇到任何问题, 请查看该更新的源文件.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=添加-sa-mp-原生函数>添加 SA-MP 原生函数<a href=#添加-sa-mp-原生函数 class=hash-link aria-label="添加 SA-MP 原生函数的直接链接" title="添加 SA-MP 原生函数的直接链接">​</a></h4>
<p>不幸的是, Invoke 并不是魔法, 它确实需要维护以添加新的原生函数或删除已弃用的原生函数. 上一节中的版本包含了 SA-MP 0.2.2 版本的所有原生函数, 因此缺少了所有较新的函数. 出于这两个原因, 我决定添加此部分！如果有人足够好心添加所有缺失的原生函数, 我将更新 Invoke 包并在致谢中包含他们的名字——如果没有, 我建议根据需要添加原生函数.</p>
<p>在 Invoke 头文件中, 你应该看到一个大的函数名称数组(数组适当地命名为"name")和许多静态"Native"结构声明. 要添加原生函数, 你只需将其名称添加到名称数组中, 并使用适当的信息声明一个 Native 结构——名称和参数说明符. 有许多可用的参数说明符可供使用：</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token plain">i </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>integer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">整数</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">f </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>float</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>value</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">浮点值</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">s </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>string</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">字符串</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">v </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> reference </span><span class="token function" style=color:#d73a49>variable</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">引用变量</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">例如GetPlayerPos</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> GetPlayerKeys等</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">p </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> string </span><span class="token function" style=color:#d73a49>var</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">字符串变量</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">例如GetPlayerName等</span><span class="token punctuation" style=color:#393A34>)</span><br></span></code></pre></div></div>
<p><strong>记得更新调用所有原生函数的公共 PAWN 函数.</strong> 每次添加原生函数时, 你还需要将其添加到该公共函数中.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id=调用原生函数>调用原生函数<a href=#调用原生函数 class=hash-link aria-label=调用原生函数的直接链接 title=调用原生函数的直接链接>​</a></h4>
<p>Invoke 使用一个适当命名为"callNative"的可变参数成员函数来调用原生函数. 此函数的参数为指向包含原生函数信息的 Native 结构的指针(参见上一节), 以及该原生函数的所有参数的省略号. 此函数返回被调用的原生函数的返回值. 以下是一个调用多个原生函数的示例函数, 其中使用了不同的参数类型(int、引用和字符串变量).</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>//此函数演示：如何使用Invoke调用SA-MP原生函数.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN原生函数：native WhereIsPlayer(playerid);</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>WhereIsPlayer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>float</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        x </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        y </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        z </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//获取玩家位置(并检查他是否已连接).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>callNative</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">PAWN</span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">GetPlayerPos</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">y</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">z</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>char</span><span class="token plain"> name</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>24</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//获取玩家的其他信息(姓名、内饰和虚拟世界)并打印出来.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>callNative</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">PAWN</span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">GetPlayerName</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> name</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> interior </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>callNative</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">PAWN</span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">GetPlayerInterior</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> virtualworld </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>callNative</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">PAWN</span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">GetPlayerVirtualWorld</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>logprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"%s 位于 X: %.2f, Y: %.2f, Z: %.2f (虚拟世界: %d, 内饰: %d). "</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> name</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> z</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> virtualworld</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> interior</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=挂钩回调函数>挂钩回调函数<a href=#挂钩回调函数 class=hash-link aria-label=挂钩回调函数的直接链接 title=挂钩回调函数的直接链接>​</a></h3>
<p>使用 Invoke 方法时, 对于回调函数来说, 没有 100%透明的挂钩方法. 想要挂钩使用 Invoke 的回调函数的插件需要通过 PAWN 来实现. 你可以创建一个原生函数, 然后在你想挂钩的 PAWN 回调函数内调用该原生函数, 并将该原生函数用作伪回调. 你可以使用 ALS 挂钩方法来实现这一点, 这样可以让最终用户不需要做任何工作.</p>
<p>第一步显然是创建原生函数(记得将其添加到我们要注册的原生函数列表中, 并在你的 include 文件中添加它). 我决定挂钩的回调函数是 OnPlayerConnect, 因此我将编写一个具有与此回调函数相同参数的原生函数, 然后添加需要此回调的代码(在这种情况下是一个小玩笑).</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>//此函数演示：如何编写一个原生函数来充当回调函数.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN原生函数：native TEST_Hook_OnPlayerConnnect(playerid);</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>TEST_Hook_OnPlayerConnnect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//获取玩家的姓名</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>char</span><span class="token plain"> name</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>24</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>callNative</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">PAWN</span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">GetPlayerName</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> name</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//检查他的名字是否是"Mario".</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>string</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"Mario"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> name</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//如果是, 发送我们的搞笑信息并踢他.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>callNative</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">PAWN</span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">SendClientMessage</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0xFFFFFFFF</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"对不起 {FF0000}Mario, {FFFFFF}但你的公主在另一个服务器. "</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>callNative</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">PAWN</span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">Kick</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<p><code>TEST_Hook_OnPlayerConnnect</code> 现在将作为我们插件的 <code>OnPlayerConnect</code> 回调函数. 由于我们插件的名称是"Test"且相对较短, 我决定让其作为我们的挂钩前缀. 你通常需要为你的前缀选择一些独特的内容, 以避免与其他人的插件/include 文件发生冲突. 注意： 我们仍然需要使用之前提到的 ALS 方法从 PAWN 中调用此函数以方便用户. 由于 Y_Less 对 ALS 方法解释得非常好, 因此我没有必要详细介绍它, 我将简单提供我们 <code>TEST_Hook_OnPlayerConnect</code> 回调函数的挂钩示例. 这个示例应放在你的插件 include 文件中.</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>OnPlayerConnect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">playerid</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TEST_Hook_OnPlayerConnnect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">playerid</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//..</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>funcidx</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"TEST_OnPlayerConnect"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>CallLocalFunction</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"TEST_OnPlayerConnect"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"d"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> playerid</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>if</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>defined _ALS_OnPlayerConnect</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>undef</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>OnPlayerConnect</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>else</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>define</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property macro-name" style=color:#36acaa>_ALS_OnPlayerConnect</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>endif</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>define</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property macro-name" style=color:#36acaa>OnPlayerConnect</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>TEST_OnPlayerConnect</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">forward </span><span class="token function" style=color:#d73a49>TEST_OnPlayerConnect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">playerid</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=结束语>结束语<a href=#结束语 class=hash-link aria-label=结束语的直接链接 title=结束语的直接链接>​</a></h2>
<p>一些有经验的插件开发者可能会疑惑, 为什么我没有在"调用原生函数和挂钩回调"这一节中包含 GDK(Game Development Kit). 我决定不提及它有两个原因. 首先, 我目前的时间非常有限, 无法投入时间来适应这个新系统. 其次, GDK 非常实验性, 目前在崩溃和其他问题上存在一些困境. 我完全理解 Invoke 和 GDK 之间的速度差异, 并且如果没有其他人这样做, 我将来肯定会添加它(请记住, 这本来是一个社区驱动的项目). 不过, 我认为最好还是等待这些问题得到更多解决(zeex 是一位非常出色的编码者, 我相信他会解决所有问题).</p>
<p>另外, 正如我承诺的那样, 以下是包含注释的更新版 include/source 文件, 其中包含了我们希望学习到的所有内容：</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=插件-include>插件 include<a href=#插件-include class=hash-link aria-label="插件 include的直接链接" title="插件 include的直接链接">​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token comment" style=color:#999988;font-style:italic>//任何带有"TEST"前缀的内容都应更改, 如果你的插件名称不同. 这同样适用于插件代码(特别是TEST_Hook_OnPlayerConnect).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>if</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>defined _TEST_INCLUDED</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>endinput</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>endif</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>define</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property macro-name" style=color:#36acaa>_TEST_INCLUDED</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>pragma</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>library Test</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property string" style=color:#e3116c>&lt;a_samp></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//本地函数例子</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native </span><span class="token function" style=color:#d73a49>PrintPawnString</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> str</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native </span><span class="token function" style=color:#d73a49>PrintPawnString2</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> str</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native </span><span class="token function" style=color:#d73a49>SetPawnString</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">str</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> len </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">str</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native Float</span><span class="token operator" style=color:#393A34>:</span><span class="token function" style=color:#d73a49>ReturnPawnFloatVal</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native </span><span class="token function" style=color:#d73a49>SetPawnReferenceVars</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">value1</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">Float</span><span class="token operator" style=color:#393A34>:</span><span class="token plain">value2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native </span><span class="token function" style=color:#d73a49>PrintPawnArray</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">arr</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> size </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">arr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native </span><span class="token function" style=color:#d73a49>EmitPawnCallback</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native </span><span class="token function" style=color:#d73a49>WhereIsPlayer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">playerid</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native </span><span class="token function" style=color:#d73a49>TEST_Hook_OnPlayerConnnect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">playerid</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//调用本地</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">native </span><span class="token function" style=color:#d73a49>Invoke_GetAddresses</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//挂钩回调</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>OnPlayerConnect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">playerid</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TEST_Hook_OnPlayerConnnect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">playerid</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//..</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>funcidx</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"TEST_OnPlayerConnect"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>CallLocalFunction</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"TEST_OnPlayerConnect"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"d"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> playerid</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>if</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>defined _ALS_OnPlayerConnect</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>undef</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>OnPlayerConnect</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>else</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>define</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property macro-name" style=color:#36acaa>_ALS_OnPlayerConnect</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>endif</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>define</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property macro-name" style=color:#36acaa>OnPlayerConnect</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>TEST_OnPlayerConnect</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">forward </span><span class="token function" style=color:#d73a49>TEST_OnPlayerConnect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">playerid</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>OnGameModeInit</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>Invoke_GetAddresses</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//..</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>funcidx</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"TEST_OnGameModeInit"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>CallLocalFunction</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"TEST_OnGameModeInit"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>if</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>defined _ALS_OnGameModeInit</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>undef</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>OnGameModeInit</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>else</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>define</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property macro-name" style=color:#36acaa>_ALS_OnGameModeInit</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>endif</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>define</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property macro-name" style=color:#36acaa>OnGameModeInit</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>TEST_OnGameModeInit</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">forward </span><span class="token function" style=color:#d73a49>TEST_OnGameModeInit</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>OnFilterScriptInit</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>Invoke_GetAddresses</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//..</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>funcidx</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"TEST_OnFilterScriptInit"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>CallLocalFunction</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"TEST_OnFilterScriptInit"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>if</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>defined _ALS_OnFilterScriptInit</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>undef</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>OnFilterScriptInit</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>else</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>define</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property macro-name" style=color:#36acaa>_ALS_OnFilterScriptInit</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>endif</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>define</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property macro-name" style=color:#36acaa>OnFilterScriptInit</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property expression" style=color:#36acaa>TEST_OnFilterScriptInit</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">forward </span><span class="token function" style=color:#d73a49>TEST_OnFilterScriptInit</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//用于调用的公共函数</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">forward </span><span class="token function" style=color:#d73a49>InvokeFunction</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>public</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>InvokeFunction</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> Float</span><span class="token operator" style=color:#393A34>:</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> Var</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>256</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> iVar</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// a_samp.inc</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SendClientMessage</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SendClientMessageToAll</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SendDeathMessage</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GameTextForAll</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GameTextForPlayer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetTickCount</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetMaxPlayers</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetGameModeText</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetTeamCount</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>AddPlayerClass</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>AddPlayerClassEx</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>AddStaticVehicle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>AddStaticVehicleEx</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>AddStaticPickup</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>ShowNameTags</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>ShowPlayerMarkers</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GameModeExit</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetWorldTime</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetWeaponName</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Var</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"> Var </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>EnableTirePopping</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>AllowInteriorWeapons</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetWeather</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetGravity</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>AllowAdminTeleport</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetDeathDropAmount</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>CreateExplosion</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//SetDisabledWeapons();</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>EnableZoneNames</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>IsPlayerAdmin</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>Kick</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>Ban</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SendRconCommand</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>ShowPlayerDialog</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"lol"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"lol"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"lol"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>"lol"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// a_players.inc</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetSpawnInfo</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SpawnPlayer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerPos</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//  SetPlayerPosFindZ(0, 0.0, 0.0, 0.0);</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerPos</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> fVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> fVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> fVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerFacingAngle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerFacingAngle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerInterior</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerInterior</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerHealth</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerHealth</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> fVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerArmour</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerArmour</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> fVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerAmmo</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerAmmo</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerTeam</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerTeam</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerScore</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerScore</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerColor</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerColor</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerSkin</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GivePlayerWeapon</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>ResetPlayerWeapons</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerWeaponData</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> iVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> iVar </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GivePlayerMoney</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>ResetPlayerMoney</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerName</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerMoney</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerState</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerIp</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Var</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"> Var </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerPing</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerWeapon</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerKeys</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">iVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">iVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">iVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerName</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Var</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"> Var </span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>PutPlayerInVehicle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerVehicleID</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>RemovePlayerFromVehicle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TogglePlayerControllable</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>PlayerPlaySound</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerCheckpoint</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>DisablePlayerCheckpoint</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerRaceCheckpoint</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>DisablePlayerRaceCheckpoint</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerWorldBounds</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerMarkerForPlayer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>ShowPlayerNameTagForPlayer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerMapIcon</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>RemovePlayerMapIcon</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerCameraPos</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerCameraLookAt</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetCameraBehindPlayer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>AllowPlayerTeleport</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>IsPlayerConnected</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>IsPlayerInVehicle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>IsPlayerInAnyVehicle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>IsPlayerInCheckpoint</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>IsPlayerInRaceCheckpoint</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerTime</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TogglePlayerClock</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerWeather</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerTime</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">iVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">iVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerVirtualWorld</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerVirtualWorld</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// a_vehicle.inc</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>CreateVehicle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>DestroyVehicle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetVehiclePos</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetVehiclePos</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetVehicleZAngle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetVehicleZAngle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetVehicleParamsForPlayer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetVehicleToRespawn</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>LinkVehicleToInterior</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>AddVehicleComponent</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>ChangeVehicleColor</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>ChangeVehiclePaintjob</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetVehicleHealth</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetVehicleHealth</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>AttachTrailerToVehicle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>DetachTrailerFromVehicle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>IsTrailerAttachedToVehicle</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetVehicleModel</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetVehicleNumberPlate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetVehicleVirtualWorld</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetVehicleVirtualWorld</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>ApplyAnimation</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>1.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// a_objects.inc</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>CreateObject</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetObjectPos</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetObjectPos</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetObjectRot</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetObjectRot</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>IsValidObject</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>DestroyObject</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>MoveObject</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>StopObject</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>CreatePlayerObject</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerObjectPos</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerObjectPos</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>GetPlayerObjectRot</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">fVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetPlayerObjectRot</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>IsValidPlayerObject</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>DestroyPlayerObject</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>MovePlayerObject</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>StopPlayerObject</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// Menu's</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>CreateMenu</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>DestroyMenu</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Menu</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>AddMenuItem</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Menu</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>SetMenuColumnHeader</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Menu</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>ShowMenuForPlayer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Menu</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>HideMenuForPlayer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Menu</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>IsValidMenu</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Menu</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>DisableMenu</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Menu</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>DisableMenuRow</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Menu</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// Textdraw</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawCreate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawDestroy</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawLetterSize</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawTextSize</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0.0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawAlignment</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawColor</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawUseBox</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawBoxColor</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawSetShadow</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawSetOutline</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawBackgroundColor</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawFont</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawSetProportional</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawShowForPlayer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawHideForPlayer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawShowForAll</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>TextDrawHideForAll</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">Text</span><span class="token operator" style=color:#393A34>:</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>// Others</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>funcidx</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>""</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>gettime</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">iVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">iVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">iVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>getdate</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">iVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">iVar</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain">iVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>tickcount</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">iVar</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=plugin-source-code>Plugin source code<a href=#plugin-source-code class=hash-link aria-label="Plugin source code的直接链接" title="Plugin source code的直接链接">​</a></h3>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#393A34;--prism-background-color:#f6f8fa><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style=color:#393A34;background-color:#f6f8fa><code class=codeBlockLines_e6Vv><span class=token-line style=color:#393A34><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property string" style=color:#e3116c>"SDK\amx\amx.h"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property string" style=color:#e3116c>"SDK\plugincommon.h"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property string" style=color:#e3116c>"Invoke.h"</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property string" style=color:#e3116c>&lt;string></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property string" style=color:#e3116c>&lt;vector></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property string" style=color:#e3116c>&lt;cstdlib></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token macro property directive-hash" style=color:#36acaa>#</span><span class="token macro property directive keyword" style=color:#00009f>include</span><span class="token macro property" style=color:#36acaa> </span><span class="token macro property string" style=color:#e3116c>&lt;ctime></span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>typedef</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>void</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">logprintf_t</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>char</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> format</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>.</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">logprintf_t logprintf</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>extern</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>void</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">pAMXFunctions</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token keyword" style=color:#00009f>using</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>namespace</span><span class="token plain"> std</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//此函数演示了：如何从PAWN获取字符串(及其长度).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数: native PrintPawnString(const str[]);</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>PrintPawnString</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        len </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        ret </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    cell </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">addr </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//获取字符串参数(str)的地址, 然后获取其长度</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>amx_GetAddr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>amx_StrLen</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">len</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//如果输入的长度不是0</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">len</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//我们增加len的值, 因为在分配内存时我们需要为终止的null字符腾出空间.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//由于GetString的size参数会计算null字符的大小, 因此我们必须指定字符串的长度+1；</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//否则我们的字符串将会被截断, 以腾出空间给null字符(我们将失去一个字符).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        len</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//为传递的字符串(str)分配内存, 然后使用分配的内存来存储它.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>char</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> text </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>char</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">len</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_GetString</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">text</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> len</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//使用logprintf打印出字符串(text). 我们不使用std::cout, 因为它不会写入服务器日志(只写入窗口).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>logprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">text</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//释放内存...</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>delete</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> text</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//此函数演示了：如何调用PAWN脚本中的回调函数.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数: native EmitPawnCallback();</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>EmitPawnCallback</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> idx</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> cell var </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>3</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> cell arr</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token number" style=color:#36acaa>100</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>4</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>33</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> string str </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"从C++传递过来的随机消息. "</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//Pawn 回调函数： forward OnPawnCallbackEmitted(var, arr[], str[]);</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//找到回调函数并将其在公共函数表中的位置(索引)存储到我们的idx变量中.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>!</span><span class="token function" style=color:#d73a49>amx_FindPublic</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"OnPawnCallbackEmitted"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">idx</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        cell</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            ret</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            addr</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//在此处推送函数的参数. 注意, 如果函数有多个参数, 你需要逆序推送参数！</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//这就是为什么我们先推送字符串, 然后是数组, 最后是整数.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_PushString</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> str</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>c_str</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//amx_PushArray(amx, NULL, NULL, arr, sizeof(arr) / sizeof(cell));</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        cell</span><br></span><span class=token-line style=color:#393A34><span class="token plain">            amx_addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">phys_addr</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//由于某种原因, amx_PushArray似乎会导致服务器崩溃, 我对此一无所知.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//从实现者指南和代码来看, 我的用法应该是完全有效的. 由于此函数无法正常工作, 我们只能</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//使用旧方法：分配内存, 设置它, 并手动推送所有内容. 这非常简单. 我们</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//使用amx_Allot在堆上分配内存(此函数返回2个地址—一个是虚拟机中的位置</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//(amx_addr), 另一个是相对于实际服务器地址空间的地址(phys_addr—可用于C++)).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//分配内存后, 我们使用memcpy将数组的内存复制到phys_addr地址位置.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_Allot</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">arr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>/</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">cell</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">amx_addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">phys_addr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>memcpy</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">phys_addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> arr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>sizeof</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">arr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_Push</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> amx_addr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//推送整数值</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_Push</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> var</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//使用之前获取的idx变量执行函数.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//注意：此函数的第二个参数是回调函数的返回值(如果不关心返回值, 可以为NULL).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_Exec</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">ret</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> idx</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//释放分配的内存. 函数amx_Alloc在虚拟机的堆上分配内存.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//函数amx_PushString和amx_PushArray内部都使用此函数, 因此每次使用其中一个函数时都必须释放内存.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//注意：我们同时使用了amx_PushString和amx_PushArray, 但我们只调用了一个释放函数.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//这是因为堆上的内存是按升序分配的！amx_Release会释放从某个点(第二个参数, amx_addr, 即我们的addr变量)开始的所有内存.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//因此, 我们只存储来自amx_PushString调用的地址, 因为它会删除从该点之后的所有内容.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_Release</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> addr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//打印返回值(以示完整性).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>logprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"EmitPawnCallback 注意: OnPawnCallbackEmitted 回调函数返回了 %d!"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> ret</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//这个函数演示了：从PAWN获取字符串的替代方法及其可能带来的风险.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数: native PrintPawnString2(const str[]);</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>PrintPawnString2</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//这种方法不推荐, 因为amx_StrParam宏使用了alloca函数, 这在C或C++中不是标准.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//使用这种方法有溢出栈的风险(如果你分配了大量内存), 同时也有可能出现bug(这个函数依赖于机器和编译器-某些实现被认为有bug).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>char</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> text </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>amx_StrParam</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> text</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//检查text是否为null</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">text </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//使用logprintf打印字符串(text). 我们不使用std::cout, 因为它不会写入服务器日志(只写入窗口).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>logprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">text</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//这个函数演示了：如何修改PAWN字符串.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数: native SetPawnString(str[], len = sizeof(str));</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>SetPawnString</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> string message </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"这是来自C/++的字符串！！"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> addr </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//获取我们字符串参数(str)的地址并存储我们的消息</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>amx_GetAddr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>amx_SetString</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> message</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>c_str</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//这个函数演示了：如何将浮点数转换为PAWN浮点数.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数: native Float:ReturnPawnFloatVal();</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>ReturnPawnFloatVal</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//由于PAWN是一个无类型语言, 它将所有内容存储为32位整数, 并依靠标签处理特殊数据.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//浮点数也不例外；它仍然是32位整数, 但有一个Float标签来表示它不应</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//像普通整数一样处理. 那么我们如何在不丢失数据的情况下将浮点数转换为32位整数(对于PAWN)呢？</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//答案是amx_ftoc宏！</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//宏amx_ftoc将浮点数类型转换为cell, 同时保持其位模式(amx_ctof执行相反操作).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>float</span><span class="token plain"> f </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>22.624f</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_ftoc</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">f</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//这个函数演示了：如何通过引用传递参数.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数: native SetPawnReferenceVars(&value1, &Float:value2);</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>SetPawnReferenceVars</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> val </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>65</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>float</span><span class="token plain"> val2 </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>84.54f</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> addr</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>{</span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//获取"value1"和"value2"的地址</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>amx_GetAddr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>amx_GetAddr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//取消引用我们的指针并分配我们的值. 记住始终使用宏"amx_ftoc"将浮点数转换为</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//cells(PAWN的适当浮点格式)！</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> val</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_ftoc</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">val2</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//这个函数演示了：如何获取和修改数组值.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数: native PrintPawnArray(arr[], size = sizeof(arr));</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>PrintPawnArray</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//确保有东西可以打印...</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>></span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> addr </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//获取我们PAWN数组中第一个值的地址.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>amx_GetAddr</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">addr</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>for</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> i </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> l </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>2</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i </span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain"> l</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token comment" style=color:#999988;font-style:italic>//这很简单：我们取消引用addr指针来获取要打印的值.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token comment" style=color:#999988;font-style:italic>//你应该已经知道了, 数组和指针几乎是一样的, 所以我们可以使用指针</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token comment" style=color:#999988;font-style:italic>//算术来添加偏移量, 或者直接使用下标操作符(最终*(addr+1)和addr[1]是一样的).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token function" style=color:#d73a49>logprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"arr[%d] = %d"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> i</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">addr </span><span class="token operator" style=color:#393A34>+</span><span class="token plain"> i</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token comment" style=color:#999988;font-style:italic>//如果你想修改数组, 你只需通过取消引用addr并分配新值来改变它的值.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token comment" style=color:#999988;font-style:italic>//你应该也知道这一点, 我只是为了完整性把它加上. 这里我们将数组的第一个值</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token comment" style=color:#999988;font-style:italic>//改为5(注意：因为是第一个值, 所以没有使用偏移量).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token comment" style=color:#999988;font-style:italic>// *(addr) = 5;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//这个函数演示了：如何设置invoke(获取我们native的地址).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数: native Invoke_GetAddresses();</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>Invoke_GetAddresses</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>getAddresses</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//这个函数演示了：如何使用invoke调用SA-MP的natives.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数: native WhereIsPlayer(playerid);</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>WhereIsPlayer</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>float</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        x </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        y </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        z </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token constant" style=color:#36acaa>NULL</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//获取玩家的位置(并检查他是否已连接).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>callNative</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">PAWN</span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">GetPlayerPos</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">y</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>&</span><span class="token plain">z</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>char</span><span class="token plain"> name</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>24</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//获取玩家的其余信息(名字、室内和虚拟世界)并打印出来.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>callNative</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">PAWN</span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">GetPlayerName</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> name</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> interior </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>callNative</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">PAWN</span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">GetPlayerInterior</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> virtualworld </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>callNative</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">PAWN</span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">GetPlayerVirtualWorld</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token function" style=color:#d73a49>logprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"%s 的位置是 X: %.2f, Y: %.2f, Z: %.2f (虚拟世界: %d, 室内 %d). "</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> name</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> x</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> y</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> z</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> virtualworld</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> interior</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//这个函数演示了：如何编写一个native作为回调函数.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//PAWN 原生函数: native TEST_Hook_OnPlayerConnnect(playerid);</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">cell AMX_NATIVE_CALL </span><span class="token function" style=color:#d73a49>TEST_Hook_OnPlayerConnnect</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">AMX</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> cell</span><span class="token operator" style=color:#393A34>*</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//获取玩家的名字</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>char</span><span class="token plain"> name</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>24</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>callNative</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">PAWN</span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">GetPlayerName</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> name</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//检查他的名字是否是"Mario".</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token function" style=color:#d73a49>string</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"Mario"</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> name</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//如果是, 发送我们搞笑的小消息并踢掉他.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>callNative</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">PAWN</span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">SendClientMessage</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0xFFFFFFFF</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"对不起 {FF0000}Mario, {FFFFFF}但你的公主在另一个服务器. "</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>callNative</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">PAWN</span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">Kick</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> params</span><span class="token punctuation" style=color:#393A34>[</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//这个函数告诉服务器我们的插件将具备哪些功能, 基于它返回的内容. 一般来说, 我们在插件中只使用3个支持标志：</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//SUPPORTS_VERSION, SUPPORTS_AMX_NATIVES, 和 SUPPORTS_PROCESS_TICK.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">PLUGIN_EXPORT </span><span class="token keyword" style=color:#00009f>unsigned</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> PLUGIN_CALL </span><span class="token function" style=color:#d73a49>Supports</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//注意：如果你使用了ProcessTick函数, 请记得在.def文件中导出它！</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> SUPPORTS_VERSION </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> SUPPORTS_AMX_NATIVES </span><span class="token operator" style=color:#393A34>|</span><span class="token plain"> SUPPORTS_PROCESS_TICK</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//Load函数非常简单. 这是在插件加载时调用的, 并传递一个包含插件将使用的地址的数组.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//我们通常使用的两个索引是PLUGIN_DATA_AMX_EXPORTS和PLUGIN_DATA_LOGPRINTF.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">PLUGIN_EXPORT </span><span class="token keyword" style=color:#00009f>bool</span><span class="token plain"> PLUGIN_CALL </span><span class="token function" style=color:#d73a49>Load</span><span class="token punctuation" style=color:#393A34>(</span><span class="token keyword" style=color:#00009f>void</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">ppData</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//为我们的g_Invoke实例分配内存</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    g_Invoke </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>new</span><span class="token plain"> Invoke</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//将AMX函数表/logprintf函数的地址分配给相应的指针.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    pAMXFunctions </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> ppData</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PLUGIN_DATA_AMX_EXPORTS</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    logprintf </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">logprintf_t</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"> ppData</span><span class="token punctuation" style=color:#393A34>[</span><span class="token plain">PLUGIN_DATA_LOGPRINTF</span><span class="token punctuation" style=color:#393A34>]</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>logprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"* 测试插件已加载. "</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token boolean" style=color:#36acaa>true</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//Unload在插件卸载(服务器关闭)时被调用.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">PLUGIN_EXPORT </span><span class="token keyword" style=color:#00009f>void</span><span class="token plain"> PLUGIN_CALL </span><span class="token function" style=color:#d73a49>Unload</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token function" style=color:#d73a49>logprintf</span><span class="token punctuation" style=color:#393A34>(</span><span class="token string" style=color:#e3116c>"* 测试插件已卸载. "</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//我们的native信息数组用于amx_Register(函数名称和地址).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">AMX_NATIVE_INFO PluginNatives</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"PrintPawnString"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> PrintPawnString</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"PrintPawnString2"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> PrintPawnString2</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"SetPawnString"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> SetPawnString</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"ReturnPawnFloatVal"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> ReturnPawnFloatVal</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"SetPawnReferenceVars"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> SetPawnReferenceVars</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"PrintPawnArray"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> PrintPawnArray</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"EmitPawnCallback"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> EmitPawnCallback</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"WhereIsPlayer"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> WhereIsPlayer</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"Invoke_GetAddresses"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> Invoke_GetAddresses</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token string" style=color:#e3116c>"TEST_Hook_OnPlayerConnnect"</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> TEST_Hook_OnPlayerConnnect</span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//当新的AMX实例被加载到服务器时会调用这个函数. 每个filterscript/gamemode都会调用这个函数！因此, 存储整个插件的单个AMX实例并不是一个好主意,</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//而是使用队列/列表/向量. 在这个函数中, 我们还注册了希望提供给PAWN的自定义native函数.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">PLUGIN_EXPORT </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> PLUGIN_CALL </span><span class="token function" style=color:#d73a49>AmxLoad</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"> AMX </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//每当一个脚本被加载时, 我们想将它添加到invoke的AMX列表中, 所以我们将实例推入列表.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token plain">amx_list</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>push_back</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> </span><span class="token function" style=color:#d73a49>amx_Register</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">amx</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> PluginNatives</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>-</span><span class="token number" style=color:#36acaa>1</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//每当一个AMX实例被卸载时会调用这个函数. 如果你存储AMX实例, 请确保你将它们移除. 否则你会有指向不存在的gamemodes/filterscripts的实例.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">PLUGIN_EXPORT </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> PLUGIN_CALL </span><span class="token function" style=color:#d73a49>AmxUnload</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain"> AMX </span><span class="token operator" style=color:#393A34>*</span><span class="token plain">amx </span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//每个被卸载的脚本需要从我们的AMX实例列表中移除. 所以我们遍历列表, 找到正在被卸载的实例, 并将其从列表中删除.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>for</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">list</span><span class="token operator" style=color:#393A34>&lt;</span><span class="token plain">AMX </span><span class="token operator" style=color:#393A34>*</span><span class="token operator" style=color:#393A34>></span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">iterator i </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token plain">amx_list</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>begin</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> i </span><span class="token operator" style=color:#393A34>!=</span><span class="token plain"> g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token plain">amx_list</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>end</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>++</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>*</span><span class="token plain">i </span><span class="token operator" style=color:#393A34>==</span><span class="token plain"> amx</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token plain">amx_list</span><span class="token punctuation" style=color:#393A34>.</span><span class="token function" style=color:#d73a49>erase</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">i</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">            </span><span class="token keyword" style=color:#00009f>break</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>return</span><span class="token plain"> AMX_ERR_NONE</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>//ProcessTick 是一个在服务器循环的每次迭代中被调用的函数. 人们通常使用这个函数来管理时间, 通过跟踪已经过去的tick数量.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// SA-MP服务器的休眠时间为5毫秒, 因此如果经过了50个tick, 你就可以知道经过的时间(5 * 50 = 250毫秒). 注意：任何在插件中使用线程并需要PAWN交互的人都需要使用这个函数, 以确保</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token comment" style=color:#999988;font-style:italic>// PAWN不会忙于执行其他任务！</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">PLUGIN_EXPORT </span><span class="token keyword" style=color:#00009f>void</span><span class="token plain"> PLUGIN_CALL </span><span class="token function" style=color:#d73a49>ProcessTick</span><span class="token punctuation" style=color:#393A34>(</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>static</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> tick </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>int</span><span class="token plain"> NYAN_COUNT </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>100</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    tick</span><span class="token operator" style=color:#393A34>++</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain" style=display:inline-block></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token comment" style=color:#999988;font-style:italic>//使用取模运算符来查看是否已经过去了NYAN_COUNT个tick(100 tick. 5毫秒休眠时间 * 100 tick = 500毫秒).</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token keyword" style=color:#00009f>if</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>!</span><span class="token punctuation" style=color:#393A34>(</span><span class="token plain">tick </span><span class="token operator" style=color:#393A34>%</span><span class="token plain"> NYAN_COUNT</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>)</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>{</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token comment" style=color:#999988;font-style:italic>//如果经过了100个tick, 则向所有人发送我们搞笑的小消息.</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        </span><span class="token keyword" style=color:#00009f>const</span><span class="token plain"> </span><span class="token keyword" style=color:#00009f>char</span><span class="token plain"> nyan</span><span class="token punctuation" style=color:#393A34>[</span><span class="token punctuation" style=color:#393A34>]</span><span class="token plain"> </span><span class="token operator" style=color:#393A34>=</span><span class="token plain"> </span><span class="token string" style=color:#e3116c>"{FF0000}NYAN {FFA500}NYAN {FFFF00}NYAN {00FF00}NYAN {0000FF}NYAN {551A8B}NYAN"</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">        g_Invoke</span><span class="token operator" style=color:#393A34>-></span><span class="token function" style=color:#d73a49>callNative</span><span class="token punctuation" style=color:#393A34>(</span><span class="token operator" style=color:#393A34>&</span><span class="token plain">PAWN</span><span class="token double-colon punctuation" style=color:#393A34>::</span><span class="token plain">SendClientMessageToAll</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> </span><span class="token number" style=color:#36acaa>0</span><span class="token punctuation" style=color:#393A34>,</span><span class="token plain"> nyan</span><span class="token punctuation" style=color:#393A34>)</span><span class="token punctuation" style=color:#393A34>;</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain">    </span><span class="token punctuation" style=color:#393A34>}</span><span class="token plain"></span><br></span><span class=token-line style=color:#393A34><span class="token plain"></span><span class="token punctuation" style=color:#393A34>}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=特别感谢>特别感谢<a href=#特别感谢 class=hash-link aria-label=特别感谢的直接链接 title=特别感谢的直接链接>​</a></h2>
<p><strong>RyDeR`</strong> - 感谢提供他插件教程中的图片.</p>
<p><strong>Incognito</strong> - 感谢提供 Invoke、有关 ProcessTick 的信息, 以及在我学习 C++期间给予的所有帮助.</p>
<p><strong>Zeex/0x5A656578</strong> - 感谢 GDK(将会在某个时候包含在内), 以及自愿回答有关 GDK 的问题.</p>
<p><strong>Y_Less</strong> - 感谢你一直以来的优秀表现和在我完全困惑时的持续帮助.</p>
<p><strong>Techboy123</strong> - 感谢你们的很多富有成效的聊天、帮助以及倾听我的抱怨.</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/openmultiplayer/web/edit/master/frontend/i18n/zh-CN/docusaurus-plugin-content-docs/current/tutorials/PluginDevelopmentGuide.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label=文件选项卡><a class="pagination-nav__link pagination-nav__link--prev" href=/zh-CN/docs/tutorials/PickupGuide><div class=pagination-nav__sublabel>上一页</div><div class=pagination-nav__label>拾取物指南</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/zh-CN/docs/tutorials/PortForwarding><div class=pagination-nav__sublabel>下一页</div><div class=pagination-nav__label>端口转发</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#介绍 class="table-of-contents__link toc-highlight">介绍</a><li><a href=#这不是一个-c帮助论坛 class="table-of-contents__link toc-highlight">这不是一个 C/++帮助论坛</a><li><a href=#常见问题 class="table-of-contents__link toc-highlight">常见问题</a><ul><li><a href=#快速问答 class="table-of-contents__link toc-highlight">快速问答</a></ul><li><a href=#入门 class="table-of-contents__link toc-highlight">入门</a><ul><li><a href=#源文件-cpp class="table-of-contents__link toc-highlight">源文件 (*.cpp)</a><li><a href=#模块定义文件def class="table-of-contents__link toc-highlight">模块定义文件(*.def)</a></ul><li><a href=#代码分析 class="table-of-contents__link toc-highlight">代码分析</a><ul><li><a href=#模块定义文件 class="table-of-contents__link toc-highlight">模块定义文件</a><li><a href=#定义和结构 class="table-of-contents__link toc-highlight">定义和结构</a></ul><li><a href=#amx-函数 class="table-of-contents__link toc-highlight">Amx 函数</a><ul><li><a href=#关键 class="table-of-contents__link toc-highlight">关键</a></ul><li><a href=#amx_allot class="table-of-contents__link toc-highlight">amx_Allot</a><ul><li><a href=#语法 class="table-of-contents__link toc-highlight">语法</a></ul><li><a href=#amx_ctof class="table-of-contents__link toc-highlight">amx_ctof</a><ul><li><a href=#语法-1 class="table-of-contents__link toc-highlight">语法</a></ul><li><a href=#amx_exec class="table-of-contents__link toc-highlight">amx_Exec</a><ul><li><a href=#语法-2 class="table-of-contents__link toc-highlight">语法</a></ul><li><a href=#amx_findpublic class="table-of-contents__link toc-highlight">amx_FindPublic</a><ul><li><a href=#语法-3 class="table-of-contents__link toc-highlight">语法</a></ul><li><a href=#amx_ftoc class="table-of-contents__link toc-highlight">amx_ftoc</a><ul><li><a href=#语法-4 class="table-of-contents__link toc-highlight">语法</a></ul><li><a href=#amx_getaddr class="table-of-contents__link toc-highlight">amx_GetAddr</a><ul><li><a href=#语法-5 class="table-of-contents__link toc-highlight">语法</a></ul><li><a href=#amx_getstring class="table-of-contents__link toc-highlight">amx_GetString</a><ul><li><a href=#语法-6 class="table-of-contents__link toc-highlight">语法</a></ul><li><a href=#amx_push class="table-of-contents__link toc-highlight">amx_Push</a><ul><li><a href=#语法-7 class="table-of-contents__link toc-highlight">语法</a></ul><li><a href=#amx_pusharray class="table-of-contents__link toc-highlight">amx_PushArray</a><ul><li><a href=#语法-8 class="table-of-contents__link toc-highlight">语法</a></ul><li><a href=#amx_pushstring class="table-of-contents__link toc-highlight">amx_PushString</a><ul><li><a href=#语法-9 class="table-of-contents__link toc-highlight">语法</a></ul><li><a href=#amx_register class="table-of-contents__link toc-highlight">amx_Register</a><ul><li><a href=#语法-10 class="table-of-contents__link toc-highlight">语法</a></ul><li><a href=#amx_release class="table-of-contents__link toc-highlight">amx_Release</a><ul><li><a href=#语法-11 class="table-of-contents__link toc-highlight">语法</a></ul><li><a href=#amx_setstring class="table-of-contents__link toc-highlight">amx_SetString</a><ul><li><a href=#语法-12 class="table-of-contents__link toc-highlight">语法</a></ul><li><a href=#amx_strlen class="table-of-contents__link toc-highlight">amx_StrLen</a><ul><li><a href=#语法-13 class="table-of-contents__link toc-highlight">语法</a></ul><li><a href=#amx_strparam class="table-of-contents__link toc-highlight">amx_StrParam</a><ul><li><a href=#语法-14 class="table-of-contents__link toc-highlight">语法</a></ul><li><a href=#amx-函数示例 class="table-of-contents__link toc-highlight">Amx 函数示例</a><ul><li><a href=#注册本地函数 class="table-of-contents__link toc-highlight">注册本地函数</a><li><a href=#获取字符串及其长度 class="table-of-contents__link toc-highlight">获取字符串及其长度</a><li><a href=#获取字符串的替代方法 class="table-of-contents__link toc-highlight">获取字符串的替代方法</a><li><a href=#如何设置一个字符串 class="table-of-contents__link toc-highlight">如何设置一个字符串</a><li><a href=#类型转换并返回浮点数 class="table-of-contents__link toc-highlight">类型转换并返回浮点数</a><li><a href=#通过引用传递参数 class="table-of-contents__link toc-highlight">通过引用传递参数</a><li><a href=#获取和修改数组值 class="table-of-contents__link toc-highlight">获取和修改数组值</a><li><a href=#调用回调函数 class="table-of-contents__link toc-highlight">调用回调函数</a></ul><li><a href=#调用原生函数和挂钩回调函数 class="table-of-contents__link toc-highlight">调用原生函数和挂钩回调函数</a><ul><li><a href=#invoke class="table-of-contents__link toc-highlight">Invoke</a><li><a href=#挂钩回调函数 class="table-of-contents__link toc-highlight">挂钩回调函数</a></ul><li><a href=#结束语 class="table-of-contents__link toc-highlight">结束语</a><ul><li><a href=#插件-include class="table-of-contents__link toc-highlight">插件 include</a><li><a href=#plugin-source-code class="table-of-contents__link toc-highlight">Plugin source code</a></ul><li><a href=#特别感谢 class="table-of-contents__link toc-highlight">特别感谢</a></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>文档</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/zh-CN/docs>入门指南</a><li class=footer__item><a class=footer__link-item href=/zh-CN/docs>迁移至open.mp</a><li class=footer__item><a class=footer__link-item href=/zh-CN/docs/server/config.json>config.json</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>社区</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://discord.gg/samp target=_blank rel="noopener noreferrer" class=footer__link-item>Discord<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://github.com/openmultiplayer/open.mp target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://opencollective.com/openmultiplayer target=_blank rel="noopener noreferrer" class=footer__link-item>捐赠<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://youtube.com/openmultiplayer target=_blank rel="noopener noreferrer" class=footer__link-item>YouTube<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://x.com/openmultiplayer target=_blank rel="noopener noreferrer" class=footer__link-item>X<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>更多</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/zh-CN/servers>服务器</a><li class=footer__item><a class=footer__link-item href=/zh-CN/blog>博客</a><li class=footer__item><a class=footer__link-item href=/zh-CN/animations>动画</a><li class=footer__item><a class=footer__link-item href=/zh-CN/uid>UID生成器</a><li class=footer__item><a href=https://sa-mp.mp/ target=_blank rel="noopener noreferrer" class=footer__link-item>SA-MP<svg width=13.5 height=13.5 aria-hidden=true class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=margin-bottom--sm><img src=/zh-CN/images/assets/logo.svg alt="open.mp logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src=/zh-CN/images/assets/logo.svg alt="open.mp logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></div><div class=footer__copyright>版权所有 © 2025 open.mp。基于Docusaurus构建</div></div></div></footer></div>